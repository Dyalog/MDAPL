
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>13. Mathematical Functions &#8212; Mastering Dyalog APL</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="14. Appendices" href="Appendices.html" />
    <link rel="prev" title="12. Tacit Programming" href="Tacit-Programming.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Mastering Dyalog APL</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Introduction.html">
   1. Introduction - Will You Play APL With Me?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Getting-Started.html">
   2. Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Data-and-Variables.html">
   3. Data and Variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Some-Primitive-Functions.html">
   4. Some Primitive Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="User-Defined-Functions.html">
   5. User-Defined Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="First-Aid-Kit.html">
   6. First-Aid Kit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Execute-and-Format-Control.html">
   7. Execute &amp; Format Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Working-on-Data-Shape.html">
   8. Working on Data Shape
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Special-Syntax.html">
   9. Special Syntax
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Nested-Arrays-Continued.html">
   10. Nested Arrays (Continued)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Operators.html">
   11. Operators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Tacit-Programming.html">
   12. Tacit Programming
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   13. Mathematical Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Appendices.html">
   14. Appendices
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/Dyalog/MDAPL"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/Dyalog/MDAPL/edit/master/docs/Mathematical-Functions.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/Mathematical-Functions.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sorting-and-searching-data">
   13.1. Sorting and Searching Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sorting-numeric-data">
     13.1.1. Sorting Numeric Data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sorting-numeric-vectors">
       13.1.1.1. Sorting Numeric Vectors
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sorting-numeric-matrices">
       13.1.1.2. Sorting Numeric Matrices
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sorting-numeric-high-rank-arrays">
       13.1.1.3. Sorting Numeric High-rank Arrays
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sorting-characters">
     13.1.2. Sorting Characters
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#using-the-default-alphabet">
       13.1.2.1. Using the Default Alphabet
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#using-an-explicit-alphabet">
       13.1.2.2. Using an Explicit Alphabet
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#grading-and-permutations">
     13.1.3. Grading and Permutations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-values">
     13.1.4. Finding Values
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#encode-and-decode">
   13.2. Encode and Decode
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#some-words-of-theory">
     13.2.1. Some Words of Theory
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#familiar-but-not-decimal">
       13.2.1.1. Familiar, But Not Decimal
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#three-important-remarks">
       13.2.1.2. Three Important Remarks
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#base-and-weights">
       13.2.1.3. Base and Weights
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-decode-encode">
     13.2.2. Using Decode &amp; Encode
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#decode">
       13.2.2.1. Decode
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#shape-compatibility">
       13.2.2.2. Shape Compatibility
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#encode">
       13.2.2.3. Encode
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#limited-encoding">
       13.2.2.4. Limited Encoding
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#using-several-simultaneous-bases">
       13.2.2.5. Using Several Simultaneous Bases
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#applications-of-encoding-and-decoding">
     13.2.3. Applications of Encoding and Decoding
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#condense-or-expand-values">
       13.2.3.1. Condense or Expand Values
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#calculating-polynomials">
       13.2.3.2. Calculating Polynomials
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#right-aligning-text">
       13.2.3.3. Right-aligning Text
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#randomised-values">
   13.3. Randomised Values
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#deal-dyadic-usage">
     13.3.1. Deal: Dyadic Usage
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#roll-monadic-use">
     13.3.2. Roll: Monadic Use
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#positive-integer-arrays-as-argument">
       13.3.2.1. Positive Integer Arrays as Argument
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#as-argument">
       13.3.2.2. 0 as Argument
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#derived-usages">
     13.3.3. Derived Usages
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#random-number-within-an-arbitrary-range">
       13.3.3.1. Random Number Within an Arbitrary Range
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sets-of-random-characters">
       13.3.3.2. Sets of Random Characters
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-link">
     13.3.4. Random Link
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#reproducibility-when-generating-random-numbers">
       13.3.4.1. Reproducibility When Generating Random Numbers
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-algorithm">
       13.3.4.2. The Algorithm
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#some-more-maths">
   13.4. Some More Maths
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#logarithms">
     13.4.1. Logarithms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#factorial-binomial">
     13.4.2. Factorial &amp; Binomial
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trigonometry">
     13.4.3. Trigonometry
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#multiples-of">
       13.4.3.1. Multiples of π
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#circular-and-hyperbolic-trigonometry">
       13.4.3.2. Circular and Hyperbolic Trigonometry
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#direct-trigonometric-functions">
         13.4.3.2.1. Direct Trigonometric Functions
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#inverse-trigonometric-functions">
       13.4.3.3. Inverse Trigonometric Functions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#concrete-trigonometry-examples">
       13.4.3.4. Concrete Trigonometry Examples
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#manipulating-complex-numbers">
       13.4.3.5. Manipulating Complex Numbers
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gcd-and-lcm">
     13.4.4. GCD and LCM
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#greatest-common-divisor-gcd">
       13.4.4.1. Greatest Common Divisor (GCD)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lowest-common-multiple-lcm">
       13.4.4.2. Lowest Common Multiple (LCM)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-union-and-intersection">
     13.4.5. Set Union and Intersection
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#intersection">
       13.4.5.1. Intersection
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#union">
       13.4.5.2. Union
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#unique">
       13.4.5.3. Unique
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#domino">
   13.5. Domino
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#some-definitions">
     13.5.1. Some Definitions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mathematical-functions-identity-matrix">
       13.5.1.1. Identity Matrix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#inverse-matrices">
       13.5.1.2. Inverse Matrices
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-inverse">
     13.5.2. Matrix Inverse
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#monadic-domino">
       13.5.2.1. Monadic Domino
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#singular-matrices">
       13.5.2.2. Singular Matrices
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solving-a-set-of-linear-equations">
       13.5.2.3. Solving a Set of Linear Equations
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-division">
     13.5.3. Matrix Division
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#two-or-three-steps-in-geometry">
     13.5.4. Two or Three Steps in Geometry
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-complex-solution-to-a-simple-problem">
       13.5.4.1. A Complex Solution to a Simple Problem
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#calculating-additional-y-coordinates">
       13.5.4.2. Calculating Additional Y Coordinates
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#least-squares-fitting">
     13.5.5. Least Squares Fitting
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#linear-regression">
       13.5.5.1. Linear Regression
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#extension">
       13.5.5.2. Extension
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#non-linear-adjustment">
       13.5.5.3. Non-linear Adjustment
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   13.6. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-specialist-s-section">
   13.7. The Specialist’s Section
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#advanced-encode-and-decode">
     13.7.1. Advanced Encode and Decode
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#special-decoding">
       13.7.1.1. Special Decoding
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#processing-negative-values">
       13.7.1.2. Processing Negative Values
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#multiple-encoding-decoding">
       13.7.1.3. Multiple Encoding/Decoding
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gamma-and-beta-functions">
     13.7.2. Gamma and Beta Functions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#domino-and-rectangular-matrices">
     13.7.3. Domino and Rectangular Matrices
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#left-inverse-of-a-matrix">
       13.7.3.1. Left Inverse of a Matrix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pseudo-right-inverse">
       13.7.3.2. Pseudo Right Inverse
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#summary-of-left-and-right-inverses">
       13.7.3.3. Summary of Left and Right Inverses
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scalars-and-vectors">
       13.7.3.4. Scalars and Vectors
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#total-array-ordering">
     13.7.4. Total Array Ordering
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solutions">
   13.8. Solutions
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Mathematical Functions</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sorting-and-searching-data">
   13.1. Sorting and Searching Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sorting-numeric-data">
     13.1.1. Sorting Numeric Data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sorting-numeric-vectors">
       13.1.1.1. Sorting Numeric Vectors
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sorting-numeric-matrices">
       13.1.1.2. Sorting Numeric Matrices
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sorting-numeric-high-rank-arrays">
       13.1.1.3. Sorting Numeric High-rank Arrays
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sorting-characters">
     13.1.2. Sorting Characters
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#using-the-default-alphabet">
       13.1.2.1. Using the Default Alphabet
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#using-an-explicit-alphabet">
       13.1.2.2. Using an Explicit Alphabet
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#grading-and-permutations">
     13.1.3. Grading and Permutations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-values">
     13.1.4. Finding Values
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#encode-and-decode">
   13.2. Encode and Decode
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#some-words-of-theory">
     13.2.1. Some Words of Theory
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#familiar-but-not-decimal">
       13.2.1.1. Familiar, But Not Decimal
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#three-important-remarks">
       13.2.1.2. Three Important Remarks
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#base-and-weights">
       13.2.1.3. Base and Weights
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-decode-encode">
     13.2.2. Using Decode &amp; Encode
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#decode">
       13.2.2.1. Decode
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#shape-compatibility">
       13.2.2.2. Shape Compatibility
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#encode">
       13.2.2.3. Encode
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#limited-encoding">
       13.2.2.4. Limited Encoding
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#using-several-simultaneous-bases">
       13.2.2.5. Using Several Simultaneous Bases
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#applications-of-encoding-and-decoding">
     13.2.3. Applications of Encoding and Decoding
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#condense-or-expand-values">
       13.2.3.1. Condense or Expand Values
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#calculating-polynomials">
       13.2.3.2. Calculating Polynomials
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#right-aligning-text">
       13.2.3.3. Right-aligning Text
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#randomised-values">
   13.3. Randomised Values
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#deal-dyadic-usage">
     13.3.1. Deal: Dyadic Usage
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#roll-monadic-use">
     13.3.2. Roll: Monadic Use
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#positive-integer-arrays-as-argument">
       13.3.2.1. Positive Integer Arrays as Argument
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#as-argument">
       13.3.2.2. 0 as Argument
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#derived-usages">
     13.3.3. Derived Usages
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#random-number-within-an-arbitrary-range">
       13.3.3.1. Random Number Within an Arbitrary Range
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sets-of-random-characters">
       13.3.3.2. Sets of Random Characters
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-link">
     13.3.4. Random Link
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#reproducibility-when-generating-random-numbers">
       13.3.4.1. Reproducibility When Generating Random Numbers
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-algorithm">
       13.3.4.2. The Algorithm
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#some-more-maths">
   13.4. Some More Maths
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#logarithms">
     13.4.1. Logarithms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#factorial-binomial">
     13.4.2. Factorial &amp; Binomial
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trigonometry">
     13.4.3. Trigonometry
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#multiples-of">
       13.4.3.1. Multiples of π
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#circular-and-hyperbolic-trigonometry">
       13.4.3.2. Circular and Hyperbolic Trigonometry
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#direct-trigonometric-functions">
         13.4.3.2.1. Direct Trigonometric Functions
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#inverse-trigonometric-functions">
       13.4.3.3. Inverse Trigonometric Functions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#concrete-trigonometry-examples">
       13.4.3.4. Concrete Trigonometry Examples
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#manipulating-complex-numbers">
       13.4.3.5. Manipulating Complex Numbers
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gcd-and-lcm">
     13.4.4. GCD and LCM
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#greatest-common-divisor-gcd">
       13.4.4.1. Greatest Common Divisor (GCD)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lowest-common-multiple-lcm">
       13.4.4.2. Lowest Common Multiple (LCM)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-union-and-intersection">
     13.4.5. Set Union and Intersection
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#intersection">
       13.4.5.1. Intersection
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#union">
       13.4.5.2. Union
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#unique">
       13.4.5.3. Unique
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#domino">
   13.5. Domino
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#some-definitions">
     13.5.1. Some Definitions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mathematical-functions-identity-matrix">
       13.5.1.1. Identity Matrix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#inverse-matrices">
       13.5.1.2. Inverse Matrices
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-inverse">
     13.5.2. Matrix Inverse
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#monadic-domino">
       13.5.2.1. Monadic Domino
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#singular-matrices">
       13.5.2.2. Singular Matrices
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solving-a-set-of-linear-equations">
       13.5.2.3. Solving a Set of Linear Equations
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-division">
     13.5.3. Matrix Division
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#two-or-three-steps-in-geometry">
     13.5.4. Two or Three Steps in Geometry
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-complex-solution-to-a-simple-problem">
       13.5.4.1. A Complex Solution to a Simple Problem
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#calculating-additional-y-coordinates">
       13.5.4.2. Calculating Additional Y Coordinates
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#least-squares-fitting">
     13.5.5. Least Squares Fitting
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#linear-regression">
       13.5.5.1. Linear Regression
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#extension">
       13.5.5.2. Extension
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#non-linear-adjustment">
       13.5.5.3. Non-linear Adjustment
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   13.6. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-specialist-s-section">
   13.7. The Specialist’s Section
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#advanced-encode-and-decode">
     13.7.1. Advanced Encode and Decode
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#special-decoding">
       13.7.1.1. Special Decoding
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#processing-negative-values">
       13.7.1.2. Processing Negative Values
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#multiple-encoding-decoding">
       13.7.1.3. Multiple Encoding/Decoding
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gamma-and-beta-functions">
     13.7.2. Gamma and Beta Functions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#domino-and-rectangular-matrices">
     13.7.3. Domino and Rectangular Matrices
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#left-inverse-of-a-matrix">
       13.7.3.1. Left Inverse of a Matrix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pseudo-right-inverse">
       13.7.3.2. Pseudo Right Inverse
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#summary-of-left-and-right-inverses">
       13.7.3.3. Summary of Left and Right Inverses
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scalars-and-vectors">
       13.7.3.4. Scalars and Vectors
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#total-array-ordering">
     13.7.4. Total Array Ordering
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solutions">
   13.8. Solutions
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="mathematical-functions">
<span id="mathematical-functions-mathematical-functions"></span><h1><span class="section-number">13. </span>Mathematical Functions<a class="headerlink" href="#mathematical-functions" title="Permalink to this headline">#</a></h1>
<div class="section" id="sorting-and-searching-data">
<span id="mathematical-functions-sorting-and-searching-data"></span><h2><span class="section-number">13.1. </span>Sorting and Searching Data<a class="headerlink" href="#sorting-and-searching-data" title="Permalink to this headline">#</a></h2>
<div class="section" id="sorting-numeric-data">
<span id="mathematical-functions-sorting-numeric-data"></span><h3><span class="section-number">13.1.1. </span>Sorting Numeric Data<a class="headerlink" href="#sorting-numeric-data" title="Permalink to this headline">#</a></h3>
<div class="section" id="sorting-numeric-vectors">
<span id="mathematical-functions-sorting-numeric-vectors"></span><h4><span class="section-number">13.1.1.1. </span>Sorting Numeric Vectors<a class="headerlink" href="#sorting-numeric-vectors" title="Permalink to this headline">#</a></h4>
<p>Two primitive functions are provided to sort data:</p>
<ul class="simple">
<li><p><em>Grade up</em> <code class="docutils literal notranslate"><span class="pre">⍋</span></code>, typed with <kbd>APL</kbd>+<kbd>Shift</kbd>+<kbd>4</kbd>, returns the set of indices required to sort the array in ascending order.</p></li>
<li><p><em>Grade down</em> <code class="docutils literal notranslate"><span class="pre">⍒</span></code>, typed with <kbd>APL</kbd>+<kbd>Shift</kbd>+<kbd>3</kbd>, returns the set of indices required to sort the array in descending order.</p></li>
</ul>
<p>Here is an example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">vec</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">110</span><span class="w"> </span><span class="m">70</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">90</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">80</span><span class="w"></span>
<span class="o">⍋</span><span class="nv">vec</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 1 7 2 6 9 5 10 8 4
</span></div></div>
</div>
<p>Notice that the function <em>grade up</em> <code class="docutils literal notranslate"><span class="pre">⍋</span></code> does not actually return a sorted (i.e., re-ordered) array.
Instead, we obtain a set of indices which tell us that:</p>
<ul class="simple">
<li><p>the smallest item is at index <code class="docutils literal notranslate"><span class="pre">3</span></code>;</p></li>
<li><p>then comes the item at index <code class="docutils literal notranslate"><span class="pre">1</span></code>;</p></li>
<li><p>then the item at index <code class="docutils literal notranslate"><span class="pre">7</span></code>;</p></li>
<li><p>then the item at index <code class="docutils literal notranslate"><span class="pre">2</span></code>;</p></li>
<li><p>…</p></li>
<li><p>and the largest item is at index <code class="docutils literal notranslate"><span class="pre">4</span></code>.</p></li>
</ul>
<p>To obtain the vector <code class="docutils literal notranslate"><span class="pre">vec</span></code> sorted in ascending order, we must index it by these values, as shown below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">vec</span><span class="sr">[</span><span class="o">⍋</span><span class="nv">vec</span><span class="sr">]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">20 40 40 60 60 60 70 80 90 110
</span></div></div>
</div>
<p>As you might imagine, <em>grade down</em> sorts the vector in descending order:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">vec</span><span class="sr">[</span><span class="o">⍒</span><span class="nv">vec</span><span class="sr">]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">110 90 80 70 60 60 60 40 40 20
</span></div></div>
</div>
<p>When several items of the argument are equal, the relative positions of the items that are equal do not change.
For this reason, <code class="docutils literal notranslate"><span class="pre">⍒vec</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">⌽⍋vec</span></code> only if the values in <code class="docutils literal notranslate"><span class="pre">vec</span></code> are all different.
This is not the case for our vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍋</span><span class="nv">vec</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 1 7 2 6 9 5 10 8 4
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⌽⍋</span><span class="nv">vec</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4 8 10 5 9 6 2 7 1 3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍒</span><span class="nv">vec</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4 8 10 5 2 6 9 1 7 3
</span></div></div>
</div>
<p>Let us compare <code class="docutils literal notranslate"><span class="pre">⌽⍋vec</span></code> with <code class="docutils literal notranslate"><span class="pre">⍒vec</span></code>:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">4</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">3</span><span class="w">  </span><span class="c1">⍝ ⌽⍋vec</span><span class="w"></span>
<span class="m">4</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">3</span><span class="w">  </span><span class="c1">⍝  ⍒vec</span><span class="w"></span>
<span class="w">         </span><span class="o">↑</span><span class="w"> </span><span class="o">↑</span><span class="w"> </span><span class="o">↑</span><span class="w"></span>
</pre></div>
</div>
<p>Notice how the numbers <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">6</span> <span class="pre">9</span></code> are in opposite directions in the two results.
That is because those indices refer to the three times the number 60 shows up in <code class="docutils literal notranslate"><span class="pre">vec</span></code>.</p>
<p>Both when using <em>grade up</em> and <em>grade down</em>, the indices show up in the order <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">6</span> <span class="pre">9</span></code> because both grades preserve the relative positions of the items that are the same.
Thus, when we <em>reverse</em> the result of <em>grade up</em>, those three numbers show up as <code class="docutils literal notranslate"><span class="pre">9</span> <span class="pre">6</span> <span class="pre">2</span></code>.</p>
<p>You may rightfully wonder why the functions <em>grade up</em> and <em>grade down</em> return indices instead of sorted data.
There are, of course, good reasons for it, as we will show here.</p>
<p>Firstly, the availability of the intermediate result of the sorting process opens up possibilities for interesting and useful manipulations.
Here is one example: given a vector <code class="docutils literal notranslate"><span class="pre">v</span></code> of unique values, the expression <code class="docutils literal notranslate"><span class="pre">⍋⍋v</span></code> (or <code class="docutils literal notranslate"><span class="pre">⍋⍒v</span></code>) indicates which position the items of <code class="docutils literal notranslate"><span class="pre">v</span></code> would occupy if they were sorted in increasing (or decreasing) order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">class</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">153</span><span class="w"> </span><span class="m">432</span><span class="w"> </span><span class="m">317</span><span class="w"> </span><span class="m">609</span><span class="w"> </span><span class="m">411</span><span class="w"> </span><span class="m">227</span><span class="w"> </span><span class="m">186</span><span class="w"> </span><span class="m">350</span><span class="w"></span>
<span class="o">⍋⍒</span><span class="nv">class</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">8 2 5 1 3 6 7 4
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">class</span><span class="o">,</span><span class="sr">[</span><span class="m">.5</span><span class="sr">]</span><span class="o">⍋⍒</span><span class="nv">class</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">153 432 317 609 411 227 186 350
  8   2   5   1   3   6   7   4
</span></div></div>
</div>
<p>The result above shows that <code class="docutils literal notranslate"><span class="pre">153</span></code> would be sent to position <code class="docutils literal notranslate"><span class="pre">8</span></code> if <code class="docutils literal notranslate"><span class="pre">class</span></code> were ordered in decreasing order, the <code class="docutils literal notranslate"><span class="pre">432</span></code> would be in position <code class="docutils literal notranslate"><span class="pre">2</span></code>, and so on.
Here is the verification:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">classSorted</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">class</span><span class="sr">[</span><span class="o">⍒</span><span class="nv">class</span><span class="sr">]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">609 432 411 350 317 227 186 153
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">classSorted</span><span class="sr">[</span><span class="m">8</span><span class="sr">]</span><span class="o">≡</span><span class="m">153</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">classSorted</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="o">≡</span><span class="m">432</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>Secondly, it makes it much easier to sort complementary arrays (e.g., arrays that represent columns in a database table) in the same order.
Suppose, for example, that we would like to sort our familiar lists of prices and quantities in ascending order of quantity:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">price</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">5.2</span><span class="w"> </span><span class="m">11.5</span><span class="w"> </span><span class="m">3.6</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">8.45</span><span class="w"></span>
<span class="nv">qty</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">2</span><span class="w"></span>
<span class="nv">idx</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">⍋</span><span class="nv">qty</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">price</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">price</span><span class="sr">[</span><span class="nv">idx</span><span class="sr">]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">11.5 5.2 8.45 3.6 4
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">qty</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">qty</span><span class="sr">[</span><span class="nv">idx</span><span class="sr">]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 2 3 6
</span></div></div>
</div>
</div>
<div class="section" id="sorting-numeric-matrices">
<span id="mathematical-functions-sorting-numeric-matrices"></span><h4><span class="section-number">13.1.1.2. </span>Sorting Numeric Matrices<a class="headerlink" href="#sorting-numeric-matrices" title="Permalink to this headline">#</a></h4>
<p>The functions <em>grade up</em> and <em>grade down</em> can be used to sort the rows of a matrix.</p>
<p>In this case, they sort the rows by comparing the first element of each row; then, for rows that have the same first element, they compare second elements; and so on and so forth.
Both functions return a vector of row indices, which can be used to sort the matrix (do not forget the semicolon when indexing).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">matrix</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">3</span><span class="o">⍴</span><span class="m">2</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">55</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">33</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">55</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">52</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">9</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 40 8
5 55 2
2 33 9
7 20 2
5 55 1
5 52 9
2 40 9
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">matrix</span><span class="sr">[</span><span class="o">⍋</span><span class="nv">matrix</span><span class="sr">;]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 33 9
2 40 8
2 40 9
5 52 9
5 55 1
5 55 2
7 20 2
</span></div></div>
</div>
<p>In the result above, you can see that the first column is sorted in ascending order.
Then, when the first column has the same element, the second column is sorted in ascending order.
For example, there are three rows in <code class="docutils literal notranslate"><span class="pre">matrix</span></code> that start with a <code class="docutils literal notranslate"><span class="pre">2</span></code>.
Those three rows are the first three rows of the sorted matrix and, among those three rows, the second column is sorted:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span><span class="w"> </span><span class="m">¯2</span><span class="o">↑</span><span class="nv">matrix</span><span class="sr">[</span><span class="o">⍋</span><span class="nv">matrix</span><span class="sr">;]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">33 9
40 8
40 9
</span></div></div>
</div>
<p>Finally, when the first and second columns are the same, we order by the third column.
In the example above, we can see that two rows started with <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">40</span></code>, and those two rows were then sorted according to their third column.</p>
</div>
<div class="section" id="sorting-numeric-high-rank-arrays">
<span id="mathematical-functions-sorting-numeric-high-rank-arrays"></span><h4><span class="section-number">13.1.1.3. </span>Sorting Numeric High-rank Arrays<a class="headerlink" href="#sorting-numeric-high-rank-arrays" title="Permalink to this headline">#</a></h4>
<p>The functions <em>grade up</em> and <em>grade down</em> can be used to sort the major cells of numeric arrays of arbitrary rank, not just vectors and matrices.</p>
<p>To sort the rows of a matrix, we compared the rows item by item.
To sort the planes of a cuboid, we will compare the planes row by row.
To sort the cuboids of a 4D array, we will compare the cuboids plane by plane.
And this is the reasoning that you should follow to sort the major cells of any arbitrary array.</p>
<p>Consider the following cuboid:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">cuboid</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="o">⍴</span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 1
2 2

1 2
2 2

1 2
1 1

2 1
2 1

2 2
2 2
</span></div></div>
</div>
<p>Looking at all of its planes, we see two matrices whose first row is <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">2</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">cuboid</span><span class="sr">[</span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="sr">;;]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2
2 2

1 2
1 1
</span></div></div>
</div>
<p>Those two matrices have the smallest first row, so those two matrices will be the first two matrices in the sorted cuboid:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span><span class="o">↑</span><span class="nv">cuboid</span><span class="sr">[</span><span class="o">⍋</span><span class="nv">cuboid</span><span class="sr">;;]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2
1 1

1 2
2 2
</span></div></div>
</div>
<p>However, they show up in the reverse order in the sorted cuboid because the two matrices have the same first row, thus we need to compare the second row of each matrix to determine which matrix comes first.</p>
<p>This is the type of reasoning that must be followed to sort the whole cuboid:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">cuboid</span><span class="sr">[</span><span class="o">⍋</span><span class="nv">cuboid</span><span class="sr">;;]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2
1 1

1 2
2 2

2 1
2 1

2 1
2 2

2 2
2 2
</span></div></div>
</div>
</div>
</div>
<div class="section" id="sorting-characters">
<span id="mathematical-functions-sorting-characters"></span><h3><span class="section-number">13.1.2. </span>Sorting Characters<a class="headerlink" href="#sorting-characters" title="Permalink to this headline">#</a></h3>
<div class="section" id="using-the-default-alphabet">
<span id="mathematical-functions-using-the-default-alphabet"></span><h4><span class="section-number">13.1.2.1. </span>Using the Default Alphabet<a class="headerlink" href="#using-the-default-alphabet" title="Permalink to this headline">#</a></h4>
<p>When applied to characters, the monadic forms of <em>grade up</em> and <em>grade down</em> refer to an implicit alphabetic order.
In all modern versions of Dyalog (the <em>Unicode Editions</em>), it is the numerical order of the corresponding Unicode code points.
However, in the <em>Classic Editions</em> of Dyalog, it is given by a specific <em>system variable</em> known as the <em>atomic vector</em> <code class="docutils literal notranslate"><span class="pre">⎕AV</span></code>, described in <span class="xref myst">the chapter about system interfaces</span>.</p>
<p>For example, all modern versions of Dyalog give this result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">text</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="s1">&#39;Grade Up also works on Characters&#39;</span><span class="w"></span>
<span class="nv">text</span><span class="sr">[</span><span class="o">⍋</span><span class="nv">text</span><span class="sr">]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">     CGUaaaacdeehklnoooprrrrssstw
</span></div></div>
</div>
<p>In <em>Classic Editions</em> of Dyalog, the result would have been <code class="docutils literal notranslate"><span class="pre">'</span>&#160;&#160;&#160;&#160; <span class="pre">aaaacdeehjlnoooprrrrssstwCGU'</span></code>.
That is because the vector <code class="docutils literal notranslate"><span class="pre">⎕AV</span></code> has the lower case characters before the upper case ones, which means all the lower case letters will be sorted before all the upper case letters.
However, in the <em>Unicode Editions</em>, text is sorted according to Unicode code points, and in the Unicode standard, the upper case letters come before the lower case letters.
This is why we obtained two different results.</p>
<p>For this reason, sorting characters using the default alphabet should be reserved for text that contains only lower case or only upper case letters, or matrices where upper and lower case letters appear in the same columns, as in the following example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">towns</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">↑</span><span class="s1">&#39;Canberra&#39;</span><span class="w"> </span><span class="s1">&#39;Paris&#39;</span><span class="w"> </span><span class="s1">&#39;Washington&#39;</span><span class="w"> </span><span class="s1">&#39;Moscow&#39;</span><span class="w"> </span><span class="s1">&#39;Martigues&#39;</span><span class="w"> </span><span class="s1">&#39;Mexico&#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">Canberra  
Paris     
Washington
Moscow    
Martigues 
Mexico    
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">towns</span><span class="sr">[</span><span class="o">⍋</span><span class="nv">towns</span><span class="sr">;]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">Canberra  
Martigues 
Mexico    
Moscow    
Paris     
Washington
</span></div></div>
</div>
<p>The names are sorted correctly because all letters in each column are of the same case (all are upper case, or all are lower case).
However, if we mix upper and lower case letters, we may not get the result we expected.</p>
<p>For example, here we redefine the matrix <code class="docutils literal notranslate"><span class="pre">towns</span></code> but we are not careful, and thus do not capitalise properly all of the names of the cities:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">towns</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">↑</span><span class="s1">&#39;canberra&#39;</span><span class="w"> </span><span class="s1">&#39;paris&#39;</span><span class="w"> </span><span class="s1">&#39;Washington&#39;</span><span class="w"> </span><span class="s1">&#39;Moscow&#39;</span><span class="w"> </span><span class="s1">&#39;Martigues&#39;</span><span class="w"> </span><span class="s1">&#39;Mexico&#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">canberra  
paris     
Washington
Moscow    
Martigues 
Mexico    
</span></div></div>
</div>
<p>Because capitalisation was not uniform, sorting will differ wildly from what we obtained before:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">towns</span><span class="sr">[</span><span class="o">⍋</span><span class="nv">towns</span><span class="sr">;]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">Martigues 
Mexico    
Moscow    
Washington
canberra  
paris     
</span></div></div>
</div>
<p>In the result above, <code class="docutils literal notranslate"><span class="pre">'Washington'</span></code> (which was supposed to be the last row) came before <code class="docutils literal notranslate"><span class="pre">'canberra'</span></code> (which was supposed to be the first row) because all the upper case letters come before the lower case letters in the implicit alphabet that defines the order of characters.</p>
</div>
<div class="section" id="using-an-explicit-alphabet">
<span id="mathematical-functions-using-an-explicit-alphabet"></span><h4><span class="section-number">13.1.2.2. </span>Using an Explicit Alphabet<a class="headerlink" href="#using-an-explicit-alphabet" title="Permalink to this headline">#</a></h4>
<p>To avoid this kind of problem, it is advisable to use the dyadic versions of the sorting primitives, which take an explicit alphabet as their left argument (notice it contains a blank in the end).
Let us try this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">alph</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="s1">&#39;aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPqQrRsStTuUvVwWxXyYzZ &#39;</span><span class="w"></span>
<span class="nv">towns</span><span class="sr">[</span><span class="nv">alph</span><span class="o">⍋</span><span class="nv">towns</span><span class="sr">;]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">canberra  
Martigues 
Mexico    
Moscow    
paris     
Washington
</span></div></div>
</div>
<p>Alas, our satisfaction will be short lived!
Imagine that <code class="docutils literal notranslate"><span class="pre">'Mexico'</span></code> now becomes <code class="docutils literal notranslate"><span class="pre">'mexico'</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">towns</span><span class="sr">[</span><span class="m">6</span><span class="sr">;</span><span class="m">1</span><span class="sr">]</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="s1">&#39;m&#39;</span><span class="w"></span>
<span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">towns</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">canberra  
paris     
Washington
Moscow    
Martigues 
mexico    
</span></div></div>
</div>
<p>In our alphabet, a lower case “m” comes before the upper case “M”, so we would obtain:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">towns</span><span class="sr">[</span><span class="nv">alph</span><span class="o">⍋</span><span class="nv">towns</span><span class="sr">;]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">canberra  
mexico    
Martigues 
Moscow    
paris     
Washington
</span></div></div>
</div>
<p>There is fortunately a solution to this annoying problem.
Instead of a vector, let us organise our alphabet into a matrix, as shown here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">alph</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">⍉</span><span class="m">27</span><span class="w"> </span><span class="m">2</span><span class="o">⍴</span><span class="nv">alph</span><span class="o">,</span><span class="s1">&#39; &#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">abcdefghijklmnopqrstuvwxyz 
ABCDEFGHIJKLMNOPQRSTUVWXYZ 
</span></div></div>
</div>
<p>Although you cannot see it, note that the last column contains a blank in both rows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">alph</span><span class="o">,</span><span class="s1">&#39;#&#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">abcdefghijklmnopqrstuvwxyz #
ABCDEFGHIJKLMNOPQRSTUVWXYZ #
</span></div></div>
</div>
<p>Now, “m” and “M” have the same priority because they are placed in the same columns of the alphabet.
When sorting a matrix, the lower case letters and the upper case letters will now be sorted identically:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">towns</span><span class="sr">[</span><span class="nv">alph</span><span class="o">⍋</span><span class="nv">towns</span><span class="sr">;]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">canberra  
Martigues 
mexico    
Moscow    
paris     
Washington
</span></div></div>
</div>
<p>Note that if we include the same town twice, but with different capitalisation, the lower case version will come first:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">towns</span><span class="w"> </span><span class="o">⍪</span><span class="kd">←</span><span class="w"> </span><span class="s1">&#39;washington&#39;</span><span class="w"></span>
<span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">towns</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">canberra  
paris     
Washington
Moscow    
Martigues 
mexico    
washington
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">towns</span><span class="sr">[</span><span class="nv">alph</span><span class="o">⍋</span><span class="nv">towns</span><span class="sr">;]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">canberra  
Martigues 
mexico    
Moscow    
paris     
washington
Washington
</span></div></div>
</div>
</div>
</div>
<div class="section" id="grading-and-permutations">
<span id="mathematical-functions-grading-and-permutations"></span><h3><span class="section-number">13.1.3. </span>Grading and Permutations<a class="headerlink" href="#grading-and-permutations" title="Permalink to this headline">#</a></h3>
<p>Suppose the function <em>grade up</em> or <em>grade down</em> is applied to a vector of length <code class="docutils literal notranslate"><span class="pre">n</span></code>.
The result of the function is going to be what mathematicians call a <em>permutation</em>.</p>
<p>A permutation (of size <code class="docutils literal notranslate"><span class="pre">n</span></code>) is a vector of length <code class="docutils literal notranslate"><span class="pre">n</span></code> that contains all integers from <code class="docutils literal notranslate"><span class="pre">1</span></code> to <code class="docutils literal notranslate"><span class="pre">n</span></code> in <em>any</em> order.
Intuitively speaking, a permutation is the vector <code class="docutils literal notranslate"><span class="pre">⍳n</span></code> shuffled.</p>
<p>As we have seen above, permutation vectors can be used to index into other vectors (or arbitrary arrays) and change the orders of their contents.
That is one of the primary use cases of permutation vectors and that is, essentially, the intended use case of the permutation vectors returned by the functions <em>grade up</em> and <em>grade down</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">word</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="s1">&#39;MISSISSIPPI&#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">permutationVector</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">⍋</span><span class="nv">word</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 5 8 11 1 9 10 3 4 6 7
</span></div></div>
</div>
<p>As we can see, the result is a permutation vector of size 11 because it contains all the integers from 1 to 11.
Then, we can use that permutation vector to reorder other vectors of length 11.
For example, we can use the permutation vector to sort the original character vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">word</span><span class="sr">[</span><span class="nv">permutationVector</span><span class="sr">]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">IIIIMPPSSSS
</span></div></div>
</div>
<p>When a vector (or another array) is indexed by a permutation vector, we know that:</p>
<ul class="simple">
<li><p>the result of the indexing will have as many elements as the array being indexed;</p></li>
<li><p>no element of the array being indexed will be repeated; and</p></li>
<li><p>all elements of the array being indexed will be in the final result.</p></li>
</ul>
<p>These characteristics of the result of the indexing operation all follow from the fact that the indexing vector is a permutation vector.</p>
<p>Finally, if you look at permutation vectors as vectors that allow you to change the order of things, sometimes you might want to change the order <strong>back</strong>.
If <code class="docutils literal notranslate"><span class="pre">p</span></code> is a permutation vector, then <code class="docutils literal notranslate"><span class="pre">⍋p</span></code> is the inverse permutation vector.
So, if you use the permutation vector <code class="docutils literal notranslate"><span class="pre">p</span></code> to reorder something, you can use the permutation vector <code class="docutils literal notranslate"><span class="pre">⍋p</span></code> to undo that reordering.</p>
<p>In other words, if <code class="docutils literal notranslate"><span class="pre">vp</span> <span class="pre">←</span> <span class="pre">v[p]</span></code>, then <code class="docutils literal notranslate"><span class="pre">v</span> <span class="pre">≡</span> <span class="pre">vp[⍋p]</span></code>.</p>
<p>Here is an example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">wordP</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">word</span><span class="sr">[</span><span class="nv">permutationVector</span><span class="sr">]</span><span class="w">  </span><span class="c1">⍝ reorder the word</span><span class="w"></span>
<span class="nv">word</span><span class="w"> </span><span class="o">≡</span><span class="w"> </span><span class="nv">wordP</span><span class="sr">[</span><span class="o">⍋</span><span class="nv">permutationVector</span><span class="sr">]</span><span class="w">  </span><span class="c1">⍝ go back</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
</div>
<div class="section" id="finding-values">
<span id="mathematical-functions-finding-values"></span><h3><span class="section-number">13.1.4. </span>Finding Values<a class="headerlink" href="#finding-values" title="Permalink to this headline">#</a></h3>
<p>The function <em>find</em> <code class="docutils literal notranslate"><span class="pre">⍷</span></code>, which you can type with <kbd>APL</kbd>+<kbd>Shift</kbd>+<kbd>E</kbd>, is a primitive function that allows you to search for an array <code class="docutils literal notranslate"><span class="pre">needle</span></code> in an array <code class="docutils literal notranslate"><span class="pre">haystack</span></code>.
The result is a Boolean array with the same shape as <code class="docutils literal notranslate"><span class="pre">haystack</span></code>, with a 1 at the starting point of each occurrence of <code class="docutils literal notranslate"><span class="pre">needle</span></code> in <code class="docutils literal notranslate"><span class="pre">haystack</span></code>.
Here is an example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">where</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="s1">&#39;at&#39;</span><span class="w"> </span><span class="o">⍷</span><span class="w"> </span><span class="s1">&#39;Congratulations&#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 0 0 1 0 0 0 1 0 0 0 0 0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;Congratulations&#39;</span><span class="o">,</span><span class="sr">[</span><span class="m">.5</span><span class="sr">]</span><span class="nv">where</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">C o n g r a t u l a t i o n s
0 0 0 0 0 1 0 0 0 1 0 0 0 0 0
</span></div></div>
</div>
<p>The function <em>find</em> can also be applied to numeric arrays.
Here, we search for a vector of 3 numbers in a longer vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">⍷</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">7</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0
</span></div></div>
</div>
<p>The rank of <code class="docutils literal notranslate"><span class="pre">haystack</span></code> can be higher than the rank of <code class="docutils literal notranslate"><span class="pre">needle</span></code>.
For example, we can search for a vector in a matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;as&#39;</span><span class="w"> </span><span class="o">⍷</span><span class="w"> </span><span class="nv">towns</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 1 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 1 0 0 0 0 0 0 0 0
</span></div></div>
</div>
<p>The opposite is also permitted (i.e., the left argument having a higher rank than the right argument), but would not be very useful.
The result would be only zeroes.</p>
</div>
</div>
<div class="section" id="encode-and-decode">
<span id="mathematical-functions-encode-and-decode"></span><h2><span class="section-number">13.2. </span>Encode and Decode<a class="headerlink" href="#encode-and-decode" title="Permalink to this headline">#</a></h2>
<p>APL offers two primitives, <em>encode</em> <code class="docutils literal notranslate"><span class="pre">⊤</span></code> and <em>decode</em> <code class="docutils literal notranslate"><span class="pre">⊥</span></code> – typed with <kbd>APL</kbd>+<kbd>n</kbd> and <kbd>APL</kbd>+<kbd>b</kbd>, respectively –, to convert numeric values from their decimal form to a representation in any other number system, and back again.</p>
<p>Because we may not be very familiar with this kind of calculation, it may seem that only mad mathematicians should invest their time studying such conversions.
In fact, these functions are used rather frequently to solve common problems.
But before studying them, we need to present some basic notions.</p>
<div class="section" id="some-words-of-theory">
<span id="mathematical-functions-some-words-of-theory"></span><h3><span class="section-number">13.2.1. </span>Some Words of Theory<a class="headerlink" href="#some-words-of-theory" title="Permalink to this headline">#</a></h3>
<div class="section" id="familiar-but-not-decimal">
<span id="mathematical-functions-familiar-but-not-decimal"></span><h4><span class="section-number">13.2.1.1. </span>Familiar, But Not Decimal<a class="headerlink" href="#familiar-but-not-decimal" title="Permalink to this headline">#</a></h4>
<p>8839 is a simple number, represented in our good old decimal system.
But if 8839 represents a number of seconds, we could just express it as 2 hours, 27 minutes, and 19 seconds.
<code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">27</span> <span class="pre">19</span></code> is the representation of <code class="docutils literal notranslate"><span class="pre">8839</span></code> in a non-uniform number system based on 24 hour days, each divided into 60 minutes, each divided into 60 seconds.</p>
<p>The second representation is more familiar to us, but is <strong>not</strong> a decimal representation: the value has been expressed in a complex <em>base</em> (or <em>radix</em>); we shall say that it is <strong>coded</strong>, even though it is familiar.</p>
<p>Converting <code class="docutils literal notranslate"><span class="pre">8839</span></code> into <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">27</span> <span class="pre">19</span></code> is called <em>encoding</em> because the result is not decimal.
Converting <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">27</span> <span class="pre">19</span></code> into <code class="docutils literal notranslate"><span class="pre">8839</span></code> is called <em>decoding</em> because the result is decimal.
We shall say that <code class="docutils literal notranslate"><span class="pre">24</span> <span class="pre">60</span> <span class="pre">60</span></code> is the <em>base</em> of the number system of <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">27</span> <span class="pre">19</span></code>.</p>
</div>
<div class="section" id="three-important-remarks">
<span id="mathematical-functions-three-important-remarks"></span><h4><span class="section-number">13.2.1.2. </span>Three Important Remarks<a class="headerlink" href="#three-important-remarks" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>In this case, encoding a scalar (<code class="docutils literal notranslate"><span class="pre">8839</span></code>) produces a vector (<code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">27</span> <span class="pre">19</span></code>).
In general, the representation of a decimal scalar in a non-decimal base cannot be expected to be a single number.
It will always be an array of the same shape as the left argument to the function <em>encode</em>, and in all but very special cases this left argument will be a vector or a higher-rank array.</p></li>
</ul>
<p>For example, a binary value cannot be written as <code class="docutils literal notranslate"><span class="pre">101011</span></code> (this is a decimal number); it must be written as a vector of binary digits: <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">0</span> <span class="pre">1</span> <span class="pre">0</span> <span class="pre">1</span> <span class="pre">1</span></code>.</p>
<ul class="simple">
<li><p>The items of an encoded value can be greater than 9.
In our examples, we had items equal to 27 and 19.
But they are always smaller than the corresponding item of the <em>base</em>.
Would you say that you spent 2 hours and 87 minutes to do something?
Probably not, because 87 is greater than 60.
You would say 3 hours and 27 minutes.</p></li>
<li><p>No mater whether days were made of only 18 hours, 2 hours, 27 minutes, and 19 seconds would always represent 8839 seconds.</p></li>
</ul>
<p>This leads to the following rule: the first item of the base vector is never taken into account when <em>decoding</em>, but it is always used for <em>encoding</em>.</p>
</div>
<div class="section" id="base-and-weights">
<span id="mathematical-functions-base-and-weights"></span><h4><span class="section-number">13.2.1.3. </span>Base and Weights<a class="headerlink" href="#base-and-weights" title="Permalink to this headline">#</a></h4>
<p>Given the <em>base</em> vector <code class="docutils literal notranslate"><span class="pre">24</span> <span class="pre">60</span> <span class="pre">60</span></code> and a value <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">27</span> <span class="pre">19</span></code>, one can <em>decode</em> it (obtain its decimal representation) by any of the three formulas that follow.
(Note that <code class="docutils literal notranslate"><span class="pre">3600=60×60</span></code>.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">2</span><span class="o">×</span><span class="m">3600</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="m">27</span><span class="o">×</span><span class="m">60</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">19</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">8839
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span><span class="w"> </span><span class="m">3600</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">×</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">19</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">8839
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3600</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">19</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">8839
</span></div></div>
</div>
<p>The last formula clearly shows that decoding a set of values is nothing else than an <em>inner product</em>.
This is important because it means that the same shape compatibility rules will apply.</p>
<p>The values <code class="docutils literal notranslate"><span class="pre">3600</span> <span class="pre">60</span> <span class="pre">1</span></code> are the <em>weights</em> representing how many seconds are in an hour, in a minute, and in a second.
They can be obtained from the <em>base</em> vector as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">base</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">60</span><span class="w"></span>
<span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">weights</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">⌽</span><span class="w"> </span><span class="m">1</span><span class="o">,×</span><span class="na">\</span><span class="w"> </span><span class="o">⌽</span><span class="w"> </span><span class="m">1</span><span class="o">↓</span><span class="nv">base</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3600 60 1
</span></div></div>
</div>
<p>This formula confirms the remark we made earlier: the first item of the <em>base</em> vector is not used when <em>decoding</em> a value.
However, it is needed in order to do the reverse operation (<em>encoding</em>) using the same <em>base</em> vector.</p>
<p>Once the weights are calculated, we can define the relationship between <em>decode</em> and <em>inner product</em>:</p>
<div class="tip admonition">
<p class="admonition-title">Remark</p>
<p><code class="docutils literal notranslate"><span class="pre">base</span> <span class="pre">⊥</span> <span class="pre">values</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">weights</span> <span class="pre">+.×</span> <span class="pre">values</span></code>.</p>
</div>
</div>
</div>
<div class="section" id="using-decode-encode">
<span id="mathematical-functions-using-decode-encode"></span><h3><span class="section-number">13.2.2. </span>Using Decode &amp; Encode<a class="headerlink" href="#using-decode-encode" title="Permalink to this headline">#</a></h3>
<div class="section" id="decode">
<span id="mathematical-functions-decode"></span><h4><span class="section-number">13.2.2.1. </span>Decode<a class="headerlink" href="#decode" title="Permalink to this headline">#</a></h4>
<p><em>Decode</em> is represented by <code class="docutils literal notranslate"><span class="pre">⊥</span></code>.
It accepts the <em>base</em> vector directly as its left argument, so that you do not have to calculate the weights:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">base</span><span class="w"> </span><span class="o">⊥</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">19</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">8839
</span></div></div>
</div>
<p>Because the first item of the base vector is not used when decoding, we could have obtained the same result in this way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">base</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">60</span><span class="w"></span>
<span class="nv">base</span><span class="w"> </span><span class="o">⊥</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">19</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">8839
</span></div></div>
</div>
<p>As another example application of the function <em>decode</em>, suppose eggs are packaged in boxes, each containing 6 packs of 6 eggs.</p>
<p>If we have 2 full boxes, plus 5 packs, plus 3 eggs, we can calculate the total number of eggs using any of the following expressions, each giving the same result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">2</span><span class="o">×</span><span class="m">36</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="m">5</span><span class="o">×</span><span class="m">6</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">105
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span><span class="w"> </span><span class="m">36</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">×</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">105
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">36</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">105
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="o">⊥</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">105
</span></div></div>
</div>
<p>The first item of the base is not relevant when decoding, so we could have used any other element:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">999</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="o">⊥</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">105
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="o">⊥</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">105
</span></div></div>
</div>
<p>However, in this very special case, our base is uniform (<code class="docutils literal notranslate"><span class="pre">6</span> <span class="pre">6</span> <span class="pre">6</span></code>), which lets us write the last expression in a simpler way.
As usual, the scalar value is reused as appropriate:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">6</span><span class="w"> </span><span class="o">⊥</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">105
</span></div></div>
</div>
<p>This says that <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">5</span> <span class="pre">3</span></code> is the base 6 representation of 105.</p>
</div>
<div class="section" id="shape-compatibility">
<span id="mathematical-functions-shape-compatibility"></span><h4><span class="section-number">13.2.2.2. </span>Shape Compatibility<a class="headerlink" href="#shape-compatibility" title="Permalink to this headline">#</a></h4>
<p>We said that <em>decode</em> is nothing but a plain <em>inner product</em>, so the same shape compatibility rules must be satisfied.</p>
<p>Imagine that we have to convert two durations given in hours, minutes, and seconds, into just seconds.
The first duration is 2 hours, 27 minutes, and 19 seconds, and the second one is 5 hours, 3 minutes, and 48 seconds.
When we put those durations into a single variable, it is natural to express the data as a matrix, as shown here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">hms</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="o">⍴</span><span class="m">2</span><span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">19</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">48</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 27 19
5  3 48
</span></div></div>
</div>
<p>But we cannot combine a 3-item vector (<code class="docutils literal notranslate"><span class="pre">base</span> <span class="pre">←</span> <span class="pre">24</span> <span class="pre">60</span> <span class="pre">60</span></code>) with a 2-row matrix (<code class="docutils literal notranslate"><span class="pre">hms</span></code>).
<code class="docutils literal notranslate"><span class="pre">base</span> <span class="pre">⊥</span> <span class="pre">hms</span></code> would cause a <code class="docutils literal notranslate"><span class="pre">LENGTH</span> <span class="pre">ERROR</span></code>.
We must transpose <code class="docutils literal notranslate"><span class="pre">hms</span></code> in order to make the lengths of the arguments compatible:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">base</span><span class="w"> </span><span class="o">⊥</span><span class="w"> </span><span class="o">⍉</span><span class="nv">hms</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">8839 18228
</span></div></div>
</div>
<p>The length of <code class="docutils literal notranslate"><span class="pre">base</span></code> is equal to the length of the first dimension of <code class="docutils literal notranslate"><span class="pre">⍉hms</span></code>.
The same rule applies to <em>inner product</em>.</p>
</div>
<div class="section" id="encode">
<span id="mathematical-functions-encode"></span><h4><span class="section-number">13.2.2.3. </span>Encode<a class="headerlink" href="#encode" title="Permalink to this headline">#</a></h4>
<p>As an example of encoding a decimal number, we can encode 105 into base 6:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="o">⊤</span><span class="w"> </span><span class="m">105</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 5 3
</span></div></div>
</div>
<p>Please note that specifying a scalar as the left argument in the expression above does not give the same result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">6</span><span class="w"> </span><span class="o">⊤</span><span class="w"> </span><span class="m">105</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3
</span></div></div>
</div>
<p>The reason is that it is not really possible for APL to “reuse the scalar as appropriate” here, because what does “appropriate” mean in this case?
The left argument to <em>encode</em> defines the number of digits in the new number system, so if we want or need three digits, we must specify three <code class="docutils literal notranslate"><span class="pre">6</span></code>s.
(In <a class="reference internal" href="Operators.html#operators-the-result-of-an-inverse-function"><span class="std std-numref">Section 11.15.8</span></a> you find an example showing a clever way to have APL itself figure out the number of digits needed to properly encode a number.)</p>
<p>We can convert a number of seconds into hours, minutes, and seconds, like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">24</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="o">⊤</span><span class="w"> </span><span class="m">23456</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6 30 56
</span></div></div>
</div>
<p>However, when converting 3 values, the results must be read carefully:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">24</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="o">⊤</span><span class="w"> </span><span class="m">8839</span><span class="w"> </span><span class="m">23456</span><span class="w"> </span><span class="m">18228</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 2  6  5
27 30  3
19 56 48
</span></div></div>
</div>
<p>Do not read these results horizontally: 8839 seconds are <strong>not</strong> equal to 2 hours, 5 minutes, and 2 seconds!
You must read the result vertically, and you will recognise the results we got earlier: <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">27</span> <span class="pre">19</span></code>, <code class="docutils literal notranslate"><span class="pre">6</span> <span class="pre">30</span> <span class="pre">56</span></code>, and <code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">3</span> <span class="pre">48</span></code>.</p>
</div>
<div class="section" id="limited-encoding">
<span id="mathematical-functions-limited-encoding"></span><h4><span class="section-number">13.2.2.4. </span>Limited Encoding<a class="headerlink" href="#limited-encoding" title="Permalink to this headline">#</a></h4>
<p>The shape of the result of <code class="docutils literal notranslate"><span class="pre">bases</span> <span class="pre">⊤</span> <span class="pre">values</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">bases</span> <span class="pre">,⍥⍴</span> <span class="pre">values</span></code>.</p>
<p>No specific rule is imposed on the arguments’ shapes, but if the last dimension of the base is too small, APL proceeds to a limited encoding, as shown below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">24</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="o">⊤</span><span class="w"> </span><span class="m">8839</span><span class="w">  </span><span class="c1">⍝ full conversion</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 27 19
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">60</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="o">⊤</span><span class="w"> </span><span class="m">8839</span><span class="w">  </span><span class="c1">⍝ truncated result</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">27 19
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">60</span><span class="w"> </span><span class="o">⊤</span><span class="w"> </span><span class="m">8839</span><span class="w">  </span><span class="c1">⍝ ditto</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">19
</span></div></div>
</div>
<p>The last two results are truncated to the length of the specified base vector, but nothing indicates that they have been truncated.
To avoid potential misinterpretation, it is common to use a leading zero as the first item of the base:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="o">⊤</span><span class="w"> </span><span class="m">123456</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 10 17 36
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="o">⊤</span><span class="w"> </span><span class="m">123456</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">34 17 36
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="o">⊤</span><span class="w"> </span><span class="m">123456</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2057 36
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span><span class="w"> </span><span class="o">⊤</span><span class="w"> </span><span class="m">123456</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">123456
</span></div></div>
</div>
<p>The first conversion states that 123456 seconds represent 1 day, 10 hours, 17 minutes, and 36 seconds.
In the second conversion, limited to hours, 1 day plus 10 hours gave 34 hours.
In the third conversion, limited to minutes, shows that 123456 seconds is 2057 minutes and 36 seconds.</p>
</div>
<div class="section" id="using-several-simultaneous-bases">
<span id="mathematical-functions-using-several-simultaneous-bases"></span><h4><span class="section-number">13.2.2.5. </span>Using Several Simultaneous Bases<a class="headerlink" href="#using-several-simultaneous-bases" title="Permalink to this headline">#</a></h4>
<p>If one needs to encode or decode several values in several different bases, <em>base</em> will no longer be a vector, but a matrix.
However, this is a bit more complex and will be studied in <a class="reference internal" href="#mathematical-functions-the-specialists-section"><span class="std std-numref">Section 13.7</span></a>.</p>
</div>
</div>
<div class="section" id="applications-of-encoding-and-decoding">
<span id="mathematical-functions-applications-of-encoding-and-decoding"></span><h3><span class="section-number">13.2.3. </span>Applications of Encoding and Decoding<a class="headerlink" href="#applications-of-encoding-and-decoding" title="Permalink to this headline">#</a></h3>
<div class="section" id="condense-or-expand-values">
<span id="mathematical-functions-condense-or-expand-values"></span><h4><span class="section-number">13.2.3.1. </span>Condense or Expand Values<a class="headerlink" href="#condense-or-expand-values" title="Permalink to this headline">#</a></h4>
<p>It is sometimes convenient to condense several values into a single one.
In general, this does not save much memory space, but it may be more convenient to manipulate a single value rather than several.
This can be achieved by decoding the values into a decimal number.</p>
<p>Say, for example, that you have a list of 5 rarely used settings that you need to save in a relational database.
Instead of creating 5 columns in the database table to hold the settings, you could <em>decode</em> the 5 values into a decimal integer and save it in a single database column.</p>
<p>Often, it is convenient to select a base made of powers of 10, corresponding to the maximum number of digits of the given values, for example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">100</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="o">⊥</span><span class="w"> </span><span class="m">35</span><span class="w"> </span><span class="m">681</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">24</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">35681724
</span></div></div>
</div>
<p>The single value <code class="docutils literal notranslate"><span class="pre">35681724</span></code> contains the same information as the original vector, and because all base values used are powers of 10, it is fairly easy to recognise the original numbers.</p>
<p>The conversion base was built like this:</p>
<ul class="simple">
<li><p>100 for 35 which has 2 digits;</p></li>
<li><p>1000 for 681 which has 3 digits;</p></li>
<li><p>10 for 7 which has only 1 digit; and</p></li>
<li><p>100 for 24 which has 2 digits.</p></li>
</ul>
<p>Of course, the base vector must be built according to the largest values that can appear in each of the items, not just from an arbitrary number as in our small example.</p>
<p>The reverse transformation may be done by encoding the value using the same base:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">100</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="o">⊤</span><span class="w"> </span><span class="m">35681724</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">35 681 7 24
</span></div></div>
</div>
<p>A similar technique may be used to separate the integer and decimal parts of positive numbers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="o">⊤</span><span class="m">127.83</span><span class="w"> </span><span class="m">619.26</span><span class="w"> </span><span class="m">423.44</span><span class="w"> </span><span class="m">19.962</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">127    619    423    19
  0.83   0.26   0.44  0.962
</span></div></div>
</div>
</div>
<div class="section" id="calculating-polynomials">
<span id="mathematical-functions-calculating-polynomials"></span><h4><span class="section-number">13.2.3.2. </span>Calculating Polynomials<a class="headerlink" href="#calculating-polynomials" title="Permalink to this headline">#</a></h4>
<p>Let us recall the example about packing eggs:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">6</span><span class="o">⊥</span><span class="m">2</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">105
</span></div></div>
</div>
<p>We can say that we used <em>decode</em> to calculate <code class="docutils literal notranslate"><span class="pre">(2×6*2)</span> <span class="pre">+</span> <span class="pre">(5×6)</span> <span class="pre">+</span> <span class="pre">3</span></code>.
In other words, using traditional math notation, we calculated <span class="math notranslate nohighlight">\(2x^2 + 5x + 3\)</span> for <span class="math notranslate nohighlight">\(x = 6\)</span>.
This example shows that <em>decode</em> can be used to calculate a polynomial represented by the coefficients of the unknown variable, sorted according to the decreasing powers of the variable.</p>
<p>For example, to calculate <span class="math notranslate nohighlight">\(3x^4 + 2x^2 - 7x + 2\)</span> for <span class="math notranslate nohighlight">\(x = 1.2\)</span>, we can write</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1.2</span><span class="w"> </span><span class="o">⊥</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">¯7</span><span class="w"> </span><span class="m">2</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2.7008
</span></div></div>
</div>
<p>Do not forget zero coefficients for the missing powers of <span class="math notranslate nohighlight">\(x\)</span> (here, we have no term in <span class="math notranslate nohighlight">\(x^3\)</span>).</p>
<p>This is equivalent to</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">1.2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">¯7</span><span class="w"> </span><span class="m">2</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2.7008
</span></div></div>
</div>
<p>To calculate the value of a polynomial for several values of <span class="math notranslate nohighlight">\(x\)</span>, the values must be placed in a vertical 1-column matrix, to be compliant with the shape compatibility rules.
For example, to calculate the same polynomial for <span class="math notranslate nohighlight">\(x\)</span> varying from 0 to 2 by steps of 0.2, we could write:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">xs</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">0.2</span><span class="w"> </span><span class="o">×</span><span class="w"> </span><span class="m">¯1</span><span class="o">+⍳</span><span class="m">11</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span><span class="o">⍕</span><span class="w"> </span><span class="p">(</span><span class="o">⍪</span><span class="nv">xs</span><span class="p">)</span><span class="w"> </span><span class="o">⊥</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">¯7</span><span class="w"> </span><span class="m">2</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 2.00 0.68 ¯0.40 ¯1.09 ¯1.09 0.00 2.70 7.64 15.58 27.37 44.00
</span></div></div>
</div>
<p>The results have been displayed with only 2 decimal digits using an appropriate <em>format</em>.</p>
<p>Finally, let us calculate <span class="math notranslate nohighlight">\(4x^4 + 2x^3 + 3x^2 - x - 6\)</span> for <span class="math notranslate nohighlight">\(x = -1.5\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">¯1.5</span><span class="w"> </span><span class="o">⊥</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">¯1</span><span class="w"> </span><span class="m">¯6</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">15.75
</span></div></div>
</div>
<p>Notice how we used a negative base.
That may seem strange, but there is nothing mathematically wrong with it.</p>
</div>
<div class="section" id="right-aligning-text">
<span id="mathematical-functions-right-aligning-text"></span><h4><span class="section-number">13.2.3.3. </span>Right-aligning Text<a class="headerlink" href="#right-aligning-text" title="Permalink to this headline">#</a></h4>
<p>We mentioned that <em>decode</em> could be replaced by an <em>inner product</em> using the following equivalence: <code class="docutils literal notranslate"><span class="pre">base</span> <span class="pre">⊥</span> <span class="pre">values</span> <span class="pre">←→</span> <span class="pre">weights</span> <span class="pre">+.×</span> <span class="pre">values</span></code>, if <code class="docutils literal notranslate"><span class="pre">weights</span> <span class="pre">←</span> <span class="pre">⌽1,×\⌽1↓base</span></code>.</p>
<p>What happens if the vector <code class="docutils literal notranslate"><span class="pre">base</span></code> contains one or more zeroes?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⌽</span><span class="m">1</span><span class="o">,×</span><span class="na">\</span><span class="o">⌽</span><span class="m">1</span><span class="o">↓</span><span class="m">10</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">2</span><span class="w">  </span><span class="c1">⍝ base has no zeroes</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2400 300 60 20 2 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⌽</span><span class="m">1</span><span class="o">,×</span><span class="na">\</span><span class="o">⌽</span><span class="m">1</span><span class="o">↓</span><span class="m">10</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">2</span><span class="w">  </span><span class="c1">⍝ base has a zero</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 60 20 2 1
</span></div></div>
</div>
<p>We can see that the weights to the left of a zero are all forced to become zero.
In other words, <code class="docutils literal notranslate"><span class="pre">10</span> <span class="pre">8</span> <span class="pre">0</span> <span class="pre">3</span> <span class="pre">10</span> <span class="pre">2</span> <span class="pre">⊥</span> <span class="pre">values</span></code> is strictly identical to <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">0</span> <span class="pre">0</span> <span class="pre">3</span> <span class="pre">10</span> <span class="pre">2</span> <span class="pre">⊥</span> <span class="pre">values</span></code>.</p>
<p>Let us use this discovery to right-align some text containing blanks:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">↑</span><span class="s1">&#39;This little&#39;</span><span class="w"> </span><span class="s1">&#39;text contains both&#39;</span><span class="w"> </span><span class="s1">&#39;embedded and&#39;</span><span class="w"> </span><span class="s1">&#39;trailing blanks&#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">This little       
text contains both
embedded and      
trailing blanks   
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">text</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 0 1 0 0 0 0 0 0 1 1 1 1 1 1 1
0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0
0 0 0 0 0 0 0 0 1 0 0 0 1 1 1 1 1 1
0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 1 1
</span></div></div>
</div>
<p>If we use the rows of this Boolean matrix as decoding bases, the result above states that the ones placed to the left of a zero will not have any effect.
This means that the expression</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">¯1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="o">⊥</span><span class="na">⍨</span><span class="nv">text</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">7 0 6 3
</span></div></div>
</div>
<p>counts the number of trailing <code class="docutils literal notranslate"><span class="pre">1</span></code>s in each row.
Thus, we can use those numbers to rotate right each row:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">text</span><span class="o">⌽</span><span class="na">⍨</span><span class="m">1</span><span class="o">-</span><span class="m">1</span><span class="o">⊥</span><span class="na">⍨</span><span class="nv">text</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">       This little
text contains both
      embedded and
   trailing blanks
</span></div></div>
</div>
<p>Another example uses the same property of <em>decode</em>: given a Boolean vector <code class="docutils literal notranslate"><span class="pre">bin</span></code>, one can find how many <code class="docutils literal notranslate"><span class="pre">1</span></code>s there are to the right of the last zero using the expression <code class="docutils literal notranslate"><span class="pre">bin⊥bin</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">bin</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w">  </span><span class="c1">⍝ 3 trailing ones</span><span class="w"></span>
<span class="nv">bin</span><span class="o">⊥</span><span class="nv">bin</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3
</span></div></div>
</div>
</div>
</div>
</div>
<div class="section" id="randomised-values">
<span id="mathematical-functions-randomised-values"></span><h2><span class="section-number">13.3. </span>Randomised Values<a class="headerlink" href="#randomised-values" title="Permalink to this headline">#</a></h2>
<p><strong>Random numbers</strong> are often used for demonstration purposes or to test an algorithm.
Strictly speaking, “random” would mean that a set of values is completely unpredictable.
This is not the case for numbers generated by a computer: they are, by definition, perfectly deterministic.</p>
<p>However, the values produced by an algorithm may appear to a human being as if they were random values when, given a subset of those numbers, the human is unable to predict the next values in the sequence.
If this first condition is satisfied, and if all of the unique values in a long series appear approximately the same number of times, these values can be qualified as <em>pseudo-random</em> numbers.</p>
<p>In APL, the question mark <code class="docutils literal notranslate"><span class="pre">?</span></code> is used to produce pseudo-random numbers.</p>
<div class="section" id="deal-dyadic-usage">
<span id="mathematical-functions-deal-dyadic-usage"></span><h3><span class="section-number">13.3.1. </span>Deal: Dyadic Usage<a class="headerlink" href="#deal-dyadic-usage" title="Permalink to this headline">#</a></h3>
<p>The dyadic usage of the question mark is called <em>deal</em>.
The expression <code class="docutils literal notranslate"><span class="pre">number</span> <span class="pre">?</span> <span class="pre">limit</span></code> produces as many unique pseudo-random integers as specified by <code class="docutils literal notranslate"><span class="pre">number</span></code>, all among <code class="docutils literal notranslate"><span class="pre">⍳limit</span></code>.
For this reason, we must have <code class="docutils literal notranslate"><span class="pre">number≤limit</span></code>.</p>
<p>The name of the function <em>deal</em> relates to dealing cards.
When you are dealt a hand of cards from a deck, the cards that you get are arbitrary and you cannot be given the same card twice.
You may get cards with the same value or with the same suit, but you <strong>cannot</strong> get the exact same card twice.</p>
<p>Some examples follow.
First, we deal a hand of 7 numbers out of 52:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">7</span><span class="o">?</span><span class="m">52</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">36 35 20 49 44 5 51
</span></div></div>
</div>
<p>If we execute the same expression again, we get a different set of values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">7</span><span class="o">?</span><span class="m">52</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">50 26 10 40 4 34 2
</span></div></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">number=limit</span></code>, we get a permutation of <code class="docutils literal notranslate"><span class="pre">⍳limit</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">12</span><span class="o">?</span><span class="m">12</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6 9 12 4 10 7 1 2 5 8 11 3
</span></div></div>
</div>
<p>And as we mentioned before, we cannot have <code class="docutils literal notranslate"><span class="pre">number&gt;limit</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">13</span><span class="o">?</span><span class="m">12</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DOMAIN ERROR: Deal right argument must be greater than or equal to the left argument
      13?12
        ∧
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="roll-monadic-use">
<span id="mathematical-functions-roll-monadic-use"></span><h3><span class="section-number">13.3.2. </span>Roll: Monadic Use<a class="headerlink" href="#roll-monadic-use" title="Permalink to this headline">#</a></h3>
<p>The monadic use of the question mark is called <em>roll</em>.
The name relates to rolling a die.</p>
<div class="section" id="positive-integer-arrays-as-argument">
<span id="mathematical-functions-positive-integer-arrays-as-argument"></span><h4><span class="section-number">13.3.2.1. </span>Positive Integer Arrays as Argument<a class="headerlink" href="#positive-integer-arrays-as-argument" title="Permalink to this headline">#</a></h4>
<p>In the expression <code class="docutils literal notranslate"><span class="pre">?array</span></code>, where <code class="docutils literal notranslate"><span class="pre">array</span></code> is any array of positive integer values, each item <code class="docutils literal notranslate"><span class="pre">a</span></code> of <code class="docutils literal notranslate"><span class="pre">array</span></code> produces a pseudo-random value from <code class="docutils literal notranslate"><span class="pre">⍳a</span></code>, so that the result is an array of the same shape as <code class="docutils literal notranslate"><span class="pre">array</span></code>.
Each item of the result is calculated independently of the other items.</p>
<p>Here are some examples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3 4
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6 2 6 2
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">mat</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>VALUE ERROR: Undefined name: mat
      mat
      ∧
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="nv">mat</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>VALUE ERROR: Undefined name: mat
      ?mat
       ∧
</pre></div>
</div>
</div>
</div>
<p>If the argument of <em>roll</em> is made of a repeated single value <code class="docutils literal notranslate"><span class="pre">v</span></code>, the result is an array made of values all taken from <code class="docutils literal notranslate"><span class="pre">⍳v</span></code>.
This makes it possible to produce any number of values within the same limits.</p>
<p>For example, we can simulate rolling a die 10 times:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="m">10</span><span class="o">⍴</span><span class="m">6</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6 6 6 3 4 6 2 3 5 6
</span></div></div>
</div>
<p>As another example, we can fill a matrix with the number <code class="docutils literal notranslate"><span class="pre">20</span></code>.
Then, for each of those numbers, we generate a pseudo-random number in <code class="docutils literal notranslate"><span class="pre">⍳20</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="m">4</span><span class="w"> </span><span class="m">8</span><span class="o">⍴</span><span class="m">20</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">15 10 1 14 16  6 11  4
 1 19 5  8 12 19  2 17
 1 15 8  3  5  7  8 11
12 19 2 12 17 19 14 20
</span></div></div>
</div>
</div>
<div class="section" id="as-argument">
<span id="mathematical-functions-0-as-argument"></span><h4><span class="section-number">13.3.2.2. </span>0 as Argument<a class="headerlink" href="#as-argument" title="Permalink to this headline">#</a></h4>
<p>The function <em>deal</em> can also handle <code class="docutils literal notranslate"><span class="pre">0</span></code> as an argument (either as a scalar, or as element(s) of the argument array).
When presented with a zero, the function <em>deal</em> will generate a pseudo-random decimal number strictly between 0 and 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="m">0</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.355175
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="m">0</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.978111
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="m">0</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.749925
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 5 0.562462 0.548926 3 3
</span></div></div>
</div>
</div>
</div>
<div class="section" id="derived-usages">
<span id="mathematical-functions-derived-usages"></span><h3><span class="section-number">13.3.3. </span>Derived Usages<a class="headerlink" href="#derived-usages" title="Permalink to this headline">#</a></h3>
<div class="section" id="random-number-within-an-arbitrary-range">
<span id="mathematical-functions-random-number-within-an-arbitrary-range"></span><h4><span class="section-number">13.3.3.1. </span>Random Number Within an Arbitrary Range<a class="headerlink" href="#random-number-within-an-arbitrary-range" title="Permalink to this headline">#</a></h4>
<p>We have seen that the values produced by <em>deal</em> and <em>roll</em> are always integer values extracted from <code class="docutils literal notranslate"><span class="pre">⍳v</span></code>, where <code class="docutils literal notranslate"><span class="pre">v</span></code> is a given limit.
However, it is possible to obtain a set of integers or decimal values between any limits, just by adding a constant and dividing by some appropriate value.</p>
<p>Imagine that we would like to obtain 10 decimal values, with 2 decimal digits, all between 743 and 761, inclusive.
We could follow these steps:</p>
<ul class="simple">
<li><p>Let us first calculate integer values starting from 1:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">lims</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">743</span><span class="w"> </span><span class="m">761</span><span class="w"></span>
<span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">set</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="m">10</span><span class="o">⍴</span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">100</span><span class="o">×-</span><span class="na">⍨/</span><span class="nv">lims</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1494 514 1104 336 1586 444 1088 775 1459 1458
</span></div></div>
</div>
<ul class="simple">
<li><p>The values generated above are between 1 and 1801.</p></li>
<li><p>If we add <code class="docutils literal notranslate"><span class="pre">¯1+100×743</span></code> we obtain values between 74300 and 76100:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">set</span><span class="w"> </span><span class="o">+</span><span class="kd">←</span><span class="w"> </span><span class="m">¯1</span><span class="o">+</span><span class="m">100</span><span class="o">×⌊</span><span class="na">/</span><span class="nv">lims</span><span class="w"></span>
<span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">set</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">75793 74813 75403 74635 75885 74743 75387 75074 75758 75757
</span></div></div>
</div>
<ul class="simple">
<li><p>Once divided by 100, they give decimal values with two decimal places between 743 and 761, inclusive:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">set</span><span class="w"> </span><span class="o">÷</span><span class="kd">←</span><span class="w"> </span><span class="m">100</span><span class="w"></span>
<span class="nv">set</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">757.93 748.13 754.03 746.35 758.85 747.43 753.87 750.74 757.58 757.57
</span></div></div>
</div>
<p>We can check if the limits are well respected:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">⌊</span><span class="na">/</span><span class="o">,⌈</span><span class="na">/</span><span class="p">)</span><span class="w"> </span><span class="nv">set</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">746.35 758.85
</span></div></div>
</div>
</div>
<div class="section" id="sets-of-random-characters">
<span id="mathematical-functions-sets-of-random-characters"></span><h4><span class="section-number">13.3.3.2. </span>Sets of Random Characters<a class="headerlink" href="#sets-of-random-characters" title="Permalink to this headline">#</a></h4>
<p>Random characters can be obtained by indexing a set of characters by a random set of integer values smaller than or equal to the size of the character vector, as shown here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕A</span><span class="sr">[</span><span class="o">?</span><span class="m">3</span><span class="w"> </span><span class="m">15</span><span class="o">⍴≢</span><span class="nf">⎕A</span><span class="sr">]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">CLOKIJUGZXBQPRW
BINSCHZCQSEYYHF
MMQLWFUMOBTKPJD
</span></div></div>
</div>
</div>
</div>
<div class="section" id="random-link">
<span id="mathematical-functions-random-link"></span><h3><span class="section-number">13.3.4. </span>Random Link<a class="headerlink" href="#random-link" title="Permalink to this headline">#</a></h3>
<p>The system variable <code class="docutils literal notranslate"><span class="pre">⎕RL</span></code> has been used throughout this book when creating large(r) arrays with random values and this section will explain what <code class="docutils literal notranslate"><span class="pre">⎕RL</span></code>, called <em>random link</em>, actually does.</p>
<div class="section" id="reproducibility-when-generating-random-numbers">
<span id="mathematical-functions-reproducibility-when-generating-random-numbers"></span><h4><span class="section-number">13.3.4.1. </span>Reproducibility When Generating Random Numbers<a class="headerlink" href="#reproducibility-when-generating-random-numbers" title="Permalink to this headline">#</a></h4>
<p>The primitive functions <em>deal</em> and <em>roll</em> do not produce really random numbers.
They produce pseudo-random numbers because there is actually an algorithm that runs to generate specific numbers, although the numbers generated by this algorithm “look random”.</p>
<p>The algorithm makes use of something called a <em>seed value</em>, that you set within <em>random link</em>, and each time a new (pseudo-random) value is generated, this seed value is changed so that the next value will be different.</p>
<p>Sometimes, one might want to be able to recreate a random event later on.
For example, when running an experiment or a simulation, you may want to generate some numbers that you did not specify explicitly, but you may need to generate the exact same numbers later.
This is possible thanks to <em>random link</em>.</p>
<p>To reproduce a given set of random values, one can dynamically set <code class="docutils literal notranslate"><span class="pre">⎕RL</span></code> to any desired value, an integer in the range from 1 to 2147483646.</p>
<p>For example, throughout the book we have used the function <em>roll</em> to generate a 4 by 6 matrix we have called <code class="docutils literal notranslate"><span class="pre">forecast</span></code>.
If we did not use <em>random link</em>, each time you opened the book, you would get a different matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">10</span><span class="o">×?</span><span class="m">4</span><span class="w"> </span><span class="m">6</span><span class="o">⍴</span><span class="m">55</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">350  40  80 190 460 190
250 380  50 410 180 150
550  70 170 310 380 370
520 390 470 300 540 250
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">10</span><span class="o">×?</span><span class="m">4</span><span class="w"> </span><span class="m">6</span><span class="o">⍴</span><span class="m">55</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">360 120  50 370 510 380
460 140 270 230 370 380
550 550 450 180 160 520
420 470  30 330 500 500
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">10</span><span class="o">×?</span><span class="m">4</span><span class="w"> </span><span class="m">6</span><span class="o">⍴</span><span class="m">55</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">320 410 220  20 270 550
270 220 350 500 360 310
130  70 260 180 430 100
450 250  40 540 350 310
</span></div></div>
</div>
<p>To prevent this, before generating the matrix <code class="docutils literal notranslate"><span class="pre">forecast</span></code>, we set the <em>random link</em> <code class="docutils literal notranslate"><span class="pre">⎕RL</span></code> to a specific value, which has been <code class="docutils literal notranslate"><span class="pre">⎕RL</span> <span class="pre">←</span> <span class="pre">73</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕RL</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">73</span><span class="w"></span>
<span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">forecast</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">10</span><span class="o">×?</span><span class="m">4</span><span class="w"> </span><span class="m">6</span><span class="o">⍴</span><span class="m">55</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 90 160 420 500  20  30
110 450 170 370 290 360
340 190 320 120 510 370
150 460 240 520 490 280
</span></div></div>
</div>
<p>It is not relevant that the seed was set to <code class="docutils literal notranslate"><span class="pre">73</span></code>.
What is relevant is that the seed <strong>was set to a fixed value</strong>.</p>
<p>Each time you start the APL interpreter or clear the session with <code class="docutils literal notranslate"><span class="pre">)clear</span></code>, APL will reset the <em>random link</em> so you can get pseudo-random values out of the box.
So, you only need to change the <em>random link</em> when you know you will need reproducibility.</p>
<p>If you have set the seed for some computations but need to go back to generating pseudo-random numbers over which you have no control, you can set the <em>random link</em> to <em>zilde</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕RL</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="no">⍬</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-algorithm">
<span id="mathematical-functions-the-algorithm"></span><h4><span class="section-number">13.3.4.2. </span>The Algorithm<a class="headerlink" href="#the-algorithm" title="Permalink to this headline">#</a></h4>
<p>APL uses one of three algorithm to generate pseudo-random numbers and you can check which one is being used by looking at the value of <code class="docutils literal notranslate"><span class="pre">⎕RL</span></code>.
<code class="docutils literal notranslate"><span class="pre">⎕RL</span></code> is a 2-item vector, where the first item is the current seed and the second item is an integer between 0 and 2:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕RL</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌┬─┐
││1│
└┴─┘
</span></div></div>
</div>
<p>In this case, the seed is <code class="docutils literal notranslate"><span class="pre">⍬</span></code> and the algorithm chosen is the algorithm 1.
If you read the Dyalog documentation, you will find some information on the three possible algorithms:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Id</p></th>
<th class="text-align:left head"><p>Name</p></th>
<th class="text-align:left head"><p>Algorithm</p></th>
<th class="text-align:left head"><p>Valid seed values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>0</p></td>
<td class="text-align:left"><p>RNG0</p></td>
<td class="text-align:left"><p>Lehmer linear congruential generator</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">⍬</span></code>, or an integer in the range 1 to <code class="docutils literal notranslate"><span class="pre">¯2+2*31</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>1</p></td>
<td class="text-align:left"><p>RNG1</p></td>
<td class="text-align:left"><p>Mersenne Twister</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">⍬</span></code>, an integer in the range 1 to <code class="docutils literal notranslate"><span class="pre">¯1+2*63</span></code>, or a 625-item integer vector</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>2</p></td>
<td class="text-align:left"><p>RNG2</p></td>
<td class="text-align:left"><p>Operating System random number generator</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">⍬</span></code></p></td>
</tr>
</tbody>
</table>
<p>By default, Dyalog uses the Mersenne Twister (algorithm 1).</p>
<p>For the sake of curiosity, let us see how one would implement <em>roll</em> using the algorithm 0:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="bp">∇</span><span class="w"> </span><span class="nv">z</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">Roll</span><span class="w"> </span><span class="nv">n</span><span class="w"></span>
<span class="w">    </span><span class="nv">seed</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="p">(</span><span class="m">¯1</span><span class="o">+</span><span class="m">2</span><span class="o">*</span><span class="m">31</span><span class="p">)</span><span class="o">|</span><span class="nv">seed</span><span class="o">×</span><span class="m">7</span><span class="o">*</span><span class="m">5</span><span class="w"></span>
<span class="w">    </span><span class="nv">z</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nf">⎕IO</span><span class="o">+⌊</span><span class="nv">n</span><span class="o">×</span><span class="nv">seed</span><span class="o">÷</span><span class="m">2</span><span class="o">*</span><span class="m">31</span><span class="w"></span>
<span class="bp">∇</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>The first instruction prepares the seed used for the next number.
<em>Residue</em> is used to ensure that the result will always be smaller than <code class="docutils literal notranslate"><span class="pre">¯1+2*31</span></code>.
Consequently, <code class="docutils literal notranslate"><span class="pre">⎕RL÷2*31</span></code> always returns a value in the range 0-1.
Multiplied by the argument, it produces a result strictly smaller than <code class="docutils literal notranslate"><span class="pre">n</span></code>, and by adding <code class="docutils literal notranslate"><span class="pre">⎕IO</span></code> we get the desired result.</p>
<p>You can compare this implementation of <code class="docutils literal notranslate"><span class="pre">Roll</span></code> to the primitive function <em>roll</em> if we set the seed and the algorithm to the correct values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">seed</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">73</span><span class="w"></span>
<span class="nv">Roll</span><span class="na">¨</span><span class="w"> </span><span class="m">3</span><span class="o">⍴</span><span class="m">10</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 7 2
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕RL</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">73</span><span class="w"> </span><span class="m">0</span><span class="w"></span>
<span class="o">?</span><span class="m">3</span><span class="o">⍴</span><span class="m">10</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 7 2
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">seed</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">341854744
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊃</span><span class="nf">⎕RL</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">341854744
</span></div></div>
</div>
</div>
</div>
</div>
<div class="section" id="some-more-maths">
<span id="mathematical-functions-some-more-maths"></span><h2><span class="section-number">13.4. </span>Some More Maths<a class="headerlink" href="#some-more-maths" title="Permalink to this headline">#</a></h2>
<div class="section" id="logarithms">
<span id="mathematical-functions-logarithms"></span><h3><span class="section-number">13.4.1. </span>Logarithms<a class="headerlink" href="#logarithms" title="Permalink to this headline">#</a></h3>
<p>The base <code class="docutils literal notranslate"><span class="pre">b</span></code> logarithm of a number <code class="docutils literal notranslate"><span class="pre">n</span></code> is calculated with the function <em>logarithm</em> <code class="docutils literal notranslate"><span class="pre">⍟</span></code> that is typed with <kbd>APL</kbd>+<kbd>Shift</kbd>+<kbd>8</kbd>.</p>
<p>The value <code class="docutils literal notranslate"><span class="pre">l</span> <span class="pre">←</span> <span class="pre">b⍟n</span></code> is such that <code class="docutils literal notranslate"><span class="pre">b*l</span></code> gives back the original number <code class="docutils literal notranslate"><span class="pre">n</span></code>.
Here are some examples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">10</span><span class="o">⍟</span><span class="m">1000</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3
</span></div></div>
</div>
<p>The logarithm of 1000 in base 10 is 3 because 10 to the 3rd power gives 1000:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">10</span><span class="o">*</span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1000
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span><span class="o">⍟</span><span class="m">81</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4
</span></div></div>
</div>
<p>The base-3 logarithm of 81 is 4 because 3 to the power of 4 gives 81:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span><span class="o">*</span><span class="m">4</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">81
</span></div></div>
</div>
<p>The monadic form of the function <em>logarithm</em> gives the <em>natural logarithm</em> (or <em>napierian logarithm</em>) of a number:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍟</span><span class="m">10</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2.30259
</span></div></div>
</div>
<p>The base of the natural logarithm is also the base of the monadic function <em>power</em>, so we can easily compute it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">*</span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2.71828
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍟*</span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>The monadic usage of the function <em>logarithm</em> is the same as using <code class="docutils literal notranslate"><span class="pre">*1</span></code> as the left argument:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍟</span><span class="m">10</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2.30259
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">*</span><span class="m">1</span><span class="p">)</span><span class="o">⍟</span><span class="m">10</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2.30259
</span></div></div>
</div>
<p>This is similar to how the monadic function <em>reciprocal</em> <code class="docutils literal notranslate"><span class="pre">÷n</span></code> is equivalent to the dyadic usage <code class="docutils literal notranslate"><span class="pre">1÷n</span></code> or the monadic function <em>negate</em> <code class="docutils literal notranslate"><span class="pre">-n</span></code> is equivalent to the dyadic usage <code class="docutils literal notranslate"><span class="pre">0-n</span></code>.</p>
<p>The relationship between the natural and the base <code class="docutils literal notranslate"><span class="pre">b</span></code> logarithms of a number is described the formulas below.
Given:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">←</span> <span class="pre">⍟a</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">l</span> <span class="pre">←</span> <span class="pre">b⍟a</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">e</span> <span class="pre">←</span> <span class="pre">*1</span></code>, the base of the natural logarithm</p></li>
</ul>
<p>Then, we have:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">≡</span> <span class="pre">l×⍟b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">l</span> <span class="pre">≡</span> <span class="pre">n×b⍟e</span></code></p></li>
</ul>
</div>
<div class="section" id="factorial-binomial">
<span id="mathematical-functions-factorial-binomial"></span><h3><span class="section-number">13.4.2. </span>Factorial &amp; Binomial<a class="headerlink" href="#factorial-binomial" title="Permalink to this headline">#</a></h3>
<p>The product of the first <code class="docutils literal notranslate"><span class="pre">n</span></code> positive integers, or the <em>factorial</em> of <code class="docutils literal notranslate"><span class="pre">n</span></code>, is written as <span class="math notranslate nohighlight">\(n!\)</span> in traditional mathematics.
APL uses the same symbol for the function, but in APL a monadic function is always placed to the left of its argument.
So, factorial looks like <code class="docutils literal notranslate"><span class="pre">!n</span></code> in APL.</p>
<p>As in mathematics, <code class="docutils literal notranslate"><span class="pre">!0</span></code> is equal to 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">7</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 1 2 6 24 120 720 5040
</span></div></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">n</span></code> is a decimal number, <code class="docutils literal notranslate"><span class="pre">!n</span></code> gives the <em>gamma</em> function of <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">+</span> <span class="pre">1</span></code>.
This is explained in <a class="reference internal" href="#mathematical-functions-gamma-and-beta-functions"><span class="std std-numref">Section 13.7.2</span></a>.</p>
<p>The monadic function <em>factorial</em> <code class="docutils literal notranslate"><span class="pre">!n</span></code> represents the number of possibilities when sorting <code class="docutils literal notranslate"><span class="pre">n</span></code> objects.
But if one picks only <code class="docutils literal notranslate"><span class="pre">p</span></code> objects among <code class="docutils literal notranslate"><span class="pre">n</span></code> objects, the number of possible <em>combinations</em> is given by <code class="docutils literal notranslate"><span class="pre">(!n)÷(!p)×!n-p</span></code>.
This can be obtained directly using the dyadic function <em>binomial</em> <code class="docutils literal notranslate"><span class="pre">p!n</span></code>.</p>
<p>For example, how many different hands can you be dealt if you are dealt 7 cards out of a 52 card deck?
That’s</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">7</span><span class="o">!</span><span class="m">52</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">133784560
</span></div></div>
</div>
<p>That is a surprisingly big number!
Over 130 million different hands.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">p</span></code> is greater than <code class="docutils literal notranslate"><span class="pre">n</span></code>, then <code class="docutils literal notranslate"><span class="pre">p!n</span></code> gives the result 0.
In hindsight, this makes a lot of sense: if you have 10 items, in how many combinations can you make with 15 of those items?
Obviously, zero!
You do not even have enough items to consider doing those combinations.</p>
<p>The formula <code class="docutils literal notranslate"><span class="pre">(0,⍳n)!n</span></code> gives the coefficients of <span class="math notranslate nohighlight">\((x + 1)^n\)</span>, which is the reason why the dyadic usage of <code class="docutils literal notranslate"><span class="pre">!</span></code> is called <em>binomial</em>.
One can obtain a set of coefficients with the following expression:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">x</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">⍳</span><span class="m">5</span><span class="w"></span>
<span class="o">⍉</span><span class="p">(</span><span class="m">0</span><span class="o">,</span><span class="nv">x</span><span class="p">)</span><span class="na">∘.</span><span class="o">!</span><span class="nv">x</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 1  0  0 0 0
1 2  1  0 0 0
1 3  3  1 0 0
1 4  6  4 1 0
1 5 10 10 5 1
</span></div></div>
</div>
<p>The matrix above shows, for example, that <span class="math notranslate nohighlight">\((x + 1)^3 = 1x^3 + 3x^2 + 3x + 1\)</span>.
The coefficients <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">3</span> <span class="pre">3</span> <span class="pre">1</span></code> were taken from the third row of the matrix.</p>
</div>
<div class="section" id="trigonometry">
<span id="mathematical-functions-trigonometry"></span><h3><span class="section-number">13.4.3. </span>Trigonometry<a class="headerlink" href="#trigonometry" title="Permalink to this headline">#</a></h3>
<p>(Mathematical-Functions-Multiples-of-π)=</p>
<div class="section" id="multiples-of">
<h4><span class="section-number">13.4.3.1. </span>Multiples of π<a class="headerlink" href="#multiples-of" title="Permalink to this headline">#</a></h4>
<p>The mathematical constant pi (or π) is very useful in many mathematical and technical calculations.
It can be obtained via the primitive function <em>circle</em> (the symbol <code class="docutils literal notranslate"><span class="pre">○</span></code>, typed with <kbd>APL</kbd>+<kbd>o</kbd>), which gives multiples of pi.
Do not confuse the function circle <code class="docutils literal notranslate"><span class="pre">o</span></code> with the jot <code class="docutils literal notranslate"><span class="pre">∘</span></code> used for the <em>outer product</em> or the operators <em>beside</em> and <em>bind</em>.</p>
<p><span class="math notranslate nohighlight">\(\pi \times n\)</span> can be obtained with <code class="docutils literal notranslate"><span class="pre">○n</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">○</span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0.5</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3.14159 6.28319 1.5708
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">○</span><span class="w"> </span><span class="o">÷</span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1.0472
</span></div></div>
</div>
<p>This last expression gives <span class="math notranslate nohighlight">\(\frac\pi3\)</span>.
However, be careful!
The symbol <code class="docutils literal notranslate"><span class="pre">○</span></code>, by itself, does not represent the value π that we divided by 3 with <code class="docutils literal notranslate"><span class="pre">○÷3</span></code>.
<code class="docutils literal notranslate"><span class="pre">÷3</span></code> computed the reciprocal of 3 and then the monadic function <em>pi times</em> got applied to that.</p>
</div>
<div class="section" id="circular-and-hyperbolic-trigonometry">
<span id="mathematical-functions-circular-and-hyperbolic-trigonometry"></span><h4><span class="section-number">13.4.3.2. </span>Circular and Hyperbolic Trigonometry<a class="headerlink" href="#circular-and-hyperbolic-trigonometry" title="Permalink to this headline">#</a></h4>
<p>Using the dyadic form of the glyph <em>circle</em>, one can obtain all the possible direct and inverse functions of circular and hyperbolic trigonometry.</p>
<p>the trigonometric function is designated by the left argument to <code class="docutils literal notranslate"><span class="pre">○</span></code> according to the table below.
You can see that the positive left arguments refer to direct trigonometric functions, while negative arguments refer to their inverse functions.
Values from 1 to 3 calculate circular functions and values from 5 to 7 calculate hyperbolic functions.</p>
<div class="section" id="direct-trigonometric-functions">
<span id="mathematical-functions-direct-trigonometric-functions"></span><h5><span class="section-number">13.4.3.2.1. </span>Direct Trigonometric Functions<a class="headerlink" href="#direct-trigonometric-functions" title="Permalink to this headline">#</a></h5>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p><code class="docutils literal notranslate"><span class="pre">f</span></code></p></th>
<th class="text-align:left head"><p><code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">○</span> <span class="pre">x</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\sqrt{1 - x^2}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\sin{x}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\cos{x}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">3</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\tan{x}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">4</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\sqrt{1 + x^2}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\text{sinh }x\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">6</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\text{cosh }x\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">7</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\text{tanh }x\)</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="inverse-trigonometric-functions">
<span id="mathematical-functions-inverse-trigonometric-functions"></span><h4><span class="section-number">13.4.3.3. </span>Inverse Trigonometric Functions<a class="headerlink" href="#inverse-trigonometric-functions" title="Permalink to this headline">#</a></h4>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p><code class="docutils literal notranslate"><span class="pre">f</span></code></p></th>
<th class="text-align:left head"><p><code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">○</span> <span class="pre">x</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">¯1</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\arcsin{x}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">¯2</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\arccos{x}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">¯3</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\arctan{x}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">¯4</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\sqrt{-1 + x^2}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">¯5</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\text{argsinh }x\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">¯6</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\text{argcosh }x\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">¯7</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\text{argtanh }x\)</span></p></td>
</tr>
</tbody>
</table>
<p>For example:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">2○x</span></code> means <span class="math notranslate nohighlight">\(\cos x\)</span>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">5○x</span></code> means <span class="math notranslate nohighlight">\(\text{sinh }x\)</span>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">¯2○x</span></code> means <span class="math notranslate nohighlight">\(\arccos x\)</span>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0○val</span></code> calculates <span class="math notranslate nohighlight">\(|\cos x|\)</span> if <span class="math notranslate nohighlight">\(val = \sin x\)</span>, or <span class="math notranslate nohighlight">\(|\sin x|\)</span> if <span class="math notranslate nohighlight">\(val = \cos x\)</span>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">4○val</span></code> calculates <span class="math notranslate nohighlight">\(|\text{cosh }x|\)</span> if <span class="math notranslate nohighlight">\(val = \text{sinh }x\)</span>; and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">¯4○val</span></code> calculates <span class="math notranslate nohighlight">\(|\text{sinh }x|\)</span> if <span class="math notranslate nohighlight">\(val = \text{cosh }x\)</span>.</p></li>
</ul>
<p>For direct circular trigonometry (<code class="docutils literal notranslate"><span class="pre">f∊1</span> <span class="pre">2</span> <span class="pre">3</span></code>) the value of <code class="docutils literal notranslate"><span class="pre">x</span></code> must be in radians.
For inverse circular trigonometry (<code class="docutils literal notranslate"><span class="pre">f∊-1</span> <span class="pre">2</span> <span class="pre">3</span></code>) the returned result is in radians.</p>
</div>
<div class="section" id="concrete-trigonometry-examples">
<span id="mathematical-functions-concrete-trigonometry-examples"></span><h4><span class="section-number">13.4.3.4. </span>Concrete Trigonometry Examples<a class="headerlink" href="#concrete-trigonometry-examples" title="Permalink to this headline">#</a></h4>
<p>Let us compute the cosine of <span class="math notranslate nohighlight">\(0\)</span>, <span class="math notranslate nohighlight">\(\pi/6\)</span>, and <span class="math notranslate nohighlight">\(\pi/3\)</span>, respectively:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span><span class="o">○</span><span class="w"> </span><span class="m">0</span><span class="o">,○÷</span><span class="m">6</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 0.866025 0.5
</span></div></div>
</div>
<p>Next, we calculate three different functions for <span class="math notranslate nohighlight">\(\pi/3\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">○</span><span class="w"> </span><span class="o">○÷</span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.866025 0.5 1.73205
</span></div></div>
</div>
<p>These three functions were, respectively, the sine, the cosine, and the tangent.</p>
<p>Now, we confirm that <span class="math notranslate nohighlight">\(\arctan 1 = \pi/4\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">¯3</span><span class="o">○</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">○÷</span><span class="m">4</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>We can also calculate the sine and cosine of <span class="math notranslate nohighlight">\(\pi/2\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">○</span><span class="w"> </span><span class="o">○÷</span><span class="m">2</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 6.12323E¯17
</span></div></div>
</div>
<p>The very last result shows that the algorithms used to calculate the circular or hyperbolic values sometimes lead to very minor rounding approximation errors.
The second value is very close to zero, but it should be zero.</p>
</div>
<div class="section" id="manipulating-complex-numbers">
<span id="mathematical-functions-manipulating-complex-numbers"></span><h4><span class="section-number">13.4.3.5. </span>Manipulating Complex Numbers<a class="headerlink" href="#manipulating-complex-numbers" title="Permalink to this headline">#</a></h4>
<p>Since the support for complex numbers was added to Dyalog APL, the function <em>circle</em> was extended to provide some useful functions to manipulate complex numbers.
We list them in the table below, where <code class="docutils literal notranslate"><span class="pre">x</span></code> represents an arbitrary number.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p><code class="docutils literal notranslate"><span class="pre">f</span></code></p></th>
<th class="text-align:left head"><p><code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">○</span> <span class="pre">x</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">8</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">(-1+x*2)*0.5</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">9</span></code></p></td>
<td class="text-align:left"><p>real part of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">10</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">|x</span></code>, the magnitude of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">11</span></code></p></td>
<td class="text-align:left"><p>imaginary part of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">12</span></code></p></td>
<td class="text-align:left"><p>phase of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">¯8</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">-8○x</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">¯9</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">¯10</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">+x</span></code>, the complex conjugate of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">¯11</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">x×0J1</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">¯12</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">*x×0J1</span></code></p></td>
</tr>
</tbody>
</table>
<p>To exemplify the usage of some of these left arguments, we will verify some simple identities.</p>
<p>For example, we can split a complex number up and put it back together:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">c</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">3J4</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">re</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">9</span><span class="o">○</span><span class="nv">c</span><span class="w"></span>
<span class="nv">im</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">11</span><span class="o">○</span><span class="nv">c</span><span class="w"></span>
<span class="nv">c</span><span class="w"> </span><span class="o">≡</span><span class="w"> </span><span class="nv">re</span><span class="o">+</span><span class="m">¯11</span><span class="o">○</span><span class="nv">im</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>Using the function <em>magnitude</em> directly should be the same as using <code class="docutils literal notranslate"><span class="pre">10○</span></code>, which should be the same as computing the magnitude of a complex number by hand:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">mag</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">|</span><span class="nv">c</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">mag</span><span class="o">≡</span><span class="m">10</span><span class="o">○</span><span class="nv">c</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">mag</span><span class="o">≡</span><span class="m">0.5</span><span class="o">*</span><span class="na">⍨</span><span class="o">+</span><span class="na">/</span><span class="nv">re</span><span class="w"> </span><span class="nv">im</span><span class="o">*</span><span class="m">2</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>The phase of a complex number is given by the arctangent of the ratio of its imaginary and real parts:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">phase</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">12</span><span class="o">○</span><span class="nv">c</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.927295
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">phase</span><span class="o">≡</span><span class="m">¯3</span><span class="o">○</span><span class="nv">im</span><span class="o">÷</span><span class="nv">re</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>Finally, we can reconstruct a complex number from its phase and magnitude (which are used when representing complex numbers in polar form):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">c</span><span class="w"> </span><span class="o">≡</span><span class="w"> </span><span class="nv">mag</span><span class="o">×</span><span class="m">¯12</span><span class="o">○</span><span class="nv">phase</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
</div>
</div>
<div class="section" id="gcd-and-lcm">
<span id="mathematical-functions-gcd-and-lcm"></span><h3><span class="section-number">13.4.4. </span>GCD and LCM<a class="headerlink" href="#gcd-and-lcm" title="Permalink to this headline">#</a></h3>
<div class="section" id="greatest-common-divisor-gcd">
<span id="mathematical-functions-greatest-common-divisor-gcd"></span><h4><span class="section-number">13.4.4.1. </span>Greatest Common Divisor (GCD)<a class="headerlink" href="#greatest-common-divisor-gcd" title="Permalink to this headline">#</a></h4>
<p>When applied to binary values, the symbol <code class="docutils literal notranslate"><span class="pre">∨</span></code> represents the Boolean function <em>or</em>.
The same symbol can be applied to numbers other than 0 and 1.
Then, it calculates their <em>greatest common divisor</em>, or GCD.
<code class="docutils literal notranslate"><span class="pre">∨</span></code> is always a dyadic scalar function: applied to arrays of the same shape, it gives a result of the same shape; applied between a scalar and any array, it gives a result of the same shape as the array, and the scalar value is reused as needed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">15180</span><span class="w"> </span><span class="o">∨</span><span class="w"> </span><span class="m">285285</span><span class="w"> </span><span class="m">¯285285</span><span class="w"> </span><span class="m">47</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">165 165 1
</span></div></div>
</div>
<p>The result of GCD is always positive.
Two integers always have, at least, the number 1 as a common divisor.
When the result of GCD between two integers is 1, that means there was no other divisor in common between the two integers and we say that those two integers are <em>coprime</em>.
For example, 15180 and 47 are coprime.</p>
<p>As always, if one of the items of the argument to <code class="docutils literal notranslate"><span class="pre">∨</span></code> is 0, the corresponding item from the other argument is returned (41, in the case below):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">5180</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="o">∨</span><span class="w"> </span><span class="m">6142</span><span class="w"> </span><span class="m">41</span><span class="w"> </span><span class="m">19</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">74 41 1
</span></div></div>
</div>
<p>The function <em>gcd</em> also works with non-integer arguments:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">5178</span><span class="w"> </span><span class="m">417</span><span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="o">∨</span><span class="w"> </span><span class="m">7.4</span><span class="w"> </span><span class="m">0.9</span><span class="w"> </span><span class="m">1.4</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.2 0.3 1.4
</span></div></div>
</div>
</div>
<div class="section" id="lowest-common-multiple-lcm">
<span id="mathematical-functions-lowest-common-multiple-lcm"></span><h4><span class="section-number">13.4.4.2. </span>Lowest Common Multiple (LCM)<a class="headerlink" href="#lowest-common-multiple-lcm" title="Permalink to this headline">#</a></h4>
<p>When applied to binary values, the symbol <code class="docutils literal notranslate"><span class="pre">∧</span></code> represents the Boolean function <em>and</em>.
The same symbol can be applied to numbers other than 0 and 1.
Then, it calculates their lowest common multiple, or LCM.
<code class="docutils literal notranslate"><span class="pre">∧</span></code> is also a dyadic scalar function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">152</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">6183</span><span class="w"> </span><span class="m">¯519</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">∧</span><span class="w"> </span><span class="m">316</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">411</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">16</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12008 8 847071 ¯4152 0
</span></div></div>
</div>
<p>The GCD and the LCM satisfy a relationship: if <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are two numbers, then we have that <code class="docutils literal notranslate"><span class="pre">(a×b)</span> <span class="pre">≡</span> <span class="pre">(a∨b)×(a∧b)</span></code>.
This relationship can be rewritten as the elegant train <code class="docutils literal notranslate"><span class="pre">(×≡∨×∧)</span></code>, which always returns 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">428</span><span class="w"> </span><span class="p">(</span><span class="o">×≡∨×∧</span><span class="p">)</span><span class="w"> </span><span class="m">561</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">¯28</span><span class="w"> </span><span class="p">(</span><span class="o">×≡∨×∧</span><span class="p">)</span><span class="w"> </span><span class="m">561</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">428</span><span class="w"> </span><span class="p">(</span><span class="o">×≡∨×∧</span><span class="p">)</span><span class="w"> </span><span class="m">¯51</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">¯42</span><span class="w"> </span><span class="p">(</span><span class="o">×≡∨×∧</span><span class="p">)</span><span class="w"> </span><span class="m">¯61</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
</div>
</div>
<div class="section" id="set-union-and-intersection">
<span id="mathematical-functions-set-union-and-intersection"></span><h3><span class="section-number">13.4.5. </span>Set Union and Intersection<a class="headerlink" href="#set-union-and-intersection" title="Permalink to this headline">#</a></h3>
<p>Mathematical set theory describes the following two functions between two sets <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>:</p>
<ul class="simple">
<li><p><em>intersection</em> <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">∩</span> <span class="pre">b</span></code>, gives the items in both sets; and</p></li>
<li><p><em>union</em> <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">∪</span> <span class="pre">b</span></code>, gives the items that are in either set.</p></li>
</ul>
<p>The same functions are found in Dyalog, using the same symbols.
To type the symbol for set intersection <code class="docutils literal notranslate"><span class="pre">∩</span></code>, use <kbd>APL</kbd>+<kbd>c</kbd>.
To type the symbol for set union, use <kbd>APL</kbd>+<kbd>v</kbd>.
They work on scalar and vector arguments:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;Hey&#39;</span><span class="w"> </span><span class="s1">&#39;give&#39;</span><span class="w"> </span><span class="s1">&#39;me&#39;</span><span class="w"> </span><span class="m">53</span><span class="w"> </span><span class="s1">&#39;dollars&#39;</span><span class="w"> </span><span class="o">∩</span><span class="w"> </span><span class="m">53</span><span class="w"> </span><span class="s1">&#39;euros&#39;</span><span class="w"> </span><span class="s1">&#39;not&#39;</span><span class="w"> </span><span class="s1">&#39;dollars&#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌──┬───────┐
│53│dollars│
└──┴───────┘
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;Hey&#39;</span><span class="w"> </span><span class="s1">&#39;give&#39;</span><span class="w"> </span><span class="s1">&#39;me&#39;</span><span class="w"> </span><span class="m">53</span><span class="w"> </span><span class="s1">&#39;dollars&#39;</span><span class="w"> </span><span class="o">∪</span><span class="w"> </span><span class="m">53</span><span class="w"> </span><span class="s1">&#39;euros&#39;</span><span class="w"> </span><span class="s1">&#39;not&#39;</span><span class="w"> </span><span class="s1">&#39;dollars&#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───┬────┬──┬──┬───────┬─────┬───┐
│Hey│give│me│53│dollars│euros│not│
└───┴────┴──┴──┴───────┴─────┴───┘
</span></div></div>
</div>
<p>In mathematics, we use these two functions with <em>sets</em>, which are not the same thing as APL vectors.
APL vectors are ordered and may contain duplicates, which makes a couple of conventions necessary.</p>
<div class="section" id="intersection">
<span id="mathematical-functions-intersection"></span><h4><span class="section-number">13.4.5.1. </span>Intersection<a class="headerlink" href="#intersection" title="Permalink to this headline">#</a></h4>
<p>The result of the function <em>intersection</em> is in the order that the items appear in the left argument, including duplicates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">∩</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 3 2 3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">text</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="s1">&#39;The quick brown fox jumps over the lazy dog&#39;</span><span class="w"></span>
<span class="nv">vowels</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="s1">&#39;aeiouy&#39;</span><span class="w"></span>
<span class="nv">text</span><span class="w"> </span><span class="o">∩</span><span class="w"> </span><span class="nv">vowels</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">euioouoeeayo
</span></div></div>
</div>
<p>In fact, the result of the <em>intersection</em> is equal to the left argument, but with all items that are not found in the right argument removed.
aWe can check this by using the function <em>without</em> twice:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">text</span><span class="o">∩</span><span class="nv">vowels</span><span class="p">)</span><span class="w"> </span><span class="o">≡</span><span class="w"> </span><span class="nv">text</span><span class="o">~</span><span class="nv">text</span><span class="o">~</span><span class="nv">vowels</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
</div>
<div class="section" id="union">
<span id="mathematical-functions-union"></span><h4><span class="section-number">13.4.5.2. </span>Union<a class="headerlink" href="#union" title="Permalink to this headline">#</a></h4>
<p>The result of the function <em>union</em> is always the left argument, followed by all items of the right argument that are not already found in the left argument – including duplicates:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">∪</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 1 2 3 2 3 4 4 4 6 6 6
</span></div></div>
</div>
<p>Again, we can verify this property by making use of the function <em>without</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">left</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
<span class="nv">right</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"></span>
<span class="p">(</span><span class="nv">left</span><span class="o">∪</span><span class="nv">right</span><span class="p">)</span><span class="w"> </span><span class="o">≡</span><span class="w"> </span><span class="nv">left</span><span class="o">,</span><span class="nv">right</span><span class="o">~</span><span class="nv">left</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
</div>
<div class="section" id="unique">
<span id="mathematical-functions-unique"></span><h4><span class="section-number">13.4.5.3. </span>Unique<a class="headerlink" href="#unique" title="Permalink to this headline">#</a></h4>
<p>The function <em>union</em> can also be used monadically, in which case it is the function <em>unique</em>.
The function <em>unique</em> works on arrays of arbitrary dimension and returns an array of the same rank, with all the unique major cells of the initial argument, in order of appearance:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">∪</span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">months</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">↑</span><span class="s1">&#39;Jan&#39;</span><span class="w"> </span><span class="s1">&#39;Feb&#39;</span><span class="w"> </span><span class="s1">&#39;Jan&#39;</span><span class="w"> </span><span class="s1">&#39;Apr&#39;</span><span class="w"> </span><span class="s1">&#39;Dec&#39;</span><span class="w"> </span><span class="s1">&#39;Apr&#39;</span><span class="w"> </span><span class="s1">&#39;Mar&#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">Jan
Feb
Jan
Apr
Dec
Apr
Mar
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">∪</span><span class="nv">months</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">Jan
Feb
Apr
Dec
Mar
</span></div></div>
</div>
</div>
</div>
</div>
<div class="section" id="domino">
<span id="mathematical-functions-domino"></span><h2><span class="section-number">13.5. </span>Domino<a class="headerlink" href="#domino" title="Permalink to this headline">#</a></h2>
<div class="section" id="some-definitions">
<span id="mathematical-functions-some-definitions"></span><h3><span class="section-number">13.5.1. </span>Some Definitions<a class="headerlink" href="#some-definitions" title="Permalink to this headline">#</a></h3>
<div class="section" id="mathematical-functions-identity-matrix">
<span id="identity-matrix"></span><h4><span class="section-number">13.5.1.1. </span>Identity Matrix<a class="headerlink" href="#mathematical-functions-identity-matrix" title="Permalink to this headline">#</a></h4>
<p>Any number multiplied by 1 stays unchanged.
Similarly, a matrix multiplied by a special square Boolean matrix remains unchanged.
We call <em>identity matrix</em> to that special matrix.</p>
<p>The <em>identity matrix</em> is a square matrix that is all zeroes except in the main diagonal, where it has ones.</p>
<p>For example, if we have a 3 by 3 matrix</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">m</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="o">⍴</span><span class="m">12</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">44</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">71</span><span class="w"> </span><span class="m">80</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12 50  7
44  3 25
30 71 80
</span></div></div>
</div>
<p>Then, the identity matrix for <code class="docutils literal notranslate"><span class="pre">m</span></code> must be a 3 by 3 matrix of zeroes with ones in the main diagonal.
A simple way of creating the identity matrix of size <code class="docutils literal notranslate"><span class="pre">n</span></code> is by using the expression <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">n⍴n+1↑1</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="o">⍴</span><span class="m">4</span><span class="o">↑</span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 0 0
0 1 0
0 0 1
</span></div></div>
</div>
<p>Now, if we multiply <code class="docutils literal notranslate"><span class="pre">m</span></code> and <code class="docutils literal notranslate"><span class="pre">i</span></code> together, we get <code class="docutils literal notranslate"><span class="pre">m</span></code> back:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">m</span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="nv">i</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12 50  7
44  3 25
30 71 80
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">i</span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="nv">m</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12 50  7
44  3 25
30 71 80
</span></div></div>
</div>
</div>
<div class="section" id="inverse-matrices">
<span id="mathematical-functions-inverse-matrices"></span><h4><span class="section-number">13.5.1.2. </span>Inverse Matrices<a class="headerlink" href="#inverse-matrices" title="Permalink to this headline">#</a></h4>
<p>If we multiply 4 by 0.25, or 0.25 by 4, we obtain 1, which is the identity item for multiplication.
Alternatively, we can say that 0.25 is the reciprocal, or inverse, of 4, and vice-versa.</p>
<p>Given that <code class="docutils literal notranslate"><span class="pre">i</span></code> is the identity item for matrix multiplication, if we can find two matrices <code class="docutils literal notranslate"><span class="pre">m</span></code> and <code class="docutils literal notranslate"><span class="pre">m_</span></code> whose product is <code class="docutils literal notranslate"><span class="pre">i</span></code>, we can say that those two matrices are the inverse of each other.</p>
<p>For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">m</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="o">⍴</span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">.5</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">1.5</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1   0 2
0   2 1
0.5 3 1.5
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">m_</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="o">⍴</span><span class="m">0</span><span class="w"> </span><span class="m">¯3</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">¯.25</span><span class="w"> </span><span class="m">¯.25</span><span class="w"> </span><span class="m">.5</span><span class="w"> </span><span class="m">.5</span><span class="w"> </span><span class="m">1.5</span><span class="w"> </span><span class="m">¯1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 0    ¯3     2
¯0.25 ¯0.25  0.5
 0.5   1.5  ¯1
</span></div></div>
</div>
<p>If we multiply these two matrices together, in either order, we get the identity matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">m</span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="nv">m_</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 0 0
0 1 0
0 0 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">m_</span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="nv">m</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 0 0
0 1 0
0 0 1
</span></div></div>
</div>
<p>Note that, in general, <code class="docutils literal notranslate"><span class="pre">a+.×b</span></code> and <code class="docutils literal notranslate"><span class="pre">b+.×a</span></code> give different results!</p>
<p>Here is a second example with 2 by 2 matrices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">m</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="o">⍴</span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 1
4 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">m_</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="o">⍴</span><span class="m">¯.5</span><span class="w"> </span><span class="m">.5</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">¯1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯0.5  0.5
 2   ¯1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">m</span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="nv">m_</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 0
0 1
</span></div></div>
</div>
<p>Now, the result is the identity matrix of size 2, because the matrices <code class="docutils literal notranslate"><span class="pre">m</span></code> and <code class="docutils literal notranslate"><span class="pre">m_</span></code> are 2 by 2 (and not 3 by 3).</p>
<p>For the moment, we will only concern ourselves with inverses for square matrices.
We shall in <a class="reference internal" href="#mathematical-functions-domino-and-rectangular-matrices"><span class="std std-numref">Section 13.7.3</span></a> that it is also possible to define inverses for non-square matrices.</p>
</div>
</div>
<div class="section" id="matrix-inverse">
<span id="mathematical-functions-matrix-inverse"></span><h3><span class="section-number">13.5.2. </span>Matrix Inverse<a class="headerlink" href="#matrix-inverse" title="Permalink to this headline">#</a></h3>
<div class="section" id="monadic-domino">
<span id="mathematical-functions-monadic-domino"></span><h4><span class="section-number">13.5.2.1. </span>Monadic Domino<a class="headerlink" href="#monadic-domino" title="Permalink to this headline">#</a></h4>
<p>APL provides a <em>matrix inverse</em> primitive function, represented by the symbol <code class="docutils literal notranslate"><span class="pre">⌹</span></code> and typed with <kbd>APL</kbd>+<kbd>Shift</kbd>+<kbd>=</kbd>, which is the same key as <code class="docutils literal notranslate"><span class="pre">÷</span></code>.
Because of its appearance, this symbol is named <em>domino</em>.</p>
<p>The monadic usage of <em>domino</em> returns the inverse of a matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⌹</span><span class="nv">m</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯0.5  0.5
 2   ¯1
</span></div></div>
</div>
<p>Calculating the inverse of a matrix is a complex operation, and the result might be only an approximation.
For example, the inverse of the matrix <code class="docutils literal notranslate"><span class="pre">m</span></code> has the value <code class="docutils literal notranslate"><span class="pre">¯1</span></code> in the bottom right corner.
However, it would not be surprising if the function <em>matrix inverse</em> had returned this result, instead:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="o">⍴</span><span class="m">¯.5</span><span class="w"> </span><span class="m">.5</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">¯.999999</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯0.5  0.5
 2   ¯0.999999
</span></div></div>
</div>
</div>
<div class="section" id="singular-matrices">
<span id="mathematical-functions-singular-matrices"></span><h4><span class="section-number">13.5.2.2. </span>Singular Matrices<a class="headerlink" href="#singular-matrices" title="Permalink to this headline">#</a></h4>
<p>In normal arithmetic, zero has no inverse and <code class="docutils literal notranslate"><span class="pre">÷0</span></code> in APL causes a <code class="docutils literal notranslate"><span class="pre">DOMAIN</span> <span class="pre">ERROR</span></code>.</p>
<p>In the same way, some matrices cannot be inverted.
Those matrices are said to be <em>singular</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⌹</span><span class="w"> </span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="o">⍴</span><span class="m">1</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">10</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 3  5
3 4 15
2 7 10
DOMAIN ERROR
      ⌹⎕←3 3⍴1 3 5 3 4 15 2 7 10
      ∧
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="solving-a-set-of-linear-equations">
<span id="mathematical-functions-solving-a-set-of-linear-equations"></span><h4><span class="section-number">13.5.2.3. </span>Solving a Set of Linear Equations<a class="headerlink" href="#solving-a-set-of-linear-equations" title="Permalink to this headline">#</a></h4>
<p>Here is a set of three linear equations with three unknowns, written in traditional mathematical notation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat}{4}
-8 &amp;= 3&amp;&amp;x + 2&amp;&amp;y -\ &amp;&amp;z \\
19 &amp;= &amp;&amp;x -\ &amp;&amp;y + 3&amp;&amp;z \\
0 &amp;= 5&amp;&amp;x + 2&amp;&amp;y
\end{alignat}
\end{split}\]</div>
<p>This set of equations can be represented using a vector for the constants and a matrix for the coefficients of the three unknowns, as shown below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">cons</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">¯8</span><span class="w"> </span><span class="m">19</span><span class="w"> </span><span class="m">0</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">coefs</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="o">⍴</span><span class="m">3</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">¯1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">¯1</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3  2 ¯1
1 ¯1  3
5  2  0
</span></div></div>
</div>
<p>To solve the set of equations above, we must find a 3-element vector <code class="docutils literal notranslate"><span class="pre">xyz</span></code> such that <code class="docutils literal notranslate"><span class="pre">cons</span> <span class="pre">≡ coefs</span> <span class="pre">+.×</span> <span class="pre">xyz</span></code>.</p>
<p>We can find such a vector provided that the matrix <code class="docutils literal notranslate"><span class="pre">coefs</span></code> has an inverse, i.e., that it is not singular.
Let us multiply both sides of the equality <code class="docutils literal notranslate"><span class="pre">cons</span> <span class="pre">≡ coefs</span> <span class="pre">+.×</span> <span class="pre">xyz</span></code> by the inverse of <code class="docutils literal notranslate"><span class="pre">coefs</span></code>:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="w">                </span><span class="nv">cons</span><span class="w"> </span><span class="o">≡</span><span class="w">              </span><span class="nv">coefs</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">xyz</span><span class="w"> </span><span class="kd">←→</span><span class="w"></span>
<span class="kd">←→</span><span class="w"> </span><span class="p">(</span><span class="o">⌹</span><span class="nv">coefs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">cons</span><span class="w"> </span><span class="o">≡</span><span class="w"> </span><span class="p">(</span><span class="o">⌹</span><span class="nv">coefs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">coefs</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">xyz</span><span class="w"></span>
</pre></div>
</div>
<p>Now, because we know that <code class="docutils literal notranslate"><span class="pre">id</span> <span class="pre">←</span> <span class="pre">(⌹coefs)</span> <span class="pre">+.×</span> <span class="pre">coefs</span></code> is the identity matrix, we can simplify the expression:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="w">   </span><span class="p">(</span><span class="o">⌹</span><span class="nv">coefs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">cons</span><span class="w"> </span><span class="o">≡</span><span class="w"> </span><span class="p">(</span><span class="o">⌹</span><span class="nv">coefs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">coefs</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">xyz</span><span class="w"> </span><span class="kd">←→</span><span class="w"></span>
<span class="kd">←→</span><span class="w"> </span><span class="p">(</span><span class="o">⌹</span><span class="nv">coefs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">cons</span><span class="w"> </span><span class="o">≡</span><span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">xyz</span><span class="w"> </span><span class="kd">←→</span><span class="w"></span>
<span class="kd">←→</span><span class="w"> </span><span class="p">(</span><span class="o">⌹</span><span class="nv">coefs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">cons</span><span class="w"> </span><span class="o">≡</span><span class="w"> </span><span class="nv">xyz</span><span class="w"></span>
</pre></div>
</div>
<p>Eureka!
We found a way of calculating the values that we had to find:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">xyz</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="p">(</span><span class="o">⌹</span><span class="nv">coefs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">cons</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 ¯5 4
</span></div></div>
</div>
<p>In general, the solution to a set of linear equations is given by <code class="docutils literal notranslate"><span class="pre">solution</span> <span class="pre">←</span> <span class="pre">(⌹coefficients)</span> <span class="pre">+.×</span> <span class="pre">constants</span></code>.</p>
<p>Note that, in the formula above, we multiply <code class="docutils literal notranslate"><span class="pre">constants</span></code> by the inverse (or reciprocal) of a matrix.
When dealing with numbers, multiplying by the reciprocal of a number is usually known as division, which motivates the name of the dyadic usage of the <em>domino</em> <code class="docutils literal notranslate"><span class="pre">⌹</span></code>.</p>
</div>
</div>
<div class="section" id="matrix-division">
<span id="mathematical-functions-matrix-division"></span><h3><span class="section-number">13.5.3. </span>Matrix Division<a class="headerlink" href="#matrix-division" title="Permalink to this headline">#</a></h3>
<p>The dyadic form of <em>domino</em> is called <em>matrix divide</em>, so it can do exactly what we have just done: it can easily sets of linear equations like the one shown above.
We solve that set of linear equations again, this time using <em>matrix divide</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">cons</span><span class="o">⌹</span><span class="nv">coefs</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 ¯5 4
</span></div></div>
</div>
<p>Naturally, this method works only if the coefficient matrix has an inverse.
In other words, the set of equations must have a single solution.
If three is no solution, a <code class="docutils literal notranslate"><span class="pre">DOMAIN</span> <span class="pre">ERROR</span></code> will be reported.</p>
<p>We can summarise this as follows: given a system of <code class="docutils literal notranslate"><span class="pre">n</span></code> linear equations with <code class="docutils literal notranslate"><span class="pre">n</span></code> unknowns, where the matrix of coefficients is called <code class="docutils literal notranslate"><span class="pre">coefs</span></code> and the vector of constants is called <code class="docutils literal notranslate"><span class="pre">cons</span></code>, the solution <code class="docutils literal notranslate"><span class="pre">sol</span></code> of the system is given by <code class="docutils literal notranslate"><span class="pre">sol</span> <span class="pre">←</span> <span class="pre">cons⌹coefs</span></code>.</p>
</div>
<div class="section" id="two-or-three-steps-in-geometry">
<span id="mathematical-functions-two-or-three-steps-in-geometry"></span><h3><span class="section-number">13.5.4. </span>Two or Three Steps in Geometry<a class="headerlink" href="#two-or-three-steps-in-geometry" title="Permalink to this headline">#</a></h3>
<div class="section" id="a-complex-solution-to-a-simple-problem">
<span id="mathematical-functions-a-complex-solution-to-a-simple-problem"></span><h4><span class="section-number">13.5.4.1. </span>A Complex Solution to a Simple Problem<a class="headerlink" href="#a-complex-solution-to-a-simple-problem" title="Permalink to this headline">#</a></h4>
<p>To begin with, we invite you to study a complicated method to solve a simple problem.
Our intention is then to generalise this method to develop a solution for an everyday problem in statistical studies.</p>
<p>The goal is to find the coefficients of a straight line passing through two points <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">Q</span></code>, of which the coordinates are given below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">xs</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">4</span><span class="w">  </span><span class="c1">⍝ x coordinates of P and Q</span><span class="w"></span>
<span class="nv">ys</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w">  </span><span class="c1">⍝ y coordinates of P and Q</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>The points <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">Q</span></code> are shown in <a class="reference internal" href="#fig-graph-p-q"><span class="std std-numref">Fig. 13.1</span></a>.</p>
<div class="figure align-default" id="graph-p-q">
<span id="fig-graph-p-q"></span><img alt="_images/Graph_P_Q.png" src="_images/Graph_P_Q.png" />
<p class="caption"><span class="caption-number">Fig. 13.1 </span><span class="caption-text">A graph with the points <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">Q</span></code>.</span><a class="headerlink" href="#graph-p-q" title="Permalink to this image">#</a></p>
</div>
<p>The general equation describing a straight line is <span class="math notranslate nohighlight">\(y = mx + b\)</span>.
With our two points given, the following is obtained:</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
2 &amp;= 2m + b
3 &amp;= 4m + b
\end{align}
\]</div>
<p>This is a set of two linear equations in which the unknowns are <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(b\)</span>.
Let us solve this set of equations by the method demonstrated in the previous section:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">cons</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">ys</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">coefs</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">xs</span><span class="o">,</span><span class="sr">[</span><span class="m">1.5</span><span class="sr">]</span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 1
4 1
</span></div></div>
</div>
<p>Now, <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(b\)</span> can be calculated using the method we saw above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">cons</span><span class="o">⌹</span><span class="nv">coefs</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.5 1
</span></div></div>
</div>
<p>We can also compute the coefficients of the line directly from the vectors <code class="docutils literal notranslate"><span class="pre">xs</span></code> and <code class="docutils literal notranslate"><span class="pre">ys</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">ys</span><span class="o">⌹</span><span class="nv">xs</span><span class="o">,</span><span class="sr">[</span><span class="m">1.5</span><span class="sr">]</span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.5 1
</span></div></div>
</div>
<p>In traditional notation, this gives us the equation <span class="math notranslate nohighlight">\(y = 0.5x + 1\)</span> for the line.
Did you find this tedious?
Maybe, but now let us discover its scope.</p>
</div>
<div class="section" id="calculating-additional-y-coordinates">
<span id="mathematical-functions-calculating-additional-y-coordinates"></span><h4><span class="section-number">13.5.4.2. </span>Calculating Additional Y Coordinates<a class="headerlink" href="#calculating-additional-y-coordinates" title="Permalink to this headline">#</a></h4>
<p>Having found the coefficients of the line shown in the previous section, let us try to calculate the y coordinates of several points for which the x coordinates are known.</p>
<p>The coefficients of our line were obtained by this calculation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">c</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">ys</span><span class="o">⌹</span><span class="nv">coefs</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>We saw earlier that this is strictly equivalent to <code class="docutils literal notranslate"><span class="pre">c</span> <span class="pre">←</span> <span class="pre">(⌹coefs)</span> <span class="pre">+.×</span> <span class="pre">ys</span></code>.
Let us multiply both terms of this expression by <code class="docutils literal notranslate"><span class="pre">coefs</span></code>:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="w">             </span><span class="nv">c</span><span class="w"> </span><span class="o">≡</span><span class="w"> </span><span class="p">(</span><span class="o">⌹</span><span class="nv">coefs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">ys</span><span class="w"> </span><span class="kd">←→</span><span class="w"></span>
<span class="kd">←→</span><span class="w"> </span><span class="nv">coefs</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="o">≡</span><span class="w"> </span><span class="nv">coefs</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="p">(</span><span class="o">⌹</span><span class="nv">coefs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">ys</span><span class="w"> </span><span class="kd">←→</span><span class="w"></span>
<span class="kd">←→</span><span class="w"> </span><span class="nv">coefs</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="o">≡</span><span class="w"> </span><span class="nv">ys</span><span class="w"></span>
</pre></div>
</div>
<p>This shows that the y coordinates <code class="docutils literal notranslate"><span class="pre">ys</span></code> of some points placed on a line defined by the coefficients <code class="docutils literal notranslate"><span class="pre">c</span></code> can be calculated from their x coordinates <code class="docutils literal notranslate"><span class="pre">xs</span></code> by the formula <code class="docutils literal notranslate"><span class="pre">coefs</span> <span class="pre">+.×</span> <span class="pre">c</span></code> or, in a more explicit form: <code class="docutils literal notranslate"><span class="pre">ys</span> <span class="pre">←</span> <span class="pre">c</span> <span class="pre">+.×⍨</span> <span class="pre">xs,[1.5]1</span></code>.</p>
<p>Let us apply this technique to a set of points:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">c</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="na">⍨</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">¯2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">6</span><span class="o">,</span><span class="sr">[</span><span class="m">1.5</span><span class="sr">]</span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 0 2.5 4
</span></div></div>
</div>
<p>You can check these values in <a class="reference internal" href="#fig-graph-p-q"><span class="std std-numref">Fig. 13.1</span></a>.</p>
</div>
</div>
<div class="section" id="least-squares-fitting">
<span id="mathematical-functions-least-squares-fitting"></span><h3><span class="section-number">13.5.5. </span>Least Squares Fitting<a class="headerlink" href="#least-squares-fitting" title="Permalink to this headline">#</a></h3>
<div class="section" id="linear-regression">
<span id="mathematical-functions-linear-regression"></span><h4><span class="section-number">13.5.5.1. </span>Linear Regression<a class="headerlink" href="#linear-regression" title="Permalink to this headline">#</a></h4>
<p>Our line was defined by two points.
What happens if we no longer have 2 points, but many?
Of course, there is a high probability that these points are not aligned.</p>
<p>As an example, suppose that we have twelve employees and we know their ages (in years) and salaries (in peanuts):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">age</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">31</span><span class="w"> </span><span class="m">33</span><span class="w"> </span><span class="m">34</span><span class="w"> </span><span class="m">36</span><span class="w"> </span><span class="m">37</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">44</span><span class="w"> </span><span class="m">45</span><span class="w"> </span><span class="m">51</span><span class="w"></span>
<span class="nv">salaries</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">3071</span><span class="w"> </span><span class="m">2997</span><span class="w"> </span><span class="m">2442</span><span class="w"> </span><span class="m">3589</span><span class="w"> </span><span class="m">3774</span><span class="w"> </span><span class="m">3071</span><span class="w"> </span><span class="m">3108</span><span class="w"> </span><span class="m">5291</span><span class="w"> </span><span class="m">5180</span><span class="w"> </span><span class="m">7548</span><span class="w"> </span><span class="m">5772</span><span class="w"> </span><span class="m">5883</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">age</span><span class="o">,</span><span class="sr">[</span><span class="m">.5</span><span class="sr">]</span><span class="nv">salaries</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">  20   21   28   31   33   34   36   37   40   44   45   51
3071 2997 2442 3589 3774 3071 3108 5291 5180 7548 5772 5883
</span></div></div>
</div>
<p>We shall place the ages on the x axis and salaries on the y axis (see <a class="reference internal" href="#fig-graph-age-salary"><span class="std std-numref">Fig. 13.2</span></a>).</p>
<p>This time, the matrix</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">age</span><span class="o">,</span><span class="sr">[</span><span class="m">1.5</span><span class="sr">]</span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">20 1
21 1
28 1
31 1
33 1
34 1
36 1
37 1
40 1
44 1
45 1
51 1
</span></div></div>
</div>
<p>will have more rows (12) than columns (2), and the set of equations has no solution, which confirms that no single straight line can join all those points.</p>
<p>In this type of situation, it may be desirable to define a straight line which best represents the spread of points.
Generally, a straight line is sought such that the sum of the squares of the deviations of the y coordinates between the given points and the line is minimised.
This particular line is called the <em>least squares line</em> and the process of finding it is called <em>linear regression</em>.</p>
<p>To find this line, we shall use <code class="docutils literal notranslate"><span class="pre">⌹</span></code> once more.
The expression used to calculate the coefficients of a line passing through two points can be applied to a rectangular matrix, and the function <em>matrix divide</em> gives the coefficients of the <em>least squares line</em> passing through the set of points.
Is it not magic?</p>
<p>For the given points, here is the calculation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">salaries</span><span class="o">⌹</span><span class="nv">age</span><span class="o">,</span><span class="sr">[</span><span class="m">1.5</span><span class="sr">]</span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">134.946 ¯412.6
</span></div></div>
</div>
<p>This gives the line <span class="math notranslate nohighlight">\(y = 134.946x - 412.6\)</span>.</p>
<p>We can calculate the approximate salaries located on the line, at the same x coordinates as the given points and compare with the actual salaries:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span><span class="o">⍕</span><span class="w"> </span><span class="nv">salaries</span><span class="w"> </span><span class="o">,</span><span class="sr">[</span><span class="m">.5</span><span class="sr">]</span><span class="w"> </span><span class="nv">c</span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="na">⍨</span><span class="nv">age</span><span class="o">,</span><span class="sr">[</span><span class="m">1.5</span><span class="sr">]</span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 3071 2997 2442 3589 3774 3071 3108 5291 5180 7548 5772 5883
 2286 2421 3366 3771 4041 4176 4445 4580 4985 5525 5660 6470
</span></div></div>
</div>
<div class="figure align-default" id="graph-age-salary">
<span id="fig-graph-age-salary"></span><img alt="_images/Graph_Age_Salary.png" src="_images/Graph_Age_Salary.png" />
<p class="caption"><span class="caption-number">Fig. 13.2 </span><span class="caption-text">Graph with the salaries (in peanuts) as a function of the age</span><a class="headerlink" href="#graph-age-salary" title="Permalink to this image">#</a></p>
</div>
</div>
<div class="section" id="extension">
<span id="mathematical-functions-extension"></span><h4><span class="section-number">13.5.5.2. </span>Extension<a class="headerlink" href="#extension" title="Permalink to this headline">#</a></h4>
<p>In the previous example, we measured the effect of a single factor (age) on a single observation (salary) using a linear model.</p>
<p>What if we want to use the same model to explore the relationship between several factors and a single observation?
The following example is inspired by a controller in IBM France who tried to see if the heads of his commercial agencies had “reasonable” expense claim forms.</p>
<p>The amounts were stored in a vector <code class="docutils literal notranslate"><span class="pre">amounts</span></code>.
He tried to measure the effect of 4 factors on these expenses amounts:</p>
<ul class="simple">
<li><p>the number of salesmen in each agency, <code class="docutils literal notranslate"><span class="pre">nbmen</span></code>;</p></li>
<li><p>the size of the area covered by each agency, <code class="docutils literal notranslate"><span class="pre">radius</span></code>;</p></li>
<li><p>the number of customers in each agency, <code class="docutils literal notranslate"><span class="pre">nbcus</span></code>; and</p></li>
<li><p>the annual income produced by each agency, <code class="docutils literal notranslate"><span class="pre">income</span></code>.</p></li>
</ul>
<p>In other words, he tried to find the vector <code class="docutils literal notranslate"><span class="pre">tc</span></code> of 5 theoretical coefficients, <span class="math notranslate nohighlight">\(c_1, \cdots, c_5\)</span>, which most closely satisfy this equation:</p>
<div class="math notranslate nohighlight">
\[
{\rm amounts} = {\rm nbmen}\times c_1 + {\rm radius}\times c_2 + {\rm nbcus}\times c_3 + {\rm income}\times c_4 + c_5
\]</div>
<p>Or, in APL, we want to find the 5-element vector <code class="docutils literal notranslate"><span class="pre">tc</span></code> that most closely satisfies this equality:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">amounts</span><span class="w"> </span><span class="o">≡</span><span class="w"> </span><span class="nv">tc</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">nbmen</span><span class="w"> </span><span class="nv">radius</span><span class="w"> </span><span class="nv">nbcus</span><span class="w"> </span><span class="nv">income</span><span class="w"> </span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
<p>Here is the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">amounts</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">40420</span><span class="w"> </span><span class="m">23000</span><span class="w"> </span><span class="m">28110</span><span class="w"> </span><span class="m">32460</span><span class="w"> </span><span class="m">25800</span><span class="w"> </span><span class="m">33610</span><span class="w"> </span><span class="m">61520</span><span class="w"> </span><span class="m">44970</span><span class="w"></span>
<span class="nv">nbmen</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">31</span><span class="w"> </span><span class="m">17</span><span class="w"></span>
<span class="nv">radius</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">90</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">120</span><span class="w"> </span><span class="m">75</span><span class="w"></span>
<span class="nv">nbcus</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">430</span><span class="w"> </span><span class="m">87</span><span class="w"> </span><span class="m">72</span><span class="w"> </span><span class="m">210</span><span class="w"> </span><span class="m">144</span><span class="w"> </span><span class="m">91</span><span class="w"> </span><span class="m">207</span><span class="w"> </span><span class="m">161</span><span class="w"></span>
<span class="nv">income</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">2400</span><span class="w"> </span><span class="m">9000</span><span class="w"> </span><span class="m">9500</span><span class="w"> </span><span class="m">4100</span><span class="w"> </span><span class="m">6500</span><span class="w"> </span><span class="m">3300</span><span class="w"> </span><span class="m">9800</span><span class="w"> </span><span class="m">4900</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>Let us apply exactly what we did on ages and salaries, and calculate the following variables:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">coefs</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">nbmen</span><span class="o">,</span><span class="nv">radius</span><span class="o">,</span><span class="nv">nbcus</span><span class="o">,</span><span class="nv">income</span><span class="o">,</span><span class="sr">[</span><span class="m">1.5</span><span class="sr">]</span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">25  90 430 2400 1
20  50  87 9000 1
24  12  72 9500 1
28  12 210 4100 1
14  30 144 6500 1
 8  30  91 3300 1
31 120 207 9800 1
17  75 161 4900 1
</span></div></div>
</div>
<p>Next, we compute the 5 coefficients of the least squares line:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="m">2</span><span class="o">⍕</span><span class="nv">tc</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">amounts</span><span class="o">⌹</span><span class="nv">coefs</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 1154.23 362.14 ¯99.39 ¯3.33 31193.65
</span></div></div>
</div>
<p>Now, we compute the y coordinates of the points on the least squares line:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">ys</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">coefs</span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="nv">tc</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we compute the differences between the expenses predicted by the expenses claims and the actual claims, and we compute the percentage deviation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">diff</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">amounts</span><span class="o">-</span><span class="nv">ys</span><span class="w"></span>
<span class="nv">pcent</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">100</span><span class="o">×</span><span class="nv">diff</span><span class="o">÷</span><span class="nv">ys</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we display all the data, with a “-” next to the agencies for which the expenses are significantly above the predicted value (possibly because the agencies have bad managers) and a “+” sign next to the agencies for which the expenses are significantly below the predicted value (possibly because the agencies have good managers):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">flag</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="s1">&#39;+ -&#39;</span><span class="sr">[</span><span class="m">1</span><span class="o">+</span><span class="m">¯10</span><span class="w"> </span><span class="m">10</span><span class="o">⍸</span><span class="nv">pcent</span><span class="sr">]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> +- -   
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">title</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">29</span><span class="o">↑</span><span class="s1">&#39;   Real Normal   Diff      %&#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">   Real Normal   Diff      % 
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">title</span><span class="o">⍪</span><span class="p">(</span><span class="m">7</span><span class="w"> </span><span class="m">0</span><span class="o">⍕</span><span class="nv">amounts</span><span class="o">,</span><span class="nv">ys</span><span class="o">,</span><span class="nv">diff</span><span class="o">,</span><span class="sr">[</span><span class="m">1.5</span><span class="sr">]</span><span class="nv">pcent</span><span class="p">)</span><span class="o">,</span><span class="nv">flag</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">   Real Normal   Diff      % 
  40420  41914  ¯1494     ¯4 
  23000  33773 ¯10773    ¯32+
  28110  24455   3655     15-
  32460  33335   ¯875     ¯3 
  25800  22264   3536     16-
  33610  31260   2350      8 
  61520  57229   4291      7 
  44970  45660   ¯690     ¯2 
</span></div></div>
</div>
</div>
<div class="section" id="non-linear-adjustment">
<span id="mathematical-functions-non-linear-adjustment"></span><h4><span class="section-number">13.5.5.3. </span>Non-linear Adjustment<a class="headerlink" href="#non-linear-adjustment" title="Permalink to this headline">#</a></h4>
<p>In this last example we used independent factors and tried to combine them with a linear expression.
We could as well have used vectors linked one to the other by any mathematical expression, like <code class="docutils literal notranslate"><span class="pre">results</span> <span class="pre">←</span> <span class="pre">(c1×var)+(c2×var*2)+(c3×⍟var)+c4</span></code> (if this makes sense).
A typical case is trying to fit a set of points with a polynomial curve.
Here are 8 points:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">xs</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">¯1</span><span class="w"> </span><span class="m">¯1</span><span class="w"> </span><span class="m">0.5</span><span class="w">  </span><span class="m">1.5</span><span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span><span class="w"></span>
<span class="nv">ys</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">¯3</span><span class="w"> </span><span class="m">¯1</span><span class="w"> </span><span class="m">0</span><span class="w">   </span><span class="m">¯1</span><span class="w">   </span><span class="m">¯1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">5</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>A linear regression would give a line with the following coefficients:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span><span class="o">⍕</span><span class="w"> </span><span class="nv">ys</span><span class="o">⌹</span><span class="nv">xs</span><span class="o">,</span><span class="sr">[</span><span class="m">1.5</span><span class="sr">]</span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 1.22 ¯1.31
</span></div></div>
</div>
<p>The right argument was obtained by laminating 1 to <code class="docutils literal notranslate"><span class="pre">xs</span></code>.
However, we could just as well have obtained it with the following <em>outer product</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">xs</span><span class="na">∘.</span><span class="o">*</span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯1   1
¯1   1
 0.5 1
 1.5 1
 2   1
 2   1
 3   1
 4   1
</span></div></div>
</div>
<p>Now, instead of taking only powers 1 and 0 of <code class="docutils literal notranslate"><span class="pre">xs</span></code>, we could extend the scope of the powers up to the third degree, for example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">xs</span><span class="na">∘.</span><span class="o">*</span><span class="m">3</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯1      1    ¯1   1
¯1      1    ¯1   1
 0.125  0.25  0.5 1
 3.375  2.25  1.5 1
 8      4     2   1
 8      4     2   1
27      9     3   1
64     16     4   1
</span></div></div>
</div>
<p>We would then obtain not the coefficients of a straight line, but those of a third degree polynomial curve, shown in <a class="reference internal" href="#fig-graph-cubic"><span class="std std-numref">Fig. 13.3</span></a>.</p>
<div class="figure align-default" id="graph-cubic">
<span id="fig-graph-cubic"></span><img alt="_images/Graph_Cubic.png" src="_images/Graph_Cubic.png" />
<p class="caption"><span class="caption-number">Fig. 13.3 </span><span class="caption-text">A third degree polynomial adjusted to some points.</span><a class="headerlink" href="#graph-cubic" title="Permalink to this image">#</a></p>
</div>
<p>To get the coefficients, we do the usual computation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span><span class="o">⍕</span><span class="w"> </span><span class="nv">c</span><span class="kd">←</span><span class="nv">ys</span><span class="o">⌹</span><span class="nv">xs</span><span class="na">∘.</span><span class="o">*</span><span class="m">3</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 0.10 ¯0.16 0.58 ¯1.07
</span></div></div>
</div>
<p>In other words, this set of points can be approximated by the line <span class="math notranslate nohighlight">\(0.1x^3 - 0.16x^2 + 0.58x - 1.07\)</span>.</p>
</div>
</div>
</div>
<div class="section" id="exercises">
<span id="mathematical-functions-exercises"></span><h2><span class="section-number">13.6. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<div class="exercise admonition" id="ex-encode">

<p class="admonition-title"><span class="caption-number">Exercise 13.1 </span></p>
<div class="section" id="exercise-content">
<p>Can you predict (and explain) the results of the two expressions below?</p>
</div>
</div>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span><span class="w"> </span><span class="o">⊥</span><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">34</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">77</span><span class="w"> </span><span class="m">19</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">19
</span></div></div>
</div>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="w"> </span><span class="o">⊥</span><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">34</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">77</span><span class="w"> </span><span class="m">19</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">202
</span></div></div>
</div>
<div class="exercise admonition" id="ex-hex">

<p class="admonition-title"><span class="caption-number">Exercise 13.2 </span></p>
<div class="section" id="exercise-content">
<p>In a binary number system, a group of 4 bits represents values from 0 to 15.
Those 4 bits represent the 16 states of a base 16 number system known as the hexadecimal number system.
This system is very often used in computer science, with the numbers 0-9 represented by the characters “0”-“9”, and the numbers 10-15 represented by the characters “A” to “F”.
Write a function to convert hexadecimal values to decimal, and the reverse.
Assume hexadecimal values are represented as 4 character vectors:</p>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">D2H</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="s1">&#39;0123456789ABCDEF&#39;</span><span class="sr">[</span><span class="m">1</span><span class="o">+</span><span class="m">16</span><span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="m">16</span><span class="o">⊤</span><span class="bp">⍵</span><span class="sr">]</span><span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">⍪,</span><span class="nv">D2H</span><span class="na">¨</span><span class="p">)</span><span class="w"> </span><span class="m">¯1</span><span class="o">+⍳</span><span class="m">16</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌──┬────┐
│0 │0000│
├──┼────┤
│1 │0001│
├──┼────┤
│2 │0002│
├──┼────┤
│3 │0003│
├──┼────┤
│4 │0004│
├──┼────┤
│5 │0005│
├──┼────┤
│6 │0006│
├──┼────┤
│7 │0007│
├──┼────┤
│8 │0008│
├──┼────┤
│9 │0009│
├──┼────┤
│10│000A│
├──┼────┤
│11│000B│
├──┼────┤
│12│000C│
├──┼────┤
│13│000D│
├──┼────┤
│14│000E│
├──┼────┤
│15│000F│
└──┴────┘
</span></div></div>
</div>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">D2H</span><span class="na">¨</span><span class="w"> </span><span class="m">6748</span><span class="w"> </span><span class="m">49679</span><span class="w"> </span><span class="m">60281</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌────┬────┬────┐
│1A5C│C20F│EB79│
└────┴────┴────┘
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">H2D</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="m">16</span><span class="o">⊥</span><span class="m">¯1</span><span class="o">+</span><span class="s1">&#39;0123456789ABCDEF&#39;</span><span class="o">⍳</span><span class="bp">⍵</span><span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">H2D</span><span class="na">¨</span><span class="w"> </span><span class="s1">&#39;1A5C&#39;</span><span class="w"> </span><span class="s1">&#39;C20F&#39;</span><span class="w"> </span><span class="s1">&#39;EB79&#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6748 49679 60281
</span></div></div>
</div>
<div class="exercise admonition" id="ex-sparse-array">

<p class="admonition-title"><span class="caption-number">Exercise 13.3 </span></p>
<div class="section" id="exercise-content">
<p>A sparse array is an array of zeroes with only a small number of non-zero elements.
To save memory, sparse arrays are often represented in condensed forms, where we only store the positions of the non-zero values.
In this exercise, you will write two functions, <code class="docutils literal notranslate"><span class="pre">Contract</span></code> and <code class="docutils literal notranslate"><span class="pre">Expand</span></code>, to convert a sparse array into its compressed form and vice-versa.</p>
<p><code class="docutils literal notranslate"><span class="pre">Contract</span></code> accepts an arbitrary sparse array <code class="docutils literal notranslate"><span class="pre">sa</span></code> as its only argument and returns a vector with the following characteristics:</p>
<ul class="simple">
<li><p>the first element is the rank <code class="docutils literal notranslate"><span class="pre">r</span></code> of <code class="docutils literal notranslate"><span class="pre">sa</span></code>;</p></li>
<li><p>the next <code class="docutils literal notranslate"><span class="pre">r</span></code> elements are the shape of <code class="docutils literal notranslate"><span class="pre">sa</span></code>;</p></li>
<li><p>the next <code class="docutils literal notranslate"><span class="pre">n</span></code> elements are the <code class="docutils literal notranslate"><span class="pre">n</span></code> non-zero values of <code class="docutils literal notranslate"><span class="pre">sa</span></code>; and</p></li>
<li><p>the final <code class="docutils literal notranslate"><span class="pre">n</span></code> elements are the positions of the corresponding non-zero elements. However, the final <code class="docutils literal notranslate"><span class="pre">n</span></code> elements should be the indices of the non-zero values in the ravel of <code class="docutils literal notranslate"><span class="pre">sa</span></code>, and not the high-rank indices.</p></li>
</ul>
<p>The function <code class="docutils literal notranslate"><span class="pre">Expand</span></code> should do the reverse operation.</p>
<p>Implement <code class="docutils literal notranslate"><span class="pre">Contract</span></code> and <code class="docutils literal notranslate"><span class="pre">Expand</span></code> without using the function <em>ravel</em>.</p>
</div>
</div>
<p>Here is a worked example with a 5 by 7 matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">sa</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">7</span><span class="o">⍴</span><span class="m">0</span><span class="w"> </span><span class="p">⋄</span><span class="w"> </span><span class="nv">sa</span><span class="sr">[</span><span class="m">1</span><span class="sr">;</span><span class="m">2</span><span class="sr">]</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="p">⋄</span><span class="w"> </span><span class="nv">sa</span><span class="sr">[</span><span class="m">4</span><span class="sr">;</span><span class="m">1</span><span class="sr">]</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">5.6</span><span class="w"></span>
<span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">sa</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0   3 0 0 0 0 0
0   0 0 0 0 0 0
0   0 0 0 0 0 0
5.6 0 0 0 0 0 0
0   0 0 0 0 0 0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span><span class="w"></span>
<span class="nv">Contract</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="w"></span>
<span class="w">    </span><span class="nv">flat</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">1</span><span class="o">+</span><span class="p">(</span><span class="o">⍴</span><span class="bp">⍵</span><span class="p">)</span><span class="o">⊥</span><span class="m">¯1</span><span class="o">+⍉↑</span><span class="nv">idx</span><span class="kd">←</span><span class="o">⍸</span><span class="m">0</span><span class="o">≠</span><span class="nv">sa</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="o">≢⍴</span><span class="bp">⍵</span><span class="p">)</span><span class="o">,</span><span class="p">(</span><span class="o">⍴</span><span class="bp">⍵</span><span class="p">)</span><span class="o">,</span><span class="bp">⍵</span><span class="sr">[</span><span class="nv">idx</span><span class="sr">]</span><span class="o">,</span><span class="nv">flat</span><span class="w"></span>
<span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">Contract</span><span class="w"> </span><span class="nv">sa</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 5 7 3 5.6 2 22
</span></div></div>
</div>
<p>The matrix <code class="docutils literal notranslate"><span class="pre">sa</span></code> has two non-zero values at indices <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">2</span></code> and <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">1</span></code>, respectively.
However, in the ravel of <code class="docutils literal notranslate"><span class="pre">sa</span></code>, those two non-zero values are at indices <code class="docutils literal notranslate"><span class="pre">2</span></code> and <code class="docutils literal notranslate"><span class="pre">22</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">,</span><span class="nv">sa</span><span class="p">)</span><span class="sr">[</span><span class="m">2</span><span class="w"> </span><span class="m">22</span><span class="sr">]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 5.6
</span></div></div>
</div>
<p>Thus, the final part of the result of <code class="docutils literal notranslate"><span class="pre">Contract</span> <span class="pre">sa</span></code> should be the 4-item vector <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">5.6</span> <span class="pre">2</span> <span class="pre">22</span></code>:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="w">      </span><span class="nv">Contract</span><span class="w"> </span><span class="nv">sa</span><span class="w"></span>
<span class="m">2</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">5.6</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">22</span><span class="w"></span>
<span class="o">↑</span><span class="w"> </span><span class="o">~~~</span><span class="w"> </span><span class="o">∧∧∧∧∧</span><span class="w"> </span><span class="o">∧∧∧∧</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="o">|</span><span class="w">   </span><span class="nv">the</span><span class="w"> </span><span class="nv">corresponding</span><span class="w"> </span><span class="nv">indices</span><span class="w"> </span><span class="nv">are</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="m">22</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="nv">the</span><span class="w"> </span><span class="nv">non</span><span class="o">-</span><span class="nv">zero</span><span class="w"> </span><span class="nv">values</span><span class="w"> </span><span class="nv">are</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="m">5.6</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="nv">shape</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">sa</span><span class="w"></span>
<span class="nv">rank</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">sa</span><span class="w"></span>
</pre></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">Expand</span></code> should do the reverse operation:</p>
<div class="exercise admonition" id="ex-random">

<p class="admonition-title"><span class="caption-number">Exercise 13.4 </span></p>
<div class="section" id="exercise-content">
<p>Create three variables, filled with random integers, according to the following specifications:</p>
<ul class="simple">
<li><p>a vector of 12 values between 8 and 30, without duplicates;</p></li>
<li><p>a 4 by 6 matrix filled with values between 37 and 47, with possible duplicates; and</p></li>
<li><p>a 5 by 2 matrix filled with values between ¯5 and 5, without duplicates.</p></li>
</ul>
</div>
</div>
<div class="exercise admonition" id="ex-random-decimals">

<p class="admonition-title"><span class="caption-number">Exercise 13.5 </span></p>
<div class="section" id="exercise-content">
<p>Create a vector of 15 random numbers between 0.01 and 0.09 inclusive, with 3 significant digits each, with possible duplicates.</p>
</div>
</div>
<div class="exercise admonition" id="ex-read-random">

<p class="admonition-title"><span class="caption-number">Exercise 13.6 </span></p>
<div class="section" id="exercise-content">
<p>What will we obtain by executing the expression <code class="docutils literal notranslate"><span class="pre">10+?(10+?10)⍴10</span></code>?</p>
</div>
</div>
<div class="exercise admonition" id="ex-random-choose">

<p class="admonition-title"><span class="caption-number">Exercise 13.7 </span></p>
<div class="section" id="exercise-content">
<p>We would like to obtain a vector of 5 items, chosen randomly and without duplicates among the elements of <code class="docutils literal notranslate"><span class="pre">list</span> <span class="pre">←</span> <span class="pre">12</span> <span class="pre">29</span> <span class="pre">5</span> <span class="pre">44</span> <span class="pre">31</span> <span class="pre">60</span> <span class="pre">8</span> <span class="pre">86</span></code>.</p>
</div>
</div>
<div class="exercise admonition" id="ex-random-length">

<p class="admonition-title"><span class="caption-number">Exercise 13.8 </span></p>
<div class="section" id="exercise-content">
<p>Create a vector with a length randomly chosen between 6 and 16, and filled with random integers between 3 and 40 inclusive, with possible duplicates.</p>
</div>
</div>
<div class="exercise admonition" id="ex-cos-approximation">

<p class="admonition-title"><span class="caption-number">Exercise 13.9 </span></p>
<div class="section" id="exercise-content">
<p>The value of <span class="math notranslate nohighlight">\(\cos x\)</span> can be calculated by the following formula, written with traditional mathematical notation:</p>
<div class="math notranslate nohighlight">
\[
\cos x = x^0/0! - x^2/2! + x^4/4! - x^6/6! + x^8/8! - x^{10}/10! \cdots
\]</div>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">Cos</span> <span class="pre">x</span></code> that accepts an integer <code class="docutils literal notranslate"><span class="pre">n</span></code> as left argument and a value <code class="docutils literal notranslate"><span class="pre">x</span></code> as right argument and computes the value of the expression above up to the power <code class="docutils literal notranslate"><span class="pre">2×n</span></code>, for the value <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>(To verify your answer, <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">Cos</span> <span class="pre">x</span></code> should be close to <code class="docutils literal notranslate"><span class="pre">2○x</span></code>.)</p>
</div>
</div>
<div class="exercise admonition" id="ex-circle">

<p class="admonition-title"><span class="caption-number">Exercise 13.10 </span></p>
<div class="section" id="exercise-content">
<p>Try to evaluate the following expressions, and then check your result on the computer:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(1○○÷4)*2</span></code>; and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2×0.5+¯2○1○0.5</span></code>.</p></li>
</ul>
<p>(This exercise assumes you have some trigonometry knowledge.)</p>
</div>
</div>
<div class="exercise admonition" id="ex-solve-linear-eqs">

<p class="admonition-title"><span class="caption-number">Exercise 13.11 </span></p>
<div class="section" id="exercise-content">
<p>Find the solution to this set of equations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
x - y &amp;= 5 \\
y - 2z &amp;= -7 \\
z - x &amp;= 2
\end{align}
\end{split}\]</div>
</div>
</div>
<div class="exercise admonition" id="ex-linear-eqs-compute">

<p class="admonition-title"><span class="caption-number">Exercise 13.12 </span></p>
<div class="section" id="exercise-content">
<p>Three variables <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, and <span class="math notranslate nohighlight">\(c\)</span>, meet the following conditions:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
a - b + 3c &amp;= 13 \\
4b - 2a &amp;= -6 \\
a - 2b + 2c &amp;= 10
\end{align}
\end{split}\]</div>
<p>Can you calculate the value of <span class="math notranslate nohighlight">\(3a + 5b - c\)</span>?</p>
</div>
</div>
</div>
<div class="section" id="the-specialist-s-section">
<span id="mathematical-functions-the-specialists-section"></span><h2><span class="section-number">13.7. </span>The Specialist’s Section<a class="headerlink" href="#the-specialist-s-section" title="Permalink to this headline">#</a></h2>
<br />
<center><i>Each chapter is followed by a "Specialist's Section" like this one. This section is dedicated to skilled APLers who wish to improve their knowledge.</i>
<p>You will find here rare or complex usages of the concepts presented in this chapter, or discover extended explanations which need the knowledge of some symbols that will be seen much further in the book.</p>
<p><b>If you are exploring APL for the first time, skip this section and go to the next chapter.</b></center></p>
<div class="section" id="advanced-encode-and-decode">
<span id="mathematical-functions-advanced-encode-and-decode"></span><h3><span class="section-number">13.7.1. </span>Advanced Encode and Decode<a class="headerlink" href="#advanced-encode-and-decode" title="Permalink to this headline">#</a></h3>
<div class="section" id="special-decoding">
<span id="mathematical-functions-special-decoding"></span><h4><span class="section-number">13.7.1.1. </span>Special Decoding<a class="headerlink" href="#special-decoding" title="Permalink to this headline">#</a></h4>
<p>If you replace <em>decode</em> by the equivalent <em>inner product</em>, you can easily check these surprising properties:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span><span class="o">⊥</span><span class="nv">v</span><span class="w"> </span><span class="kd">←→</span><span class="w"> </span><span class="no">⍬</span><span class="o">⍴</span><span class="m">¯1</span><span class="o">↑</span><span class="nv">v</span><span class="w"></span>
<span class="m">1</span><span class="o">⊥</span><span class="nv">v</span><span class="w"> </span><span class="kd">←→</span><span class="w"> </span><span class="o">+</span><span class="na">/</span><span class="nv">v</span><span class="w"></span>
</pre></div>
</div>
<p>When dealing with integers, the values are normally smaller than the corresponding items of the <em>base</em>.
For example, it would be unusual to say that a time is equal to 7 hours, 83 minutes, and 127 seconds.
However, <em>decode</em> works perfectly on such values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">24</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="o">⊥</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">83</span><span class="w"> </span><span class="m">127</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">30307
</span></div></div>
</div>
<p>And, though we did not mention it, <em>encode</em> (like <em>decode</em>) accepts decimal and/or negative bases:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span><span class="o">⍴</span><span class="m">5.2</span><span class="w"> </span><span class="o">⊤</span><span class="w"> </span><span class="m">160.23</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4.23 4.23 4.23
</span></div></div>
</div>
</div>
<div class="section" id="processing-negative-values">
<span id="mathematical-functions-processing-negative-values"></span><h4><span class="section-number">13.7.1.2. </span>Processing Negative Values<a class="headerlink" href="#processing-negative-values" title="Permalink to this headline">#</a></h4>
<p>Imagine that we want to encode some numbers in any base, with 6 digits.
We will choose base 10, so that the result is readily understandable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">6</span><span class="o">⍴</span><span class="m">10</span><span class="p">)</span><span class="o">⊤</span><span class="m">17</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 0 1 7
</span></div></div>
</div>
<p>Now, let us try to predict the result of <code class="docutils literal notranslate"><span class="pre">(6⍴10)⊤¯17</span></code>.
Knowing that <code class="docutils literal notranslate"><span class="pre">17+¯17</span></code> is 0, it would be reasonable to expect that <code class="docutils literal notranslate"><span class="pre">((6⍴10)⊤17)+((6⍴10)⊤¯17)</span></code> also returns a result that is “zero” in some way – for example <code class="docutils literal notranslate"><span class="pre">6⍴0</span></code>?</p>
<p>In other words, we are looking for a 6-item vector that, when added to <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">0</span> <span class="pre">0</span> <span class="pre">0</span> <span class="pre">1</span> <span class="pre">7</span></code>, gives <code class="docutils literal notranslate"><span class="pre">6⍴0</span></code>.
The real challenge is that the items of the vector must only contain the digits 0 through 9!</p>
<p>Let us see what happens:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">6</span><span class="o">⍴</span><span class="m">10</span><span class="p">)</span><span class="o">⊤</span><span class="m">¯17</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">9 9 9 9 8 3
</span></div></div>
</div>
<p>These results may seem a bit surprising.
In base 10, when the sum of two digits exceeds 9, a carry is produced, which is used when adding the next digits to the left, and so on.
When adding the encoded values of <code class="docutils literal notranslate"><span class="pre">17</span></code> and <code class="docutils literal notranslate"><span class="pre">¯17</span></code>, here is how the values are processed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
    <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">7</span>
<span class="o">+</span>   <span class="mi">9</span> <span class="mi">9</span> <span class="mi">9</span> <span class="mi">9</span> <span class="mi">8</span> <span class="mi">3</span>
  <span class="o">-------------</span>
<span class="o">=</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
<p>If only 6 digits are kept, as agreed, you can see that the result is composed only of zeroes (the six leftmost digits in the result).</p>
<p>That would be the same for <code class="docutils literal notranslate"><span class="pre">431</span></code> and <code class="docutils literal notranslate"><span class="pre">¯431</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">6</span><span class="o">⍴</span><span class="m">10</span><span class="p">)</span><span class="o">⊤</span><span class="m">431</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 4 3 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">6</span><span class="o">⍴</span><span class="m">10</span><span class="p">)</span><span class="o">⊤</span><span class="m">¯431</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">9 9 9 5 6 9
</span></div></div>
</div>
<p>We can observe the same behaviour in any other base.
For example, in base 5:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">6</span><span class="o">⍴</span><span class="m">5</span><span class="p">)</span><span class="o">⊤</span><span class="m">68</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 2 3 3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">6</span><span class="o">⍴</span><span class="m">5</span><span class="p">)</span><span class="o">⊤</span><span class="m">¯68</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4 4 4 2 1 2
</span></div></div>
</div>
<p>Remember that, in base 5, <code class="docutils literal notranslate"><span class="pre">0=3+2</span></code>!</p>
<p>The rule remains true for decimal values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">6</span><span class="o">⍴</span><span class="m">10</span><span class="p">)</span><span class="o">⊤</span><span class="m">15.8</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 0 1 5.8
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">6</span><span class="o">⍴</span><span class="m">10</span><span class="p">)</span><span class="o">⊤</span><span class="m">¯15.8</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">9 9 9 9 8 4.2
</span></div></div>
</div>
<p>This may lead to a few frustrations during decoding if precautions are not taken:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">10</span><span class="o">⊥</span><span class="p">(</span><span class="m">6</span><span class="o">⍴</span><span class="m">10</span><span class="p">)</span><span class="o">⊤</span><span class="w"> </span><span class="m">143</span><span class="w">  </span><span class="c1">⍝ as expected</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">143
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">10</span><span class="o">⊥</span><span class="p">(</span><span class="m">6</span><span class="o">⍴</span><span class="m">10</span><span class="p">)</span><span class="o">⊤</span><span class="m">¯143</span><span class="w">  </span><span class="c1">⍝ this may seem wrong</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">999857
</span></div></div>
</div>
<p>The result obtained from the two decodings is such that their sum is 1,000,000.</p>
<p>If one needs to encode and later decode values among which some may be negative, it is advisable to provide one more digit than is necessary, and to test its value.
In many computers, the internal representation of positive numbers begin with a 0-bit and negative numbers start with a 1-bit.
The same principle applies to the decoded values.
In base 10, positive values begin with the digit 0, and negative ones with a 9.
From this, we can deduce a general function to decode values encoded in a uniform base:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span><span class="w"></span>
<span class="nv">Decode</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="w">  </span><span class="c1">⍝ base Decode values</span><span class="w"></span>
<span class="w">    </span><span class="nv">z</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="bp">⍺</span><span class="o">⊥</span><span class="bp">⍵</span><span class="w"></span>
<span class="w">    </span><span class="nv">p</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">1</span><span class="o">↑⍴</span><span class="bp">⍵</span><span class="w"></span>
<span class="w">    </span><span class="nv">z</span><span class="o">-</span><span class="p">(</span><span class="bp">⍺</span><span class="o">*</span><span class="nv">p</span><span class="p">)</span><span class="o">×</span><span class="p">(</span><span class="nv">z</span><span class="o">&gt;</span><span class="m">¯1</span><span class="o">+</span><span class="bp">⍺</span><span class="o">*</span><span class="nv">p</span><span class="o">-</span><span class="m">1</span><span class="p">)</span><span class="w"></span>
<span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">test</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="p">(</span><span class="m">6</span><span class="o">⍴</span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="o">⊤</span><span class="w"> </span><span class="m">¯417.42</span><span class="w"> </span><span class="m">26</span><span class="w"> </span><span class="m">32</span><span class="w"> </span><span class="m">¯1654</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">3.7</span><span class="w"> </span><span class="m">¯55</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">10</span><span class="o">⊥</span><span class="nv">test</span><span class="w">  </span><span class="c1">⍝ negative values are wrongly decoded...</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">999583 26 32 998346 0 3.7 999945
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">10</span><span class="w"> </span><span class="nv">Decode</span><span class="w"> </span><span class="nv">test</span><span class="w">  </span><span class="c1">⍝ positive values are correctly decoded!</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯417.42 26 32 ¯1654 0 3.7 ¯55
</span></div></div>
</div>
</div>
<div class="section" id="multiple-encoding-decoding">
<span id="mathematical-functions-multiple-encodingdecoding"></span><h4><span class="section-number">13.7.1.3. </span>Multiple Encoding/Decoding<a class="headerlink" href="#multiple-encoding-decoding" title="Permalink to this headline">#</a></h4>
<p>It is possible to decode a value using several bases simultaneously:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">bb</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">⍉</span><span class="m">4</span><span class="w"> </span><span class="m">3</span><span class="o">⍴</span><span class="m">5</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">6</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 5  5  5  5
10 10 10 10
 6  6  6  6
</span></div></div>
</div>
<p>The different bases are placed in different rows of the matrix.
Now, we can interpret <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">1</span> <span class="pre">3</span> <span class="pre">2</span></code> in 3 different bases:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">bb</span><span class="o">⊥</span><span class="m">4</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">2</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">542 4132 920
</span></div></div>
</div>
<p>In this very specific case, the 3 bases were all uniform; a simple column vector with one digit per row would have given the same conversion:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">⍪</span><span class="m">5</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">6</span><span class="p">)</span><span class="o">⊥</span><span class="m">4</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">2</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">542 4132 920
</span></div></div>
</div>
<p>That is because a scalar base expands into as many digits as needed.</p>
<p>Similarly, it is possible to see how a single number could be represented in several bases:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">5</span><span class="w"> </span><span class="m">3</span><span class="o">⍴</span><span class="m">5</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="o">⊤</span><span class="m">27</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 1
0 0 1
1 0 0
0 2 1
2 7 1
</span></div></div>
</div>
<div class="tip admonition">
<p class="admonition-title">Remark</p>
<p>The arguments of <em>encode</em> and <em>decode</em> must obey the following rules:</p>
<ul class="simple">
<li><p>In <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">←</span> <span class="pre">bases</span> <span class="pre">⊥</span> <span class="pre">mat</span></code>, <code class="docutils literal notranslate"><span class="pre">⍴r</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">(¯1↓⍴,bases),1↓⍴mat</span></code>.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">←</span> <span class="pre">bases</span> <span class="pre">⊤</span> <span class="pre">mat</span></code>, <code class="docutils literal notranslate"><span class="pre">⍴r</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">bases</span> <span class="pre">,⍥⍴</span> <span class="pre">mat</span></code>.</p></li>
</ul>
</div>
<p>Let us convert (<em>encode</em>) the following matrix <code class="docutils literal notranslate"><span class="pre">seconds</span></code> into hours, minutes, and seconds:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">seconds</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="o">⍴</span><span class="m">1341</span><span class="w"> </span><span class="m">5000</span><span class="w"> </span><span class="m">345</span><span class="w"> </span><span class="m">3600</span><span class="w"> </span><span class="m">781</span><span class="w"> </span><span class="m">90</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1341 5000 345
3600  781  90
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">24</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="o">⊤</span><span class="w"> </span><span class="nv">seconds</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 0  1  0
 1  0  0

22 23  5
 0 13  1

21 20 45
 0  1 30
</span></div></div>
</div>
<p>The first plane of the 3D array contains the hours, the second plane contains the minutes, and the third plane contains the seconds.</p>
</div>
</div>
<div class="section" id="gamma-and-beta-functions">
<span id="mathematical-functions-gamma-and-beta-functions"></span><h3><span class="section-number">13.7.2. </span>Gamma and Beta Functions<a class="headerlink" href="#gamma-and-beta-functions" title="Permalink to this headline">#</a></h3>
<p>In mathematics, the <em>gamma</em> function of a variable <span class="math notranslate nohighlight">\(x\)</span> is defined by the following formula:</p>
<div class="math notranslate nohighlight">
\[
\Gamma(x) = \int_0^\infty t^{x-1}e^{-t} dt
\]</div>
<p>This function satisfies the recurrence relationship <span class="math notranslate nohighlight">\(\Gamma(x) = x\times \Gamma(x-1)\)</span>.
If <span class="math notranslate nohighlight">\(x\)</span> is an integer, <span class="math notranslate nohighlight">\(\Gamma(x)\)</span> is the same as <span class="math notranslate nohighlight">\((x-1)!\)</span>.
In APL, monadic <code class="docutils literal notranslate"><span class="pre">!n</span></code> gives the <em>gamma</em> function of <code class="docutils literal notranslate"><span class="pre">n+1</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span><span class="m">2.4</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3.2</span><span class="w"> </span><span class="m">3.4</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2.98121 6 7.75669 10.1361
</span></div></div>
</div>
<p>The dyadic form of <code class="docutils literal notranslate"><span class="pre">!</span></code> gives the <em>binomial</em> function, which satisfies the following identity with the mathematical <em>beta</em> function: <span class="math notranslate nohighlight">\(\beta(a, b)\)</span> is identical to <code class="docutils literal notranslate"><span class="pre">÷b×(a-1)!a+b-1</span></code>.</p>
</div>
<div class="section" id="domino-and-rectangular-matrices">
<span id="mathematical-functions-domino-and-rectangular-matrices"></span><h3><span class="section-number">13.7.3. </span>Domino and Rectangular Matrices<a class="headerlink" href="#domino-and-rectangular-matrices" title="Permalink to this headline">#</a></h3>
<p>We have defined the <em>matrix inverse</em> for square matrices, but throughout this chapter we have used the function <em>matrix divide</em> on rectangular matrices.
In the following sections we shall define what are the “left inverse” and the “right inverse” of a given rectangular matrix.</p>
<div class="tip admonition">
<p class="admonition-title">Remark</p>
<p>Under the hood, <em>domino</em> uses Householder transformations, a technique based on the Lawson &amp; Hanson algorithm, an extension of the Golub &amp; Businger algorithm.</p>
</div>
<div class="section" id="left-inverse-of-a-matrix">
<span id="mathematical-functions-left-inverse-of-a-matrix"></span><h4><span class="section-number">13.7.3.1. </span>Left Inverse of a Matrix<a class="headerlink" href="#left-inverse-of-a-matrix" title="Permalink to this headline">#</a></h4>
<p>We have been working in this context:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ys</span></code> was a vector of values we wanted to predict.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coefs</span></code> was a rectangular matrix containing a set of columns containing variables (for example, number of salesmen, size of the area, number of customers, …).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code> contained the coefficients of the least squares line. They should be such that the sum of the squares of the differences between points on this line and the given points in <code class="docutils literal notranslate"><span class="pre">ys</span></code> is minimal.</p></li>
</ul>
<p>In mathematics, three major properties can be demonstrated:</p>
<ul class="simple">
<li><p>The coefficients <code class="docutils literal notranslate"><span class="pre">c</span></code> can be obtained from <code class="docutils literal notranslate"><span class="pre">ys</span></code> by means of a linear regression or, in other words, an <em>inner product</em> involving a matrix <code class="docutils literal notranslate"><span class="pre">inv</span></code>: <code class="docutils literal notranslate"><span class="pre">c</span> <span class="pre">←</span> <span class="pre">inv+.×ys</span></code>.</p></li>
<li><p>This matrix <code class="docutils literal notranslate"><span class="pre">inv</span></code> is unique.</p></li>
<li><p>It can be obtained by the following formula: <code class="docutils literal notranslate"><span class="pre">inv</span> <span class="pre">←</span> <span class="pre">(⌹</span> <span class="pre">(⍉coefs)+.×coefs)+.×⍉coefs</span></code>.</p></li>
</ul>
<p>In this formula, the product <code class="docutils literal notranslate"><span class="pre">(⍉coefs)+.×coefs</span></code> gives a square matrix, even if <code class="docutils literal notranslate"><span class="pre">coefs</span></code> is rectangular.
This is why we can calculate its inverse using the function <em>matrix inverse</em>.
If we refer to the definition of <em>matrix divide</em>, <code class="docutils literal notranslate"><span class="pre">(⌹a)+.×b</span></code> can be written as <code class="docutils literal notranslate"><span class="pre">b⌹a</span></code>.
So, the formula for <code class="docutils literal notranslate"><span class="pre">inv</span></code> can be rewritten as <code class="docutils literal notranslate"><span class="pre">inv</span> <span class="pre">←</span> <span class="pre">(⍉coefs)⌹(⍉coefs)+.×coefs</span></code>.</p>
<p>Let us see what happens if we multiply that formula by <code class="docutils literal notranslate"><span class="pre">coefs</span></code> on the right:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="w">   </span><span class="nv">inv</span><span class="w"> </span><span class="o">≡</span><span class="w"> </span><span class="p">(</span><span class="o">⌹</span><span class="w"> </span><span class="p">(</span><span class="o">⍉</span><span class="nv">coefs</span><span class="p">)</span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="nv">coefs</span><span class="p">)</span><span class="o">+</span><span class="na">.</span><span class="o">×⍉</span><span class="nv">coefs</span><span class="w"> </span><span class="kd">←→</span><span class="w"></span>
<span class="kd">←→</span><span class="w"> </span><span class="nv">inv</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">coefs</span><span class="w"> </span><span class="o">≡</span><span class="w"> </span><span class="p">(</span><span class="o">⌹</span><span class="w"> </span><span class="p">(</span><span class="o">⍉</span><span class="nv">coefs</span><span class="p">)</span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="nv">coefs</span><span class="p">)</span><span class="o">+</span><span class="na">.</span><span class="o">×⍉</span><span class="nv">coefs</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">coefs</span><span class="w"></span>
</pre></div>
</div>
<p>Now, if we define <code class="docutils literal notranslate"><span class="pre">U</span> <span class="pre">←</span> <span class="pre">(⍉coefs)+.×coefs</span></code>, we see that the expression above actually reads</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">inv</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">coefs</span><span class="w"> </span><span class="o">≡</span><span class="w"> </span><span class="p">(</span><span class="o">⌹</span><span class="nv">U</span><span class="p">)</span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="nv">U</span><span class="w"></span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">(⌹U)+.×U</span></code> is the identity matrix, so we actually see that <code class="docutils literal notranslate"><span class="pre">inv</span></code> is a left inverse of <code class="docutils literal notranslate"><span class="pre">coefs</span></code>, because if we multiply <code class="docutils literal notranslate"><span class="pre">coefs</span></code> with <code class="docutils literal notranslate"><span class="pre">inv</span></code> on the left, we get the identity matrix.</p>
<div class="tip admonition">
<p class="admonition-title">Rule</p>
<p>The left inverse of a matrix <code class="docutils literal notranslate"><span class="pre">m</span></code> can be computed with <code class="docutils literal notranslate"><span class="pre">(⌹(⍉m)+.×m)+.×⍉m</span></code>.</p>
</div>
<p>This can be easily verified with the data we used in a previous example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">coefs</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">25  90 430 2400 1
20  50  87 9000 1
24  12  72 9500 1
28  12 210 4100 1
14  30 144 6500 1
 8  30  91 3300 1
31 120 207 9800 1
17  75 161 4900 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">inv</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="p">(</span><span class="o">⌹</span><span class="p">(</span><span class="o">⍉</span><span class="nv">coefs</span><span class="p">)</span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="nv">coefs</span><span class="p">)</span><span class="o">+</span><span class="na">.</span><span class="o">×⍉</span><span class="nv">coefs</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⌊</span><span class="m">0.5</span><span class="o">+</span><span class="nv">inv</span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="nv">coefs</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 0 0 0 0
0 1 0 0 0
0 0 1 0 0
0 0 0 1 0
0 0 0 0 1
</span></div></div>
</div>
<p>Once rounded, we can see it is an identity matrix and <code class="docutils literal notranslate"><span class="pre">inv</span></code> really is a left inverse of <code class="docutils literal notranslate"><span class="pre">coefs</span></code>.</p>
</div>
<div class="section" id="pseudo-right-inverse">
<span id="mathematical-functions-pseudo-right-inverse"></span><h4><span class="section-number">13.7.3.2. </span>Pseudo Right Inverse<a class="headerlink" href="#pseudo-right-inverse" title="Permalink to this headline">#</a></h4>
<p>We just saw that <code class="docutils literal notranslate"><span class="pre">inv</span></code> is a left inverse for <code class="docutils literal notranslate"><span class="pre">coefs</span></code>.
Is it also a right inverse?</p>
<p>We calculated the coefficients in <code class="docutils literal notranslate"><span class="pre">c</span></code> of the least squares line using the formula <code class="docutils literal notranslate"><span class="pre">c←inv+.×ys</span></code>.
Then, we calculated the coordinates of points located on that line with <code class="docutils literal notranslate"><span class="pre">fits</span> <span class="pre">←</span> <span class="pre">coefs+.×c</span></code>.
Let us replace <code class="docutils literal notranslate"><span class="pre">c</span></code> by its definition from the first formula, to get <code class="docutils literal notranslate"><span class="pre">fits</span> <span class="pre">←</span> <span class="pre">coefs+.×inv+.×ys</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">inv</span></code> was a true right inverse of <code class="docutils literal notranslate"><span class="pre">coefs</span></code>, the product <code class="docutils literal notranslate"><span class="pre">coefs+.×inv</span></code> would give the identity matrix and the product <code class="docutils literal notranslate"><span class="pre">coefs+.×inv+.×ys</span></code> would evaluate to <code class="docutils literal notranslate"><span class="pre">ys</span></code>.
However, we know that <code class="docutils literal notranslate"><span class="pre">ys≢fits</span></code> in general, because <code class="docutils literal notranslate"><span class="pre">coefs+.×inv+.×ys</span></code> gives the predicted values on top of the line, whereas <code class="docutils literal notranslate"><span class="pre">ys</span></code> contains the actual values we are trying to fit the line to.
The difference between <code class="docutils literal notranslate"><span class="pre">fits</span></code> and <code class="docutils literal notranslate"><span class="pre">ys</span></code> is such that <code class="docutils literal notranslate"><span class="pre">+/(ys-fits)*2</span></code> is minimised.</p>
<p>In the expression <code class="docutils literal notranslate"><span class="pre">ys-fits</span></code>, let us replace <code class="docutils literal notranslate"><span class="pre">fits</span></code> by <code class="docutils literal notranslate"><span class="pre">coefs+.×inv+.×ys</span></code> and then replace <code class="docutils literal notranslate"><span class="pre">ys</span></code> by <code class="docutils literal notranslate"><span class="pre">I+.×ys</span></code> (<code class="docutils literal notranslate"><span class="pre">I</span></code> is the identity matrix, so this does not change anything) to get <code class="docutils literal notranslate"><span class="pre">(I+.×ys)</span> <span class="pre">-</span> <span class="pre">(coefs+.×inv+.×ys)</span></code>.
Using <code class="docutils literal notranslate"><span class="pre">ys</span></code> as a common factor, this can be rewritten as <code class="docutils literal notranslate"><span class="pre">(I-coefs+.×inv)+.×ys</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">+/(ys-fits)*2</span></code> is minimised, <code class="docutils literal notranslate"><span class="pre">+/((I-coefs+.×inv)+.×ys)*2</span></code> should be minimised too.
This must be true whatever the value of <code class="docutils literal notranslate"><span class="pre">ys</span></code>, including the case where <code class="docutils literal notranslate"><span class="pre">ys</span></code> is 1.
This means that the value of <code class="docutils literal notranslate"><span class="pre">inv</span></code> (calculated independently of <code class="docutils literal notranslate"><span class="pre">ys</span></code>) is such that it minimised the expression <code class="docutils literal notranslate"><span class="pre">+/(I-coefs+.×inv)*2</span></code>.</p>
<p>We can say that <code class="docutils literal notranslate"><span class="pre">inv</span></code> is a pseudo right inverse matrix of <code class="docutils literal notranslate"><span class="pre">coefs</span></code> that minimises <code class="docutils literal notranslate"><span class="pre">+/(I-coefs+.×inv)*2</span></code>.</p>
<p>In APL, <em>matrix inverse</em> has been extended to calculate such a pseudo inverse: <code class="docutils literal notranslate"><span class="pre">inv</span> <span class="pre">←</span> <span class="pre">⌹coefs</span></code>.</p>
</div>
<div class="section" id="summary-of-left-and-right-inverses">
<span id="mathematical-functions-summary-of-left-and-right-inverses"></span><h4><span class="section-number">13.7.3.3. </span>Summary of Left and Right Inverses<a class="headerlink" href="#summary-of-left-and-right-inverses" title="Permalink to this headline">#</a></h4>
<p>In APL, a matrix <code class="docutils literal notranslate"><span class="pre">M</span></code> having more rows than columns has an inverse, which can be obtained by <code class="docutils literal notranslate"><span class="pre">⌹M</span></code>.
This inverse value is strictly equal, within rounding errors, to any of the following formulas:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="w">      </span><span class="nv">inv</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="p">(</span><span class="o">⌹</span><span class="p">(</span><span class="o">⍉</span><span class="nv">M</span><span class="p">)</span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="nv">M</span><span class="p">)</span><span class="o">+</span><span class="na">.</span><span class="o">×⍉</span><span class="nv">M</span><span class="w"></span>
<span class="w">      </span><span class="nv">inv</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="p">(</span><span class="o">⍉</span><span class="nv">M</span><span class="p">)</span><span class="o">⌹</span><span class="p">(</span><span class="o">⍉</span><span class="nv">M</span><span class="p">)</span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="nv">M</span><span class="w"></span>
</pre></div>
</div>
<p>This matrix is a true left inverse of <code class="docutils literal notranslate"><span class="pre">M</span></code>, which means that the product <code class="docutils literal notranslate"><span class="pre">inv</span> <span class="pre">+.×</span> <span class="pre">M</span></code> gives an identity matrix.</p>
<p>This matrix is also a pseudo right inverse of <code class="docutils literal notranslate"><span class="pre">M</span></code>.
That is to say that the product does not give an identity matrix, but a matrix <code class="docutils literal notranslate"><span class="pre">J</span></code> such that the sum <code class="docutils literal notranslate"><span class="pre">+/(I-J)*2</span></code> is minimised.</p>
<p>the result of this is to minimise any expression of the form <code class="docutils literal notranslate"><span class="pre">+/((I-M+.×inv)+.×ys)*2</span></code>, whatever the value of <code class="docutils literal notranslate"><span class="pre">ys</span></code>.</p>
<p>This last property explains why <em>domino</em> may be used to calculate linear, multi-linear, or polynomial regressions.</p>
</div>
<div class="section" id="scalars-and-vectors">
<span id="mathematical-functions-scalars-and-vectors"></span><h4><span class="section-number">13.7.3.4. </span>Scalars and Vectors<a class="headerlink" href="#scalars-and-vectors" title="Permalink to this headline">#</a></h4>
<p>A scalar <code class="docutils literal notranslate"><span class="pre">s</span></code> is treated in such a way that <code class="docutils literal notranslate"><span class="pre">⌹s</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">÷s</span></code> with the exception that <code class="docutils literal notranslate"><span class="pre">0÷0</span></code> is 1 whereas <code class="docutils literal notranslate"><span class="pre">0⌹0</span></code> gives a <code class="docutils literal notranslate"><span class="pre">DOMAIN</span> <span class="pre">ERROR</span></code>.</p>
<p>Vectors are treated like single-column matrices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">cv</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">⌹</span><span class="nv">v</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">¯1</span><span class="w"> </span><span class="m">0.5</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.380952 ¯0.190476 0.0952381
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">cv</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">v</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">v</span><span class="w"> </span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="w"> </span><span class="nv">cv</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
</div>
</div>
<div class="section" id="total-array-ordering">
<span id="mathematical-functions-total-array-ordering"></span><h3><span class="section-number">13.7.4. </span>Total Array Ordering<a class="headerlink" href="#total-array-ordering" title="Permalink to this headline">#</a></h3>
<p>In Dyalog, there is something called <em>total array ordering</em>, used by the functions <em>grade up</em> and <em>down</em> and <em>interval index</em>.
In the earlier days of Dyalog APL, only simple arrays of the same shape and type could be compared.
Thus, by introducing total array ordering, APL can now order simple and nested arrays of any rank, shape, and type.</p>
<p>Total array ordering is very nuanced. For example, all numbers come before characters:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍋</span><span class="m">3</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍋</span><span class="m">234562345243</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍋</span><span class="m">0J1</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2
</span></div></div>
</div>
<p>Complex numbers can also be ordered with other numbers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍋</span><span class="m">¯2J¯1</span><span class="w"> </span><span class="m">¯1J¯3</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0J4</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3 4 5
</span></div></div>
</div>
<p>However, mathematics tells us that there is no “natural ordering” for the complex numbers.
This means that we cannot order the complex numbers in a way that preserves the properties of addition and multiplication that we are used to.</p>
<p>For example, a negative number times a positive number yields a negative number.
Recall that “negative” really means “less than zero” and “positive” means “greater than zero”.
Below, we can see two complex numbers, one less than zero and the other greater than zero:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍋</span><span class="m">¯2J1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1J¯2</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3
</span></div></div>
</div>
<p>The product of the two complex numbers shown above is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1J¯2</span><span class="w"> </span><span class="o">×</span><span class="w"> </span><span class="m">¯2J1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0J5
</span></div></div>
</div>
<p>And the product is greater than zero:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍋</span><span class="m">0</span><span class="w"> </span><span class="m">0J5</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2
</span></div></div>
</div>
<p>We can see that complex numbers are ordered by real part and then by imaginary part:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍋</span><span class="m">¯2J¯100</span><span class="w"> </span><span class="m">¯2</span><span class="w"> </span><span class="m">¯2J1</span><span class="w"> </span><span class="m">0J¯7654321</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0J1</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3 4 5 6 7
</span></div></div>
</div>
<p>Total array ordering also allows the ordering of nested and mixed arrays:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍋</span><span class="w"> </span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="p">(</span><span class="o">⊂⊂⊂</span><span class="m">0J1</span><span class="w"> </span><span class="s1">&#39;0J2&#39;</span><span class="p">)</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="o">,⍳</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;hey&#39;</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;bye&#39;</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="m">3</span><span class="w"> </span><span class="s1">&#39;ciao&#39;</span><span class="p">)))</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───────────────┬─┬───────┬────────────────────────┐
│┌─────────────┐│5│a 1 2 3│┌───┬──────────────────┐│
││┌───────────┐││ │       ││hey│┌───┬─┬─┬────────┐││
│││┌─────────┐│││ │       ││   ││bye│1│2│┌─┬────┐│││
││││┌───┬───┐││││ │       ││   ││   │ │ ││3│ciao││││
│││││0J1│0J2│││││ │       ││   ││   │ │ │└─┴────┘│││
││││└───┴───┘││││ │       ││   │└───┴─┴─┴────────┘││
│││└─────────┘│││ │       │└───┴──────────────────┘│
││└───────────┘││ │       │                        │
│└─────────────┘│ │       │                        │
└───────────────┴─┴───────┴────────────────────────┘
1 2 3 4
</span></div></div>
</div>
<p>In Dyalog APL, the only simple scalars that are considered by the total array ordering are nulls, numbers, and characters.
In other words, total array ordering does not contemplate namespaces, objects, and object representations.</p>
<p>For example, the following usage of <em>grade up</em> fails because of the namespace in the vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍋</span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="nf">⎕NS</span><span class="no">⍬</span><span class="p">)</span><span class="w"> </span><span class="m">4</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DOMAIN ERROR
      ⍋1 2(⎕NS ⍬)4
      ∧
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="applied-maths">
<span id="fig-applied-maths"></span><img alt="_images/Applied_Maths.png" src="_images/Applied_Maths.png" />
<p class="caption"><span class="caption-number">Fig. 13.4 </span><span class="caption-text">A man holding a blue hammer chasing a piggy bank.</span><a class="headerlink" href="#applied-maths" title="Permalink to this image">#</a></p>
</div>
</div>
</div>
<div class="section" id="solutions">
<span id="mathematical-functions-solutions"></span><h2><span class="section-number">13.8. </span>Solutions<a class="headerlink" href="#solutions" title="Permalink to this headline">#</a></h2>
<div class="solution admonition" id="Mathematical-Functions-solution-12">

<p class="admonition-title">Solution to<a class="reference internal" href="#ex-encode"> Exercise 13.1</a></p>
<div class="section" id="solution-content">
</div>
</div>
<p>We know that <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">⊥</span> <span class="pre">12</span> <span class="pre">34</span> <span class="pre">60</span> <span class="pre">77</span> <span class="pre">19</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">n</span> <span class="pre">n</span> <span class="pre">n</span> <span class="pre">n</span> <span class="pre">⊥</span> <span class="pre">12</span> <span class="pre">34</span> <span class="pre">60</span> <span class="pre">77</span> <span class="pre">19</span></code>, whatever the value of <code class="docutils literal notranslate"><span class="pre">n</span></code>.
Furthermore, we saw that the weights used in the conversion are given by the expression <code class="docutils literal notranslate"><span class="pre">⌽1,×\⌽1↓n</span> <span class="pre">n</span> <span class="pre">n</span> <span class="pre">n</span> <span class="pre">n</span></code>.
So, if <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">←</span> <span class="pre">0</span></code>, we get that the weights are</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⌽</span><span class="m">1</span><span class="o">,×</span><span class="na">\</span><span class="o">⌽</span><span class="m">1</span><span class="o">↓</span><span class="m">5</span><span class="o">⍴</span><span class="m">0</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 0 1
</span></div></div>
</div>
<p>This means that the 19 is multiplied by 1 and everything else by 0, so the final result is 19:</p>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span><span class="w"> </span><span class="o">⊥</span><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">34</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">77</span><span class="w"> </span><span class="m">19</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">19
</span></div></div>
</div>
<p>Therefore, <code class="docutils literal notranslate"><span class="pre">0⊥vec</span></code> gives the last element of a numeric vector.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">←</span> <span class="pre">1</span></code>, the weights are</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⌽</span><span class="m">1</span><span class="o">,×</span><span class="na">\</span><span class="o">⌽</span><span class="m">1</span><span class="o">↓</span><span class="m">5</span><span class="o">⍴</span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 1 1 1 1
</span></div></div>
</div>
<p>This means that every number is multiplied by 1, and thus <code class="docutils literal notranslate"><span class="pre">1⊥</span></code> gives the sum of a vector:</p>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="w"> </span><span class="o">⊥</span><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">34</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">77</span><span class="w"> </span><span class="m">19</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">202
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">34</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">77</span><span class="w"> </span><span class="m">19</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">202
</span></div></div>
</div>
<div class="solution admonition" id="Mathematical-Functions-solution-13">

<p class="admonition-title">Solution to<a class="reference internal" href="#ex-hex"> Exercise 13.2</a></p>
<div class="section" id="solution-content">
</div>
</div>
<p>Because we know that hexadecimal values will take up 4 characters only, we can safely do <code class="docutils literal notranslate"><span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16⊤⍵</span></code> to encode a decimal number to base 16:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">D2H</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="s1">&#39;0123456789ABCDEF&#39;</span><span class="sr">[</span><span class="m">1</span><span class="o">+</span><span class="m">16</span><span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="m">16</span><span class="o">⊤</span><span class="bp">⍵</span><span class="sr">]</span><span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">⍪,</span><span class="nv">D2H</span><span class="na">¨</span><span class="p">)</span><span class="w"> </span><span class="m">¯1</span><span class="o">+⍳</span><span class="m">16</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌──┬────┐
│0 │0000│
├──┼────┤
│1 │0001│
├──┼────┤
│2 │0002│
├──┼────┤
│3 │0003│
├──┼────┤
│4 │0004│
├──┼────┤
│5 │0005│
├──┼────┤
│6 │0006│
├──┼────┤
│7 │0007│
├──┼────┤
│8 │0008│
├──┼────┤
│9 │0009│
├──┼────┤
│10│000A│
├──┼────┤
│11│000B│
├──┼────┤
│12│000C│
├──┼────┤
│13│000D│
├──┼────┤
│14│000E│
├──┼────┤
│15│000F│
└──┴────┘
</span></div></div>
</div>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">D2H</span><span class="na">¨</span><span class="w"> </span><span class="m">6748</span><span class="w"> </span><span class="m">49679</span><span class="w"> </span><span class="m">60281</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌────┬────┬────┐
│1A5C│C20F│EB79│
└────┴────┴────┘
</span></div></div>
</div>
<p>If we did not know how long the hexadecimal number would be, we could use <code class="docutils literal notranslate"><span class="pre">16⊥⍣¯1⊢</span></code> instead:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="kt">{</span><span class="s1">&#39;0123456789ABCDEF&#39;</span><span class="sr">[</span><span class="m">1</span><span class="o">+</span><span class="m">16</span><span class="o">⊥</span><span class="na">⍣</span><span class="m">¯1</span><span class="o">⊢</span><span class="bp">⍵</span><span class="sr">]</span><span class="kt">}</span><span class="w"> </span><span class="m">123456789</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">75BCD15
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">H2D</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="m">16</span><span class="o">⊥</span><span class="m">¯1</span><span class="o">+</span><span class="s1">&#39;0123456789ABCDEF&#39;</span><span class="o">⍳</span><span class="bp">⍵</span><span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">H2D</span><span class="na">¨</span><span class="w"> </span><span class="s1">&#39;1A5C&#39;</span><span class="w"> </span><span class="s1">&#39;C20F&#39;</span><span class="w"> </span><span class="s1">&#39;EB79&#39;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6748 49679 60281
</span></div></div>
</div>
<div class="solution admonition" id="Mathematical-Functions-solution-14">

<p class="admonition-title">Solution to<a class="reference internal" href="#ex-sparse-array"> Exercise 13.3</a></p>
<div class="section" id="solution-content">
</div>
</div>
<p>Let us work through the solution with the example of the matrix <code class="docutils literal notranslate"><span class="pre">sa</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">sa</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">7</span><span class="o">⍴</span><span class="m">0</span><span class="w"> </span><span class="p">⋄</span><span class="w"> </span><span class="nv">sa</span><span class="sr">[</span><span class="m">1</span><span class="sr">;</span><span class="m">2</span><span class="sr">]</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="p">⋄</span><span class="w"> </span><span class="nv">sa</span><span class="sr">[</span><span class="m">4</span><span class="sr">;</span><span class="m">1</span><span class="sr">]</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">5.6</span><span class="w"></span>
<span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">sa</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0   3 0 0 0 0 0
0   0 0 0 0 0 0
0   0 0 0 0 0 0
5.6 0 0 0 0 0 0
0   0 0 0 0 0 0
</span></div></div>
</div>
<p>To implement the function <code class="docutils literal notranslate"><span class="pre">Contract</span></code>, we need to find the non-zero values of <code class="docutils literal notranslate"><span class="pre">sa</span></code> and their indices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">sa</span><span class="sr">[</span><span class="nv">idx</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">⍸</span><span class="m">0</span><span class="o">≠</span><span class="nv">sa</span><span class="sr">]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 5.6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">idx</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───┬───┐
│1 2│4 1│
└───┴───┘
</span></div></div>
</div>
<p>Now, we need to decode these multidimensional indices into the one-dimensional indices of the ravel, which we can do with the function <em>decode</em> and the shape of the array (<code class="docutils literal notranslate"><span class="pre">sa</span></code>, in our example).
However, indexing is 1-based and <em>encode</em> and <em>decode</em> start counting from 0, so we need to subtract 1 from the indices in the beginning and add 1 at the end:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="o">+</span><span class="p">(</span><span class="o">⍴</span><span class="nv">sa</span><span class="p">)</span><span class="o">⊥</span><span class="m">¯1</span><span class="o">+⍉↑</span><span class="nv">idx</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 22
</span></div></div>
</div>
<p>We can verify these indices are correct:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">,</span><span class="nv">sa</span><span class="p">)</span><span class="sr">[</span><span class="m">2</span><span class="w"> </span><span class="m">22</span><span class="sr">]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 5.6
</span></div></div>
</div>
<p>Now, we can put <code class="docutils literal notranslate"><span class="pre">Contract</span></code> together:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span><span class="w"></span>
<span class="nv">Contract</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="w"></span>
<span class="w">    </span><span class="nv">flat</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">1</span><span class="o">+</span><span class="p">(</span><span class="o">⍴</span><span class="bp">⍵</span><span class="p">)</span><span class="o">⊥</span><span class="m">¯1</span><span class="o">+⍉↑</span><span class="nv">idx</span><span class="kd">←</span><span class="o">⍸</span><span class="m">0</span><span class="o">≠</span><span class="bp">⍵</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="o">≢⍴</span><span class="bp">⍵</span><span class="p">)</span><span class="o">,</span><span class="p">(</span><span class="o">⍴</span><span class="bp">⍵</span><span class="p">)</span><span class="o">,</span><span class="bp">⍵</span><span class="sr">[</span><span class="nv">idx</span><span class="sr">]</span><span class="o">,</span><span class="nv">flat</span><span class="w"></span>
<span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">compressed</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">Contract</span><span class="w"> </span><span class="nv">sa</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 5 7 3 5.6 2 22
</span></div></div>
</div>
<p>To implement <code class="docutils literal notranslate"><span class="pre">Expand</span></code>, we work in the other direction.
We start by finding the rank and the shape of the original sparse array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">rank</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">⊃</span><span class="nv">compressed</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">shape</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">rank</span><span class="o">↑</span><span class="m">1</span><span class="o">↓</span><span class="nv">compressed</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 7
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">rest</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">compressed</span><span class="o">↓</span><span class="na">⍨</span><span class="m">1</span><span class="o">+</span><span class="nv">rank</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 5.6 2 22
</span></div></div>
</div>
<p>Now, we need to split the remainder into the values and the indices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">values</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">rest</span><span class="o">↑</span><span class="na">⍨</span><span class="m">0.5</span><span class="o">×≢</span><span class="nv">rest</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 5.6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="nv">idx</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">rest</span><span class="o">↓</span><span class="na">⍨</span><span class="m">0.5</span><span class="o">×≢</span><span class="nv">rest</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 22
</span></div></div>
</div>
<p>Now, we use <em>encode</em> and the shape of the array to transform the linear indices into the multidimensional ones:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">↓⍉</span><span class="m">1</span><span class="o">+</span><span class="nv">shape</span><span class="o">⊤</span><span class="m">¯1</span><span class="o">+</span><span class="nv">idx</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───┬───┐
│1 2│4 1│
└───┴───┘
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span><span class="w"></span>
<span class="nv">Expand</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="w"></span>
<span class="w">    </span><span class="nv">shape</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="p">(</span><span class="o">⊃</span><span class="bp">⍵</span><span class="p">)</span><span class="o">↑</span><span class="m">1</span><span class="o">↓</span><span class="bp">⍵</span><span class="w"></span>
<span class="w">    </span><span class="nv">rest</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="bp">⍵</span><span class="o">↓</span><span class="na">⍨</span><span class="m">1</span><span class="o">+⊃</span><span class="bp">⍵</span><span class="w"></span>
<span class="w">    </span><span class="nv">values</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">rest</span><span class="o">↑</span><span class="na">⍨</span><span class="m">0.5</span><span class="o">×≢</span><span class="nv">rest</span><span class="w"></span>
<span class="w">    </span><span class="nv">idx</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">rest</span><span class="o">↓</span><span class="na">⍨</span><span class="m">0.5</span><span class="o">×≢</span><span class="nv">rest</span><span class="w"></span>
<span class="w">    </span><span class="nv">arr</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">shape</span><span class="o">⍴</span><span class="m">0</span><span class="w"></span>
<span class="w">    </span><span class="nv">arr</span><span class="sr">[</span><span class="o">↓⍉</span><span class="m">1</span><span class="o">+</span><span class="nv">shape</span><span class="o">⊤</span><span class="m">¯1</span><span class="o">+</span><span class="nv">idx</span><span class="sr">]</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">values</span><span class="w"></span>
<span class="w">    </span><span class="nv">arr</span><span class="w"></span>
<span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">Expand</span><span class="w"> </span><span class="nv">compressed</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0   3 0 0 0 0 0
0   0 0 0 0 0 0
0   0 0 0 0 0 0
5.6 0 0 0 0 0 0
0   0 0 0 0 0 0
</span></div></div>
</div>
<p>As another example, here is a cuboid with five non-zero elements:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">cuboid</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">21</span><span class="o">⍴</span><span class="m">0</span><span class="w"></span>
<span class="nv">cuboid</span><span class="sr">[</span><span class="p">(</span><span class="o">,⍳⍴</span><span class="nv">cuboid</span><span class="p">)</span><span class="sr">[</span><span class="m">5</span><span class="o">?×</span><span class="na">/</span><span class="o">⍴</span><span class="nv">cuboid</span><span class="sr">]]</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">⍳</span><span class="m">5</span><span class="w"></span>
<span class="nv">cuboid</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 5 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 3 0 0 0 0 0 0 0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">cuboid</span><span class="w"> </span><span class="o">≡</span><span class="w"> </span><span class="nv">Expand</span><span class="w"> </span><span class="nv">Contract</span><span class="w"> </span><span class="nv">cuboid</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="solution admonition" id="Mathematical-Functions-solution-15">

<p class="admonition-title">Solution to<a class="reference internal" href="#ex-random"> Exercise 13.4</a></p>
<div class="section" id="solution-content">
</div>
</div>
<ul class="simple">
<li><p>a vector of 12 values between 8 and 30, without duplicates:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">7</span><span class="o">+</span><span class="m">12</span><span class="o">?</span><span class="m">23</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">21 13 30 29 23 20 28 18 11 25 24 16
</span></div></div>
</div>
<ul class="simple">
<li><p>a 4 by 6 matrix filled with values between 37 and 47, with possible duplicates:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">36</span><span class="o">+?</span><span class="m">4</span><span class="w"> </span><span class="m">6</span><span class="o">⍴</span><span class="m">11</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">39 41 44 38 42 45
47 39 39 40 44 37
44 45 47 43 40 38
43 46 46 47 46 40
</span></div></div>
</div>
<ul class="simple">
<li><p>a 5 by 2 matrix filled with values between ¯5 and 5, without duplicates:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">¯6</span><span class="o">+</span><span class="m">5</span><span class="w"> </span><span class="m">2</span><span class="o">⍴</span><span class="m">10</span><span class="o">?</span><span class="m">11</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯5 ¯3
¯4  0
¯1  4
 2 ¯2
 1  5
</span></div></div>
</div>
<div class="solution admonition" id="Mathematical-Functions-solution-16">

<p class="admonition-title">Solution to<a class="reference internal" href="#ex-random-decimals"> Exercise 13.5</a></p>
<div class="section" id="solution-content">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0.0001</span><span class="o">×</span><span class="m">99</span><span class="o">+?</span><span class="m">15</span><span class="o">⍴</span><span class="m">801</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.0696 0.0865 0.0869 0.0793 0.0118 0.0389 0.0599 0.0475 0.0221 0.0706 0.0165 0.0444 0.0628 0.0359 0.0278
</span></div></div>
</div>
<div class="solution admonition" id="Mathematical-Functions-solution-17">

<p class="admonition-title">Solution to<a class="reference internal" href="#ex-read-random"> Exercise 13.6</a></p>
<div class="section" id="solution-content">
</div>
</div>
<p>The expression starts with <code class="docutils literal notranslate"><span class="pre">(10+?10)⍴10</span></code> which will create a vector filled with 10, with a random length between 11 and 20.
Then, the final <code class="docutils literal notranslate"><span class="pre">10+?...</span></code> will generate random integers between 1 and 10 and add 10 to those, so the final result is a vector of a random length between 11 and 20 with random elements between 11 and 20.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">10</span><span class="o">+?</span><span class="p">(</span><span class="m">10</span><span class="o">+?</span><span class="m">10</span><span class="p">)</span><span class="o">⍴</span><span class="m">10</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">20 11 13 18 16 15 11 14 18 17 15 11
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">10</span><span class="o">+?</span><span class="p">(</span><span class="m">10</span><span class="o">+?</span><span class="m">10</span><span class="p">)</span><span class="o">⍴</span><span class="m">10</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">15 17 16 12 16 17 11 13 13 20 19 15 16 13 12 18 17
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">10</span><span class="o">+?</span><span class="p">(</span><span class="m">10</span><span class="o">+?</span><span class="m">10</span><span class="p">)</span><span class="o">⍴</span><span class="m">10</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">18 12 14 15 18 19 18 11 18 16 19 18 19 14 13 15 17 19 12 13
</span></div></div>
</div>
<div class="solution admonition" id="Mathematical-Functions-solution-18">

<p class="admonition-title">Solution to<a class="reference internal" href="#ex-random-choose"> Exercise 13.7</a></p>
<div class="section" id="solution-content">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">list</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">29</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">44</span><span class="w"> </span><span class="m">31</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">86</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">list</span><span class="sr">[</span><span class="m">5</span><span class="o">?⍴</span><span class="nv">list</span><span class="sr">]</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">31 5 86 29 44
</span></div></div>
</div>
<div class="solution admonition" id="Mathematical-Functions-solution-19">

<p class="admonition-title">Solution to<a class="reference internal" href="#ex-random-length"> Exercise 13.8</a></p>
<div class="section" id="solution-content">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span><span class="o">+?</span><span class="p">(</span><span class="m">5</span><span class="o">+?</span><span class="m">11</span><span class="p">)</span><span class="o">⍴</span><span class="m">38</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6 32 18 34 5 34 8 16 9 39 24 27
</span></div></div>
</div>
<div class="solution admonition" id="Mathematical-Functions-solution-20">

<p class="admonition-title">Solution to<a class="reference internal" href="#ex-cos-approximation"> Exercise 13.9</a></p>
<div class="section" id="solution-content">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">Cos</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="p">(</span><span class="bp">⍵</span><span class="o">*</span><span class="nv">p</span><span class="p">)</span><span class="o">-</span><span class="na">.</span><span class="o">÷!</span><span class="nv">p</span><span class="kd">←</span><span class="m">2</span><span class="o">×</span><span class="m">0</span><span class="o">,⍳</span><span class="bp">⍺</span><span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span><span class="o">○○</span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">10</span><span class="w"> </span><span class="nv">Cos</span><span class="w"> </span><span class="o">○</span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯1
</span></div></div>
</div>
<div class="solution admonition" id="Mathematical-Functions-solution-21">

<p class="admonition-title">Solution to<a class="reference internal" href="#ex-circle"> Exercise 13.10</a></p>
<div class="section" id="solution-content">
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(1○○÷4)*2</span></code>:</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(\sin \pi/4 = \sqrt{\frac12}\)</span>, thus the square of that is 0.5:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">1</span><span class="o">○○÷</span><span class="m">4</span><span class="p">)</span><span class="o">*</span><span class="m">2</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.5
</span></div></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">2×0.5+¯2○1○0.5</span></code>:</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">¯2○1○0.5</span></code> is <span class="math notranslate nohighlight">\(\arccos(\sin \frac12)\)</span>, which is <span class="math notranslate nohighlight">\(\frac\pi2 - \frac12\)</span>, so the whole expression evaluates to <span class="math notranslate nohighlight">\(\pi\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span><span class="o">×</span><span class="m">0.5</span><span class="o">+</span><span class="m">¯2</span><span class="o">○</span><span class="m">1</span><span class="o">○</span><span class="m">0.5</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3.14159
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">○</span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3.14159
</span></div></div>
</div>
<div class="solution admonition" id="Mathematical-Functions-solution-22">

<p class="admonition-title">Solution to<a class="reference internal" href="#ex-solve-linear-eqs"> Exercise 13.11</a></p>
<div class="section" id="solution-content">
</div>
</div>
<p>We can solve this set of linear equations with the function <em>matrix divide</em>.
We just need to be careful when writing the matrix of coefficients.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">5</span><span class="w"> </span><span class="m">¯7</span><span class="w"> </span><span class="m">2</span><span class="o">⌹</span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="o">⍴</span><span class="m">1</span><span class="w"> </span><span class="m">¯1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">¯2</span><span class="w"> </span><span class="m">¯1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯2 ¯7 0
</span></div></div>
</div>
<div class="solution admonition" id="Mathematical-Functions-solution-23">

<p class="admonition-title">Solution to<a class="reference internal" href="#ex-linear-eqs-compute"> Exercise 13.12</a></p>
<div class="section" id="solution-content">
</div>
</div>
<p>To compute the value of <span class="math notranslate nohighlight">\(3a + 5b - c\)</span>, the easiest thing to do is to start by finding the values of <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, and <span class="math notranslate nohighlight">\(c\)</span>, which we can do by solving the set of linear equations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="kd">←</span><span class="w"> </span><span class="p">(</span><span class="nv">a</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="nv">c</span><span class="p">)</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">abc</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">¯6</span><span class="w"> </span><span class="m">10</span><span class="o">⌹</span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="o">⍴</span><span class="m">1</span><span class="w"> </span><span class="m">¯1</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">¯2</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">¯2</span><span class="w"> </span><span class="m">2</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 ¯0.5 3.5
</span></div></div>
</div>
<p>Finally, we can compute the value of that expression in a couple of ways:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">3</span><span class="o">×</span><span class="nv">a</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="m">5</span><span class="o">×</span><span class="nv">b</span><span class="p">)</span><span class="o">-</span><span class="nv">c</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">abc</span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="m">3</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">¯1</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<p>We could have done this computation directly:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">¯1</span><span class="o">+</span><span class="na">.</span><span class="o">×</span><span class="m">13</span><span class="w"> </span><span class="m">¯6</span><span class="w"> </span><span class="m">10</span><span class="o">⌹</span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="o">⍴</span><span class="m">1</span><span class="w"> </span><span class="m">¯1</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">¯2</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">¯2</span><span class="w"> </span><span class="m">2</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "dyalog-kernel"
        },
        kernelOptions: {
            kernelName: "dyalog-kernel",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'dyalog-kernel'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Tacit-Programming.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">12. </span>Tacit Programming</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Appendices.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">14. </span>Appendices</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Bernard Legrand, reworked by Rodrigo Girão Serrão.<br/>
  
    <div class="extra_footer">
      <p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" />
</a></p>
<p>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p>

    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>