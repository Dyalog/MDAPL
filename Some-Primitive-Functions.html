
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>4. Some Primitive Functions &#8212; Mastering Dyalog APL</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5. User Defined Functions" href="User-Defined-Functions.html" />
    <link rel="prev" title="3. Data and Variables" href="Data-and-Variables.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">Mastering Dyalog APL</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Introduction.html">
   1. Introduction - Will You Play APL With Me?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Getting-Started.html">
   2. Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Data-and-Variables.html">
   3. Data and Variables
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4. Some Primitive Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="User-Defined-Functions.html">
   5. User Defined Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Appendices.html">
   6. Appendices
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Some-Primitive-Functions.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/RojerGS/MDAPL"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        <a class="edit-button" href="https://github.com/RojerGS/MDAPL/edit/master/Some-Primitive-Functions.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definitions">
   4.1. Definitions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#some-scalar-dyadic-functions">
   4.2. Some Scalar Dyadic Functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#definition-and-examples">
     4.2.1. Definition and Examples
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#division-by-zero">
     4.2.2. Division By Zero
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#power">
     4.2.3. Power
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#maximum-minimum">
     4.2.4. Maximum &amp; Minimum
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#relationship">
     4.2.5. Relationship
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#residue">
     4.2.6. Residue
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#array-comparison">
     4.2.7. Array Comparison
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#order-of-evaluation">
   4.3. Order of Evaluation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#monadic-scalar-functions">
   4.4. Monadic Scalar Functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-four-basic-symbols">
     4.4.1. The Four Basic Symbols
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#conjugate">
       4.4.1.1. Conjugate
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#negate">
       4.4.1.2. Negate
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#direction">
       4.4.1.3. Direction
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#reciprocal">
       4.4.1.4. Reciprocal
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-scalar-monadic-functions">
     4.4.2. Other Scalar Monadic Functions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#magnitude-absolute-value">
       4.4.2.1. Magnitude (Absolute Value)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exponential">
       4.4.2.2. Exponential
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#floor-and-ceiling">
       4.4.2.3. Floor and Ceiling
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#left-and-right-tacks">
   4.5. Left and Right Tacks
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#same">
     4.5.1. Same
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dyadic-usage">
     4.5.2. Dyadic Usage
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#processing-binary-data">
   4.6. Processing Binary Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#membership">
     4.6.1. Membership
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#binary-algebra">
     4.6.2. Binary Algebra
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#without">
     4.6.3. Without
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#processing-nested-arrays">
   4.7. Processing Nested Arrays
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scalar-vs-non-scalar-functions">
     4.7.1. Scalar vs. Non-scalar Functions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#be-careful-with-shape-type-compatibility">
     4.7.2. Be Careful With Shape/Type Compatibility
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tally">
     4.7.3. Tally
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#depth">
     4.7.4. Depth
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reduce">
   4.8. Reduce
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#presentation">
     4.8.1. Presentation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#definition">
     4.8.2. Definition
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reduction-of-binary-data">
     4.8.3. Reduction of Binary Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reduction-of-nested-arrays">
     4.8.4. Reduction of Nested Arrays
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reduction-with-noncommutative-functions">
     4.8.5. Reduction With Noncommutative Functions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#application-1">
     4.8.6. Application 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#application-2">
     4.8.7. Application 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#axis-specification">
   4.9. Axis Specification
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#totals-in-an-array">
     4.9.1. Totals in an Array
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#processing-arrays">
       4.9.1.1. Processing Arrays
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#axis-is-like-an-operator">
       4.9.1.2. Axis Is Like an Operator
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       4.9.1.3. Processing Arrays
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-shape-of-the-result">
     4.9.2. The Shape of the Result
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#special-notations">
     4.9.3. Special Notations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#our-first-program">
   4.10. Our First Program
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#concatenate">
   4.11. Concatenate
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#concatenating-vectors">
     4.11.1. Concatenating Vectors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#concatenating-other-arrays">
     4.11.2. Concatenating Other Arrays
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#concatenating-scalars">
     4.11.3. Concatenating Scalars
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#special-cases-and-notations">
     4.11.4. Special Cases and Notations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dyalog-idioms-and-idiomatic-phrases">
     4.11.5. Dyalog Idioms and Idiomatic Phrases
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#replicate">
   4.12. Replicate
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basic-approach-compress">
     4.12.1. Basic Approach: Compress
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-case-replicate">
     4.12.2. General Case: Replicate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scalar-left-argument">
     4.12.3. Scalar Left Argument
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     4.12.4. Special Notations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#position-index-of">
   4.13. Position (Index Of)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#discovery">
     4.13.1. Discovery
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#application-3">
     4.13.2. Application 3
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#changing-the-frame-of-reference">
       4.13.2.1. Changing The Frame of Reference
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-case">
     4.13.3. General Case
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#where">
   4.14. Where
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#application-4">
     4.14.1. Application 4
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#increasing-the-dimension">
     4.14.2. Increasing The Dimension
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simple-not-nested">
     4.14.3. Simple, Not Nested
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#beyond-boolean-arrays">
     4.14.4. Beyond Boolean Arrays
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#comparison-of-membership-index-of-and-where">
     4.14.5. Comparison of
     <em>
      Membership
     </em>
     ,
     <em>
      Index Of
     </em>
     and
     <em>
      Where
     </em>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example">
       4.14.5.1. Example
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#first-question">
       4.14.5.2. First Question
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#second-question">
       4.14.5.3. Second Question
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#comparison">
       4.14.5.4. Comparison
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#index-generator">
   4.15. Index Generator
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basic-usage">
     4.15.1. Basic Usage
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#application-5">
     4.15.2. Application 5
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#unique">
       4.15.2.1. Unique
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#application-6">
     4.15.3. Application 6
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ravel">
   4.16. Ravel
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#empty-vectors-and-black-holes">
   4.17. Empty Vectors and Black Holes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#not-all-empty-vectors-are-created-equal">
     4.17.1. Not All Empty Vectors Are Created Equal
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   4.18. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-specialist-s-section">
   4.19. The Specialist’s Section
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#division-control-div-and-other-mathematical-subtleties">
     4.19.1. Division Control - ⎕DIV and Other Mathematical Subtleties
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#zero-divided-by-zero">
       4.19.1.1. Zero Divided by Zero
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#zero-to-the-power-of-zero">
       4.19.1.2. Zero To The Power of Zero
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#derived-functions">
     4.19.2. Derived Functions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nor-nand">
     4.19.3. Nor &amp; Nand
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#index-generator-of-arrays">
     4.19.4. Index Generator of Arrays
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ravel-with-axis">
     4.19.5. Ravel With Axis
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#empty-axis">
       4.19.5.1. Empty Axis
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fractional-axis">
     4.19.6. Fractional Axis
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-list-of-dimensions">
     4.19.7. A List of Dimensions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#border-cases">
     4.19.8. Border Cases
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solutions">
   4.20. Solutions
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="some-primitive-functions">
<span id="some-primitive-functions-some-primitive-functions"></span><h1><span class="section-number">4. </span>Some Primitive Functions<a class="headerlink" href="#some-primitive-functions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="definitions">
<span id="some-primitive-functions-definitions"></span><h2><span class="section-number">4.1. </span>Definitions<a class="headerlink" href="#definitions" title="Permalink to this headline">¶</a></h2>
<p>In APL data is processed using what we call <em>functions</em>. It is important to distinguish between two types of functions:</p>
<ol class="simple">
<li><p><em><strong>Primitive Functions</strong></em>:</p>
<ul class="simple">
<li><p>they are part of the APL language;</p></li>
<li><p>they are represented by symbols like <code class="docutils literal notranslate"><span class="pre">⍴</span></code>, <code class="docutils literal notranslate"><span class="pre">⍉</span></code> and <code class="docutils literal notranslate"><span class="pre">⌈</span></code>;</p></li>
<li><p>they cannot be overwritten or removed.</p></li>
</ul>
</li>
<li><p><em><strong>User-Defined Functions</strong></em>:</p>
<ul class="simple">
<li><p>as their name implies, they are written by the user;</p></li>
<li><p>they are represented by names, for example <code class="docutils literal notranslate"><span class="pre">Average</span></code> or <code class="docutils literal notranslate"><span class="pre">budget</span></code>;</p></li>
<li><p>they can be overwritten and removed.</p></li>
</ul>
</li>
</ol>
<p>APL has a very rich set of primitive functions. In this chapter, we will explore just a few of them; many others will follow in subsequent chapters.</p>
<p>In the introduction to this book, we mentioned that in traditional mathematics, some symbols can be used with a single argument or two arguments. For example, in the expression <span class="math notranslate nohighlight">\(a = x \color{red}{-} y\)</span> the minus sign means subtract. Whereas in <span class="math notranslate nohighlight">\(a = \color{red}{-}y\)</span> the minus sign indicates the negation of <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>The first form is called the “<strong><em>dyadic</em></strong>” use of the symbol.
The second form is called the “<strong><em>monadic</em></strong>” use of the symbol.</p>
<p>It is the same in APL, where most of the symbols (functions) have a <em>monadic</em> and a <em>dyadic</em> meaning. For example, here <code class="docutils literal notranslate"><span class="pre">⍴</span></code> obtains the shape of the <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">2</span> <span class="pre">3</span> <span class="pre">4</span></code> vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4
</span></div></div>
</div>
<p>Whereas in here <code class="docutils literal notranslate"><span class="pre">⍴</span></code> changes the shape of the <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">2</span> <span class="pre">3</span> <span class="pre">4</span></code> vector to <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">2</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span> <span class="m">2</span> <span class="o">⍴</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2
3 4
</span></div></div>
</div>
<p>There is, however, a major difference. In traditional mathematics, the symbol representing a monadic function is sometimes placed before its argument (as the <span class="math notranslate nohighlight">\(-\)</span> in <span class="math notranslate nohighlight">\(a = \color{red}{-}y\)</span>), sometimes after it (as the <span class="math notranslate nohighlight">\(!\)</span> in <span class="math notranslate nohighlight">\(a = y\color{red}{!}\)</span>), sometimes on both sides (as the <span class="math notranslate nohighlight">\(|\cdot|\)</span> in <span class="math notranslate nohighlight">\(a = \color{red}|y\color{red}|\)</span>), and some other conventions may be found.</p>
<p>In APL, the symbol representing a monadic function is <strong>always</strong> placed before its argument, as the <code class="docutils literal notranslate"><span class="pre">⍴</span></code> in <code class="docutils literal notranslate"><span class="pre">⍴var</span></code>.</p>
</div>
<div class="section" id="some-scalar-dyadic-functions">
<span id="some-primitive-functions-some-scalar-dyadic-functions"></span><h2><span class="section-number">4.2. </span>Some Scalar Dyadic Functions<a class="headerlink" href="#some-scalar-dyadic-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="definition-and-examples">
<span id="some-primitive-functions-definition-and-examples"></span><h3><span class="section-number">4.2.1. </span>Definition and Examples<a class="headerlink" href="#definition-and-examples" title="Permalink to this headline">¶</a></h3>
<p><em><strong>Scalar dyadic functions</strong></em> are primitive functions which have the following properties:</p>
<ul class="simple">
<li><p>they are <em>dyadic</em> (require an argument on both sides);</p></li>
<li><p>they work item by item (scalar by scalar);</p></li>
<li><p>they can work on two arrays of the same shape, in which case the result also has the same shape;</p></li>
<li><p>they can work on one array of any shape, and a single value (a <em><strong>scalar</strong></em> or any one-item array), in which case the result has the same shape as the non-singleton array.</p></li>
</ul>
<p>The four basic arithmetic functions, <em><strong>Addition</strong></em>, <em><strong>Subtraction</strong></em>, <em><strong>Multiplication</strong></em> and <em><strong>Division</strong></em> are scalar dyadic functions. They apply themselves between each item of the left argument and the corresponding item of the right argument, like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">5</span> <span class="m">3</span> <span class="m">2</span> <span class="m">9</span> <span class="o">+</span> <span class="m">2</span> <span class="m">6</span> <span class="m">8</span> <span class="m">4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">7 9 10 13
</span></div></div>
</div>
<p>The function is applied between each item of two 4-item vectors. The result is also a 4-item vector.</p>
<p>As an example of a function that is <em>not</em> a scalar function, let us look at the <em><strong>Reshape</strong></em> function. There is nothing in common between the shapes of its arguments:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span> <span class="m">3</span> <span class="o">⍴</span> <span class="m">6</span> <span class="m">8</span> <span class="m">2</span> <span class="m">1</span> <span class="m">9</span> <span class="m">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6 8 2
1 9 3
</span></div></div>
</div>
<p>In fact, the left argument has 2 items, the right one has 6 and the result in this case is a matrix.</p>
<p>Let us explore the behaviour of the basic arithmetic functions on vectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">5</span> <span class="m">3</span> <span class="m">2</span> <span class="m">9</span> <span class="o">-</span> <span class="m">2</span> <span class="m">6</span> <span class="m">8</span> <span class="m">4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 ¯3 ¯6 5
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">5</span> <span class="m">3</span> <span class="m">2</span> <span class="m">9</span> <span class="o">÷</span> <span class="m">2</span> <span class="m">6</span> <span class="m">4</span> <span class="m">7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2.5 0.5 0.5 1.28571
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">price</span> <span class="kd">←</span> <span class="m">5.2</span> <span class="m">11.5</span> <span class="m">3.6</span> <span class="m">4</span> <span class="m">8.45</span>
<span class="nv">qty</span> <span class="kd">←</span> <span class="m">2</span> <span class="m">1</span> <span class="m">3</span> <span class="m">6</span> <span class="m">2</span>
<span class="nv">costs</span> <span class="kd">←</span> <span class="nv">price</span> <span class="o">×</span> <span class="nv">qty</span>
<span class="nv">costs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">10.4 11.5 10.8 24 16.9
</span></div></div>
</div>
<p>Scalar dyadic functions apply to arrays of any rank and shape.</p>
<p>As we saw in the introduction, a Sales Director makes forecasts for sales of 4 products over the coming 6 months, and assigns them to the variable <code class="docutils literal notranslate"><span class="pre">forecast</span></code>. At the end of the 6 months, they record the actual values in the variable <code class="docutils literal notranslate"><span class="pre">actual</span></code>. Here they are:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕RL</span> <span class="kd">←</span> <span class="m">73</span>
<span class="nv">forecast</span> <span class="kd">←</span> <span class="m">10</span><span class="o">×?</span><span class="m">4</span> <span class="m">6</span><span class="o">⍴</span><span class="m">55</span>
<span class="nv">forecast</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 90 160 420 500  20  30
110 450 170 370 290 360
340 190 320 120 510 370
150 460 240 520 490 280
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕RL</span> <span class="kd">←</span> <span class="m">73</span>
<span class="nv">actual</span> <span class="kd">←</span> <span class="nv">forecast</span> <span class="o">+</span> <span class="m">¯10</span><span class="o">+?</span><span class="m">4</span> <span class="m">6</span><span class="o">⍴</span><span class="m">20</span>
<span class="nv">actual</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 89 166 420 508  12  23
111 453 177 365 284 352
349 192 329 115 515 374
160 467 234 519 485 283
</span></div></div>
</div>
<div class="tip admonition">
<p class="admonition-title">Remark</p>
<p>We initialise the <code class="docutils literal notranslate"><span class="pre">forecast</span></code> and <code class="docutils literal notranslate"><span class="pre">actual</span></code> variables with some random values by the use of the <em><strong>Roll</strong></em> function <code class="docutils literal notranslate"><span class="pre">?</span></code>. Notice this assignment is easier to type than some predefined set of values and we can use <code class="docutils literal notranslate"><span class="pre">⎕RL</span></code> to always get the same result. You can learn more about <code class="docutils literal notranslate"><span class="pre">?</span></code> and <code class="docutils literal notranslate"><span class="pre">⎕RL</span></code> later on in the book.</p>
</div>
<p>The first thing any self-respecting Sales Director will want to know is the difference between the expected and the actual results. This can be done easily by typing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">actual</span> <span class="o">-</span> <span class="nv">forecast</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯1 6  0  8 ¯8 ¯7
 1 3  7 ¯5 ¯6 ¯8
 9 2  9 ¯5  5  4
10 7 ¯6 ¯1 ¯5  3
</span></div></div>
</div>
<p>Notice how subtracting two matrices gives a matrix of the same shape (recall that negative values are indicated by a high minus sign).</p>
<p>But remember, a scalar dyadic function may also be applied between a single value and an array of any shape.</p>
<p>For example, if we want to multiply <code class="docutils literal notranslate"><span class="pre">forecast</span></code> by 2, we can type:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">forecast</span> <span class="o">×</span> <span class="m">2</span>        <span class="c1">⍝ same as 2 × forecast</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">180 320 840 1000   40  60
220 900 340  740  580 720
680 380 640  240 1020 740
300 920 480 1040  980 560
</span></div></div>
</div>
<p>A complete list of <em><strong>Scalar Dyadic Functions</strong></em> is given in <a class="reference internal" href="Appendices.html#appendices-scalar-functions"><span class="std std-numref">Section 6.1</span></a>.</p>
</div>
<div class="section" id="division-by-zero">
<span id="some-primitive-functions-division-by-zero"></span><h3><span class="section-number">4.2.2. </span>Division By Zero<a class="headerlink" href="#division-by-zero" title="Permalink to this headline">¶</a></h3>
<p>An expression such as <code class="docutils literal notranslate"><span class="pre">17÷0</span></code> leads to an error message:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">17</span><span class="o">÷</span><span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DOMAIN ERROR: Divide by zero
      17÷0
        ∧
</pre></div>
</div>
</div>
</div>
<p>This happens because zero does not belong to the domain of valid denominators.</p>
<p>However, notice what <code class="docutils literal notranslate"><span class="pre">0÷0</span></code> returns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span><span class="o">÷</span><span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>Despite being mathematically incorrect, the default behaviour gives the result 1, as given by the extension of the rule that “any number divided by itself should give 1”. Nevertheless, because this is sometimes inappropriate, it is possible to change the default behaviour (see <a class="reference internal" href="#some-primitive-functions-division-control-div-and-other-mathematical-subtleties"><span class="std std-numref">Section 4.19.1</span></a>).</p>
</div>
<div class="section" id="power">
<span id="some-primitive-functions-power"></span><h3><span class="section-number">4.2.3. </span>Power<a class="headerlink" href="#power" title="Permalink to this headline">¶</a></h3>
<p>In APL, the mathematical notation <span class="math notranslate nohighlight">\(A^n\)</span> is written <code class="docutils literal notranslate"><span class="pre">A*n</span></code>.</p>
<p>The function <em>Power</em> (<code class="docutils literal notranslate"><span class="pre">*</span></code>) accepts any value(s) for <code class="docutils literal notranslate"><span class="pre">n</span></code>: integer or decimal, positive, negative, or zero, according to traditional usage.</p>
<p>To calculate the values of: <span class="math notranslate nohighlight">\(4^2\)</span>, <span class="math notranslate nohighlight">\(4^{1.4}\)</span>, <span class="math notranslate nohighlight">\(4^0\)</span>, <span class="math notranslate nohighlight">\(\sqrt 4\)</span>, <span class="math notranslate nohighlight">\(4^{-2.1}\)</span>, <span class="math notranslate nohighlight">\(4^5\)</span> we just need to type</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">4</span> <span class="o">*</span> <span class="m">2</span> <span class="m">1.4</span> <span class="m">0</span> <span class="m">0.5</span> <span class="m">¯1</span> <span class="m">¯2.1</span> <span class="m">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">16 6.9644 1 2 0.25 0.0544094 1024
</span></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">0*0</span></code> gives <code class="docutils literal notranslate"><span class="pre">1</span></code>, which is also not mathematically correct but a fairly useful convention to take.</p>
<p>There is no special symbol in APL to represent a square root; it is obtained by raising a value to the power <span class="math notranslate nohighlight">\(\frac12\)</span>. If we take the square root of a negative number, then we get a complex number as a result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">¯1</span> <span class="o">*</span> <span class="m">0.5</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0J1
</span></div></div>
</div>
<p>The subject of “complex numbers” pertains to mathematics, but Dyalog APL has some nice features related to complex numbers and so we will dive deeper into them later on.</p>
</div>
<div class="section" id="maximum-minimum">
<span id="some-primitive-functions-maximum-minimum"></span><h3><span class="section-number">4.2.4. </span>Maximum &amp; Minimum<a class="headerlink" href="#maximum-minimum" title="Permalink to this headline">¶</a></h3>
<p><em><strong>Maximum</strong></em> (<code class="docutils literal notranslate"><span class="pre">⌈</span></code>) and <em><strong>Minimum</strong></em> (<code class="docutils literal notranslate"><span class="pre">⌊</span></code>) return respectively the larger of two values and the smaller of two values, whatever their signs. Because they are scalar dyadic functions, they can be applied item by item between any two compatible arrays.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">75</span> <span class="o">⌈</span> <span class="m">83</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">83
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">19</span> <span class="o">⌈</span> <span class="m">11</span> <span class="m">22</span> <span class="m">¯20</span> <span class="m">60</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">19 22 19 60
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">52</span> <span class="m">14</span> <span class="m">¯37</span> <span class="m">18.44</span> <span class="o">⌊</span> <span class="m">¯60</span> <span class="m">15</span> <span class="m">¯40</span> <span class="m">11.23</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯60 14 ¯40 11.23
</span></div></div>
</div>
<p><em>Minimum</em> can be used to apply a limit to the values in an array. For example, to set a ceiling of 450 in the matrix <code class="docutils literal notranslate"><span class="pre">forecast</span></code>, it is sufficient to type:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">forecast</span> <span class="o">⌊</span> <span class="m">450</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 90 160 420 450  20  30
110 450 170 370 290 360
340 190 320 120 450 370
150 450 240 450 450 280
</span></div></div>
</div>
<p>Notice how the larger values have been capped to 450.</p>
</div>
<div class="section" id="relationship">
<span id="some-primitive-functions-relationship"></span><h3><span class="section-number">4.2.5. </span>Relationship<a class="headerlink" href="#relationship" title="Permalink to this headline">¶</a></h3>
<p>As in traditional mathematics, APL provides the 6 relationship functions:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>APL</p></th>
<th class="text-align:left head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&lt;</span> <span class="pre">B</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(A\)</span> less than <span class="math notranslate nohighlight">\(B\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">≤</span> <span class="pre">B</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(A\)</span> less than or equal to <span class="math notranslate nohighlight">\(B\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">=</span> <span class="pre">B</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(A\)</span> equal to <span class="math notranslate nohighlight">\(B\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">≥</span> <span class="pre">B</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(A\)</span> greater than or equal to <span class="math notranslate nohighlight">\(B\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">B</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(A\)</span> greater than <span class="math notranslate nohighlight">\(B\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">≠</span> <span class="pre">B</span></code></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(A\)</span> not equal to <span class="math notranslate nohighlight">\(B\)</span></p></td>
</tr>
</tbody>
</table>
<p>These symbols are obtained by pressing the <kbd>APL</kbd> key, simultaneously with the keys <kbd>3</kbd> to <kbd>8</kbd>, respectively.</p>
<p>All these 6 functions return <code class="docutils literal notranslate"><span class="pre">1</span></code> if the relation is true, or <code class="docutils literal notranslate"><span class="pre">0</span></code> if it is false.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">11</span> <span class="o">&lt;</span> <span class="m">7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">24</span> <span class="o">≤</span> <span class="m">24</span> <span class="m">11</span> <span class="m">33</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 0 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">5</span> <span class="o">=</span> <span class="m">9</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span> <span class="m">8</span> <span class="m">7</span> <span class="o">≥</span> <span class="m">5</span> <span class="m">8</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">6</span> <span class="o">&gt;</span> <span class="m">2</span> <span class="m">3</span><span class="o">⍴</span><span class="m">7</span> <span class="m">2</span> <span class="m">9</span> <span class="m">3</span> <span class="m">6</span> <span class="m">4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 0
1 0 1
</span></div></div>
</div>
<p>The results are called binary, or Boolean, values (Boolean refers to the name of the mathematician George Boole). They can be processed in many different ways and are extremely useful, as we shall soon see.</p>
<p>Note that none of the four symbols <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> <code class="docutils literal notranslate"><span class="pre">≤</span></code> <code class="docutils literal notranslate"><span class="pre">≥</span></code> <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> can be applied to character arrays. Only <code class="docutils literal notranslate"><span class="pre">=</span></code> and <code class="docutils literal notranslate"><span class="pre">≠</span></code> can be used with character arrays, as illustrated below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;m&#39;</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;m&#39;</span> <span class="o">=</span> <span class="s1">&#39;M&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;k&#39;</span> <span class="o">≠</span> <span class="s1">&#39;a&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;sorry&#39;</span> <span class="o">≠</span> <span class="s1">&#39;r&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 1 0 0 1
</span></div></div>
</div>
<p>Because these functions are scalar dyadic functions, they are applied between individual scalars (the letters), not words:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;gold&#39;</span> <span class="o">≠</span> <span class="s1">&#39;gulf&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 0 1
</span></div></div>
</div>
<p>For the same reason, the two words (considered as vectors) must be of equal size, otherwise we get an error:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;male&#39;</span> <span class="o">≠</span> <span class="s1">&#39;female&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LENGTH ERROR: Mismatched left and right argument shapes
      &#39;male&#39;≠&#39;female&#39;
            ∧
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="residue">
<span id="some-primitive-functions-residue"></span><h3><span class="section-number">4.2.6. </span>Residue<a class="headerlink" href="#residue" title="Permalink to this headline">¶</a></h3>
<p>The <em>Residue</em> function, represented by <code class="docutils literal notranslate"><span class="pre">|</span></code>, returns the remainder of a division.</p>
<p>In the expression <code class="docutils literal notranslate"><span class="pre">R</span> <span class="pre">←</span> <span class="pre">X|Y</span></code>, <code class="docutils literal notranslate"><span class="pre">R</span></code> is the remainder of <code class="docutils literal notranslate"><span class="pre">Y</span></code> divided by <code class="docutils literal notranslate"><span class="pre">X</span></code> (<strong>be careful</strong>; the arguments of <em>Residue</em> are given in the reverse order of that used by <em>Division</em> <code class="docutils literal notranslate"><span class="pre">Y÷X</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">7</span> <span class="o">|</span> <span class="m">54</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span> <span class="o">|</span> <span class="m">216</span> <span class="m">47</span> <span class="m">29</span> <span class="m">28</span>        <span class="c1">⍝ Find even and odd numbers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 1 0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">X</span> <span class="kd">←</span> <span class="m">7</span> <span class="m">4</span> <span class="m">11</span> <span class="m">¯4.3</span> <span class="m">3</span> <span class="m">¯5</span> <span class="m">6</span> <span class="m">¯3</span>
<span class="nv">Y</span> <span class="kd">←</span> <span class="m">54</span> <span class="m">84</span> <span class="m">119</span> <span class="m">19.6</span> <span class="m">29</span> <span class="m">43</span> <span class="m">¯14</span> <span class="m">¯14</span>
<span class="nv">X</span> <span class="o">|</span> <span class="nv">Y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 0 9 ¯1.9 2 ¯2 4 ¯2
</span></div></div>
</div>
<p>The function can be used with negative and decimal values, as seen above.</p>
<p>The result <code class="docutils literal notranslate"><span class="pre">R</span></code> is always equal to <code class="docutils literal notranslate"><span class="pre">Y</span> <span class="pre">-</span> <span class="pre">(N×X)</span></code>, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the largest possible integer such that <code class="docutils literal notranslate"><span class="pre">R</span></code> is always between <code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">X</span></code>, but never equal to <code class="docutils literal notranslate"><span class="pre">X</span></code>. Some calculations show that <code class="docutils literal notranslate"><span class="pre">N</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">⌊(Y÷X)</span></code>, which means <code class="docutils literal notranslate"><span class="pre">X|Y</span></code> and <code class="docutils literal notranslate"><span class="pre">Y</span> <span class="pre">-</span> <span class="pre">(X</span> <span class="pre">×</span> <span class="pre">(⌊(Y÷X)))</span></code> give the exact same result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">X</span><span class="o">|</span><span class="nv">Y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 0 9 ¯1.9 2 ¯2 4 ¯2
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">Y</span> <span class="o">-</span> <span class="p">(</span><span class="nv">X</span> <span class="o">×</span> <span class="p">(</span><span class="o">⌊</span><span class="p">(</span><span class="nv">Y</span><span class="o">÷</span><span class="nv">X</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 0 9 ¯1.9 2 ¯2 4 ¯2
</span></div></div>
</div>
<p>Using a new dyadic primitive <code class="docutils literal notranslate"><span class="pre">≡</span></code> (obtained with <kbd>APL</kbd>+<kbd>Shift</kbd>+<kbd>;</kbd>) we can ask APL to check if the two arrays are the same, instead of having to compare each array item by item:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">X</span><span class="o">|</span><span class="nv">Y</span><span class="p">)</span> <span class="o">≡</span> <span class="p">(</span><span class="nv">Y</span> <span class="o">-</span> <span class="p">(</span><span class="nv">X</span> <span class="o">×</span> <span class="p">(</span><span class="o">⌊</span><span class="p">(</span><span class="nv">Y</span><span class="o">÷</span><span class="nv">X</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>Keep reading the next section to see how <code class="docutils literal notranslate"><span class="pre">≡</span></code> works.</p>
</div>
<div class="section" id="array-comparison">
<span id="some-primitive-functions-array-comparison"></span><h3><span class="section-number">4.2.7. </span>Array Comparison<a class="headerlink" href="#array-comparison" title="Permalink to this headline">¶</a></h3>
<p>We have seen above that the dyadic functions <code class="docutils literal notranslate"><span class="pre">=</span></code> and <code class="docutils literal notranslate"><span class="pre">≠</span></code> are scalar, which meant we cannot use them when we wish to check if two arrays are the same or when we wish to check if two arrays are different:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="o">=</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 1 1 1
</span></div></div>
</div>
<p>The result above says the arrays have matching items, but doesn’t provide the summary information that <em>the arrays are the same</em>.</p>
<p>For a similar reason, we can’t even compare vectors of different lengths because dyadic scalar functions expect the shapes of their arguments to match:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;male&#39;</span> <span class="o">=</span> <span class="s1">&#39;female&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LENGTH ERROR: Mismatched left and right argument shapes
      &#39;male&#39;=&#39;female&#39;
            ∧
</pre></div>
</div>
</div>
</div>
<p>Instead, we must use the <em><strong>Match</strong></em> (<code class="docutils literal notranslate"><span class="pre">≡</span></code>) function to check if two arrays are exactly the same:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="o">≡</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;male&#39;</span> <span class="o">≡</span> <span class="s1">&#39;female&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<p>The <em><strong>Not Match</strong></em> (<code class="docutils literal notranslate"><span class="pre">≢</span></code>) primitive (obtained with <kbd>APL</kbd>+<kbd>Shift</kbd>+<kbd>’</kbd>) is the counterpart to <code class="docutils literal notranslate"><span class="pre">≡</span></code> and checks if two arrays are different:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="o">≢</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;male&#39;</span> <span class="o">≢</span> <span class="s1">&#39;female&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
</div>
</div>
<div class="section" id="order-of-evaluation">
<span id="some-primitive-functions-order-of-evaluation"></span><h2><span class="section-number">4.3. </span>Order of Evaluation<a class="headerlink" href="#order-of-evaluation" title="Permalink to this headline">¶</a></h2>
<p>Like other programming languages, APL allows the programmer to use parentheses to specify the order of evaluation of a complex expression. Thus the expression <code class="docutils literal notranslate"><span class="pre">5×(6+7)</span></code> means “add 6 to 7, then multiply by 5”. In the absence of parentheses, most other programming languages employ rules of precedence to decide how a complex expression such as <code class="docutils literal notranslate"><span class="pre">5×6+7</span></code> would be evaluated. Typically, the result will be 37 because multiplication is given precedence over addition and is performed first.</p>
<p>When APL was designed, it was decided that the sheer number of primitive functions meant that a set of precedence rules would be impossibly complex to remember and apply.</p>
<p>The solution adopted in APL is simple, and consistent with the rules we apply to calculate complex expressions in traditional algebra. Suppose, for example, that we need to calculate</p>
<div class="math notranslate nohighlight">
\[\log \sin \sqrt {x ÷ 3}\]</div>
<p>To do this, we would first divide <span class="math notranslate nohighlight">\(x\)</span> by 3, then take the square root of the result, next calculate its sine, and finally calculate the logarithm: each function applies to the result of the entire expression to its right. This is how it is done in mathematics, and so it is in APL. The only different is that in APL there are <em>no</em> exceptions!</p>
<p>To evaluate</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">5</span> <span class="o">×</span> <span class="m">6</span> <span class="o">+</span> <span class="m">7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">65
</span></div></div>
</div>
<p>we first calculate</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">6</span> <span class="o">+</span> <span class="m">7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">13
</span></div></div>
</div>
<p>and then multiply by 5, giving 65:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">5</span> <span class="o">×</span> <span class="m">13</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">65
</span></div></div>
</div>
<p>By the use of parentheses we can instruct APL to do the multiplication first,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">5</span> <span class="o">×</span> <span class="m">6</span><span class="p">)</span> <span class="o">+</span> <span class="m">7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">37
</span></div></div>
</div>
<p>which an experienced APL programmer would probably write as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">7</span> <span class="o">+</span> <span class="m">5</span> <span class="o">×</span> <span class="m">6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">37
</span></div></div>
</div>
<div class="tip admonition">
<p class="admonition-title">Rule</p>
<p>In an APL expression, each function takes as its right argument the result of the entire expression to its right. No functions have higher precedence than any others.</p>
<p>If the function is dyadic (takes both a left and a right argument), it takes as its left argument the array immediately to its left, delimited by the next function.</p>
<p>This is sometimes called “<em><strong>Right to left evaluation</strong></em>” (although this is not strictly correct).</p>
<p>If necessary, one can use <em><strong>Parentheses</strong></em> to force a different order of evaluation.</p>
</div>
<p>You must not be confused: each function is itself evaluated in its natural order, so <code class="docutils literal notranslate"><span class="pre">8÷4</span></code> gives 2, not 0.5! The expression “<em>right to left</em>” only means that the first operation executed is the rightmost one.</p>
<p>If the order of evaluation seems strange to you at first sight, just refer to a plain English sentence: “<em>take the top half of the bottom quarter</em>” does not mean “<em>take the top half first, and then take the bottom quarter</em>”; it means “<em><strong>first</strong> split into quarters and take the bottom one, <strong>then</strong> split that quarter into two halves and take the top half of it</em>”: this is exactly the way that APL works! Even in everyday English language, which we write from left to right, we implicitly use the “right to left evaluation” rule.</p>
<p>Let us apply this rule to some examples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span><span class="o">×</span><span class="m">5</span><span class="o">+</span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">18
</span></div></div>
</div>
<p>First we sum,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">5</span><span class="o">+</span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6
</span></div></div>
</div>
<p>then we multiply:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span><span class="o">×</span><span class="m">6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">18
</span></div></div>
</div>
<p>Now an example with 3 operations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span> <span class="m">6</span><span class="o">⌊</span><span class="m">4</span><span class="o">+</span><span class="m">2</span> <span class="m">9</span><span class="o">&gt;</span><span class="m">7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 5
</span></div></div>
</div>
<p>First we perform the “greater than” comparison,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span> <span class="m">9</span><span class="o">&gt;</span><span class="m">7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1
</span></div></div>
</div>
<p>then we add 4</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">4</span><span class="o">+</span><span class="m">0</span> <span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4 5
</span></div></div>
</div>
<p>and finally we take the minimum:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span> <span class="m">6</span><span class="o">⌊</span><span class="m">4</span> <span class="m">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 5
</span></div></div>
</div>
<p>An even more complex example, from the end of the subsection on the <em>Residue</em> (<code class="docutils literal notranslate"><span class="pre">|</span></code>) primitive function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">X</span><span class="o">|</span><span class="nv">Y</span><span class="p">)</span><span class="o">≡</span><span class="nv">Y</span><span class="o">-</span><span class="nv">X</span><span class="o">×⌊</span><span class="nv">Y</span><span class="o">÷</span><span class="nv">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>Notice that in the example above we still kept a set of parentheses around <code class="docutils literal notranslate"><span class="pre">X|Y</span></code>, because we want <code class="docutils literal notranslate"><span class="pre">≡</span></code> to compare <code class="docutils literal notranslate"><span class="pre">X|Y</span></code> with <code class="docutils literal notranslate"><span class="pre">Y-X×⌊Y÷X</span></code>. To get rid of those parentheses one would need to introduce an intermediate variable, for example like so:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">R</span> <span class="kd">←</span> <span class="nv">X</span><span class="o">|</span><span class="nv">Y</span>
<span class="nv">R</span><span class="o">≡</span><span class="nv">Y</span><span class="o">-</span><span class="nv">X</span><span class="o">×⌊</span><span class="nv">Y</span><span class="o">÷</span><span class="nv">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="warning admonition">
<p class="admonition-title">Warning</p>
<p>In the beginning you may encounter some surprises. For example, if <code class="docutils literal notranslate"><span class="pre">v</span></code> is a vector, <code class="docutils literal notranslate"><span class="pre">1+⍴v</span></code> is different from <code class="docutils literal notranslate"><span class="pre">⍴v+1</span></code>. Let us see why, with the following vector:</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">v</span> <span class="kd">←</span> <span class="m">5</span> <span class="m">2</span> <span class="m">7</span>
</pre></div>
</div>
</div>
</div>
<p>The value of</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="o">+⍴</span><span class="nv">v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4
</span></div></div>
</div>
<p>is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3
</span></div></div>
</div>
<p>followed by</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="o">+</span><span class="m">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4
</span></div></div>
</div>
<p>Whereas the value of</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">v</span><span class="o">+</span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3
</span></div></div>
</div>
<p>is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">v</span><span class="o">+</span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6 3 8
</span></div></div>
</div>
<p>followed by</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="m">6</span> <span class="m">3</span> <span class="m">8</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3
</span></div></div>
</div>
<p>which gives a different result.</p>
<p>This may be completely new to people who have experience with other programming languages, and is one of the reasons why we <strong>recommend</strong> that you do all of the exercises at the end of this chapter. With a little practice, you will soon find this simple rule very natural, and you will consider it a relief that you do not have to remember complex rules for function precedence.</p>
</div>
<div class="section" id="monadic-scalar-functions">
<span id="some-primitive-functions-monadic-scalar-functions"></span><h2><span class="section-number">4.4. </span>Monadic Scalar Functions<a class="headerlink" href="#monadic-scalar-functions" title="Permalink to this headline">¶</a></h2>
<p>Most of the symbols we have encountered so far also have a monadic definition; let’s look at them now.</p>
<div class="section" id="the-four-basic-symbols">
<span id="some-primitive-functions-the-four-basic-symbols"></span><h3><span class="section-number">4.4.1. </span>The Four Basic Symbols<a class="headerlink" href="#the-four-basic-symbols" title="Permalink to this headline">¶</a></h3>
<p>We will begin with the four basic symbols: <code class="docutils literal notranslate"><span class="pre">+</span></code> <code class="docutils literal notranslate"><span class="pre">-</span></code> <code class="docutils literal notranslate"><span class="pre">×</span></code> <code class="docutils literal notranslate"><span class="pre">÷</span></code></p>
<div class="section" id="conjugate">
<span id="some-primitive-functions-conjugate"></span><h4><span class="section-number">4.4.1.1. </span>Conjugate<a class="headerlink" href="#conjugate" title="Permalink to this headline">¶</a></h4>
<p>The Plus sign used monadically is the <em><strong>Conjugate</strong></em> function. It returns the <em><strong>complex conjugate</strong></em> of its arguments:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span> <span class="m">0J1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0J¯1
</span></div></div>
</div>
<p>When the numbers have no complex part, the function acts as the identity function, as the complex conjugate of a real number is the number itself:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">¯3</span> <span class="m">6.5346</span> <span class="m">56J0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3 ¯3 6.5346 56
</span></div></div>
</div>
<p>For compatibility reasons, monadic <code class="docutils literal notranslate"><span class="pre">+</span></code> also acts as the identity function if the argument is a character:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span> <span class="s1">&#39;a&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">a
</span></div></div>
</div>
<p>Because it is a scalar function, it naturally works with mixed arrays:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span> <span class="s1">&#39;B&#39;</span> <span class="m">3</span> <span class="s1">&#39;a&#39;</span> <span class="m">¯3</span> <span class="m">0J1</span> <span class="s1">&#39;g&#39;</span> <span class="m">4J¯4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">B 3 a ¯3 0J¯1 g 4J4
</span></div></div>
</div>
</div>
<div class="section" id="negate">
<span id="some-primitive-functions-negate"></span><h4><span class="section-number">4.4.1.2. </span>Negate<a class="headerlink" href="#negate" title="Permalink to this headline">¶</a></h4>
<p>The Minus sign is the <em><strong>Negative</strong></em> function. It returns the negation of its argument:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="m">19</span> <span class="m">11</span> <span class="m">¯33</span> <span class="m">0</span> <span class="m">¯17</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯19 ¯11 33 0 17
</span></div></div>
</div>
</div>
<div class="section" id="direction">
<span id="some-primitive-functions-direction"></span><h4><span class="section-number">4.4.1.3. </span>Direction<a class="headerlink" href="#direction" title="Permalink to this headline">¶</a></h4>
<p>The Multiply symbol used monadically is the <em><strong>Direction</strong></em> function. For real numbers, it tells us the sign of its argument, using the following convention:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:right head"><p>Result</p></th>
<th class="text-align:left head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td class="text-align:left"><p>The value is positive</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
<td class="text-align:left"><p>The value is zero</p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p><code class="docutils literal notranslate"><span class="pre">¯1</span></code></p></td>
<td class="text-align:left"><p>The value is negative</p></td>
</tr>
</tbody>
</table>
<p>Some examples follow:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">×</span> <span class="m">19</span> <span class="m">11</span> <span class="m">¯33</span> <span class="m">0</span> <span class="m">¯17</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 1 ¯1 0 ¯1
</span></div></div>
</div>
<p>But <em>Direction</em> also applies to complex numbers, and does so by extending the idea above. The <em>Direction</em> of a number is that same number re-scaled so that it has magnitude (“length”) 1.</p>
<p>Let us take the complex number <code class="docutils literal notranslate"><span class="pre">3J4</span></code> as an example. If we look at the figure below, we see that the 3 is represented by the bottom side of the triangle and the 4 by the right side of the triangle. The little arrow that goes from the lower-left to the upper-right vertex of the triangle represents the direction in which <code class="docutils literal notranslate"><span class="pre">3J4</span></code> points.</p>
<div class="figure align-default" id="direction-right-triangle">
<span id="fig-direction-right-triangle"></span><img alt="_images/Direction_Right_Triangle.png" src="_images/Direction_Right_Triangle.png" />
<p class="caption"><span class="caption-number">Fig. 4.1 </span><span class="caption-text">A right triangle with sides 3, 4 and 5 representing the complex number <code class="docutils literal notranslate"><span class="pre">3J4</span></code>.</span><a class="headerlink" href="#direction-right-triangle" title="Permalink to this image">¶</a></p>
</div>
<p>We can also see that said arrow has length 5, as the Pythagorean theorem tells us:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="m">3</span><span class="o">*</span><span class="m">2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="m">4</span><span class="o">*</span><span class="m">2</span><span class="p">))</span><span class="o">*</span><span class="m">0.5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5
</span></div></div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">×3J4</span></code> is the complex number associated with a triangle that is similar to the one above, but with the arrow measuring 1, exactly like the smaller triangle inside the larger triangle in the figure below:</p>
<div class="figure align-default" id="direction-right-triangle-scaled">
<span id="fig-direction-right-triangle-scaled"></span><img alt="_images/Direction_Right_Triangle_Scaled.png" src="_images/Direction_Right_Triangle_Scaled.png" />
<p class="caption"><span class="caption-number">Fig. 4.2 </span><span class="caption-text">Scaled down version of the <code class="docutils literal notranslate"><span class="pre">3J4</span></code> triangle.</span><a class="headerlink" href="#direction-right-triangle-scaled" title="Permalink to this image">¶</a></p>
</div>
<p>We only have to figure out the lengths of the other two sides:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">×</span> <span class="m">3J4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.6J0.8
</span></div></div>
</div>
</div>
<div class="section" id="reciprocal">
<span id="some-primitive-functions-reciprocal"></span><h4><span class="section-number">4.4.1.4. </span>Reciprocal<a class="headerlink" href="#reciprocal" title="Permalink to this headline">¶</a></h4>
<p>No surprise: the Divide symbol gives the <em><strong>Reciprocal</strong></em> or <em><strong>Inverse</strong></em> of its argument:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">÷</span> <span class="m">2</span> <span class="m">¯4</span> <span class="m">.3</span> <span class="m">.25</span> <span class="m">¯7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.5 ¯0.25 3.33333 4 ¯0.142857
</span></div></div>
</div>
</div>
</div>
<div class="section" id="other-scalar-monadic-functions">
<h3><span class="section-number">4.4.2. </span>Other Scalar Monadic Functions<a class="headerlink" href="#other-scalar-monadic-functions" title="Permalink to this headline">¶</a></h3>
<div class="section" id="magnitude-absolute-value">
<span id="some-primitive-functions-magnitude-absolute-value"></span><h4><span class="section-number">4.4.2.1. </span>Magnitude (Absolute Value)<a class="headerlink" href="#magnitude-absolute-value" title="Permalink to this headline">¶</a></h4>
<p>The monadic stile represents the absolute (unsigned) value of its argument, if its argument only contains real numbers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">V</span> <span class="kd">←</span> <span class="m">29.2</span> <span class="m">49.3</span> <span class="m">¯14.8</span> <span class="m">0</span> <span class="m">¯37.2</span>
<span class="o">|</span><span class="nv">V</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">29.2 49.3 14.8 0 37.2
</span></div></div>
</div>
<p>Like monadic <code class="docutils literal notranslate"><span class="pre">×</span></code>, monadic <code class="docutils literal notranslate"><span class="pre">|</span></code> generalises nicely for complex numbers. Take the complex number <code class="docutils literal notranslate"><span class="pre">12J5</span></code> and its representation as a right triangle in the figure below.</p>
<div class="figure align-default" id="magnitude-right-triangle">
<span id="fig-magnitude-right-triangle"></span><img alt="_images/Magnitude_Right_Triangle.png" src="_images/Magnitude_Right_Triangle.png" />
<p class="caption"><span class="caption-number">Fig. 4.3 </span><span class="caption-text">The complex number <code class="docutils literal notranslate"><span class="pre">12J5</span></code> represented by a right triangle.</span><a class="headerlink" href="#magnitude-right-triangle" title="Permalink to this image">¶</a></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">|12J5</span></code> is the length that is missing in the figure. In this case, it is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">|</span><span class="m">12J5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">13
</span></div></div>
</div>
<p>From a geometrical point of view it becomes clear that <code class="docutils literal notranslate"><span class="pre">×</span></code> and <code class="docutils literal notranslate"><span class="pre">|</span></code> are related for any number <code class="docutils literal notranslate"><span class="pre">v</span></code>: if we take the small triangle (<code class="docutils literal notranslate"><span class="pre">×v</span></code>) and we multiply it by the length of the larger side (<code class="docutils literal notranslate"><span class="pre">|v</span></code>) then we get the original triangle, which represents the original (complex) number:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">v</span> <span class="kd">←</span> <span class="m">0</span> <span class="m">1</span> <span class="m">¯1</span> <span class="m">2.3</span> <span class="m">¯4.6</span> <span class="m">0J1</span> <span class="m">3J¯4.2</span>
<span class="nv">v</span><span class="o">≡</span><span class="p">(</span><span class="o">×</span><span class="nv">v</span><span class="p">)</span><span class="o">×|</span><span class="nv">v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
</div>
<div class="section" id="exponential">
<span id="some-primitive-functions-exponential"></span><h4><span class="section-number">4.4.2.2. </span>Exponential<a class="headerlink" href="#exponential" title="Permalink to this headline">¶</a></h4>
<p>The expression <code class="docutils literal notranslate"><span class="pre">*n</span></code> gives <span class="math notranslate nohighlight">\(e^n\)</span>, where <span class="math notranslate nohighlight">\(e\)</span> is the base of the natural logarithm, approximately <span class="math notranslate nohighlight">\(2.71828\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">*</span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2.71828
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="m">1</span> <span class="m">0</span> <span class="m">3</span> <span class="m">¯1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2.71828 1 20.0855 0.367879
</span></div></div>
</div>
</div>
<div class="section" id="floor-and-ceiling">
<span id="some-primitive-functions-floor-and-ceiling"></span><h4><span class="section-number">4.4.2.3. </span>Floor and Ceiling<a class="headerlink" href="#floor-and-ceiling" title="Permalink to this headline">¶</a></h4>
<p><em><strong>Floor</strong></em> (<code class="docutils literal notranslate"><span class="pre">⌊</span></code>) rounds its argument down, while <em><strong>Ceiling</strong></em> (<code class="docutils literal notranslate"><span class="pre">⌈</span></code>) rounds its argument up, to the nearest smaller or larger integer value, respectively:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">v</span> <span class="kd">←</span> <span class="m">51.384</span> <span class="m">48.962</span> <span class="m">0</span> <span class="m">12.5</span> <span class="m">¯73.27</span> <span class="m">¯9.99</span>
<span class="o">⌊</span><span class="nv">v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">51 48 0 12 ¯74 ¯10
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⌈</span><span class="nv">v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">52 49 0 13 ¯73 ¯9
</span></div></div>
</div>
<p>To round a value to the nearest integer a commonly used method is to add 0.5 and then take the <em>Floor</em>, or alternatively, to subtract 0.5 and take the <em>Ceiling</em>, as shown here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⌊</span><span class="nv">v</span><span class="o">+</span><span class="m">0.5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">51 49 0 13 ¯73 ¯10
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⌈</span><span class="nv">v</span><span class="o">-</span><span class="m">0.5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">51 49 0 12 ¯73 ¯10
</span></div></div>
</div>
<p>The results are the same, except when the decimal part of a number if 0.5. For example, 12.5 above gets rounded to 13 or 12 depending on which method is used.</p>
</div>
</div>
</div>
<div class="section" id="left-and-right-tacks">
<span id="some-primitive-functions-left-and-right-tacks"></span><h2><span class="section-number">4.5. </span>Left and Right Tacks<a class="headerlink" href="#left-and-right-tacks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="same">
<span id="some-primitive-functions-same"></span><h3><span class="section-number">4.5.1. </span>Same<a class="headerlink" href="#same" title="Permalink to this headline">¶</a></h3>
<p>APL also includes two primitive functions whose monadic name is the same: <em><strong>Same</strong></em>. These two primitives are the <em><strong>Right Tack</strong></em> (<code class="docutils literal notranslate"><span class="pre">⊢</span></code>) and the <em><strong>Left Tack</strong></em> (<code class="docutils literal notranslate"><span class="pre">⊣</span></code>), obtained respectively with <kbd>APL</kbd>+<kbd>\</kbd> and <kbd>APL</kbd>+<kbd>Shift</kbd>+<kbd>\</kbd>.</p>
<p>Their monadic name is <em>Same</em> because they act as true identity functions, returning their argument completely unchanged:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span> <span class="s1">&#39;Banana&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">Banana
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span> <span class="s1">&#39;Bag&#39;</span> <span class="m">3</span> <span class="p">(</span><span class="m">1</span> <span class="m">2</span> <span class="s1">&#39;Bag&#39;</span><span class="p">)</span> <span class="p">(</span><span class="s1">&#39;Bag&#39;</span> <span class="p">(</span><span class="s1">&#39;Bag&#39;</span> <span class="m">3</span><span class="p">)</span> <span class="p">(</span><span class="m">2</span> <span class="m">2</span><span class="o">⍴</span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───┬─┬─────────┬─────────────────┐
│Bag│3│┌─┬─┬───┐│┌───┬───────┬───┐│
│   │ ││1│2│Bag│││Bag│┌───┬─┐│1 2││
│   │ │└─┴─┴───┘││   ││Bag│3││3 4││
│   │ │         ││   │└───┴─┘│   ││
│   │ │         │└───┴───────┴───┘│
└───┴─┴─────────┴─────────────────┘
</span></div></div>
</div>
<p>Exactly the same thing happens (i.e. nothing happens) if you replace all the <code class="docutils literal notranslate"><span class="pre">⊢</span></code> above with <code class="docutils literal notranslate"><span class="pre">⊣</span></code>, for example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊣</span> <span class="s1">&#39;Bag&#39;</span> <span class="m">3</span> <span class="p">(</span><span class="m">1</span> <span class="m">2</span> <span class="s1">&#39;Bag&#39;</span><span class="p">)</span> <span class="p">(</span><span class="s1">&#39;Bag&#39;</span> <span class="p">(</span><span class="s1">&#39;Bag&#39;</span> <span class="m">3</span><span class="p">)</span> <span class="p">(</span><span class="m">2</span> <span class="m">2</span><span class="o">⍴</span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───┬─┬─────────┬─────────────────┐
│Bag│3│┌─┬─┬───┐│┌───┬───────┬───┐│
│   │ ││1│2│Bag│││Bag│┌───┬─┐│1 2││
│   │ │└─┴─┴───┘││   ││Bag│3││3 4││
│   │ │         ││   │└───┴─┘│   ││
│   │ │         │└───┴───────┴───┘│
└───┴─┴─────────┴─────────────────┘
</span></div></div>
</div>
<p>These two functions may look useless, but they are not. For one, a neat little trick we can do with them is to display a value of a variable that we just assigned; for example, compare the two code cells below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">matrix</span> <span class="kd">←</span> <span class="m">2</span> <span class="m">3</span><span class="o">⍴</span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span>        <span class="c1">⍝ Nothing gets displayed explicitly</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">matrix</span><span class="kd">←</span> <span class="m">2</span> <span class="m">3</span><span class="o">⍴</span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span>        <span class="c1">⍝ The value of matrix is displayed </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3
4 5 6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊣</span><span class="nv">matrix</span><span class="kd">←</span> <span class="m">2</span> <span class="m">3</span><span class="o">⍴</span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span>        <span class="c1">⍝ The value of matrix is displayed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3
4 5 6
</span></div></div>
</div>
<p>These functions become even more useful combined with the power of operators or tacit programming (explained in detail in future chapters), or if we take a look at their dyadic usages (explained next).</p>
</div>
<div class="section" id="dyadic-usage">
<span id="some-primitive-functions-dyadic-usage"></span><h3><span class="section-number">4.5.2. </span>Dyadic Usage<a class="headerlink" href="#dyadic-usage" title="Permalink to this headline">¶</a></h3>
<p>The <em>Left</em> and <em>Right Tacks</em> differ in their dyadic usage, of course, otherwise there would be no point in having two primitive functions that behaved in exactly the same manner.</p>
<p>When used dyadically, the <em>Left Tack</em> returns its left argument and the <em>Right Tack</em> returns its right argument. If you ever forget which dyadic tack returns what, just remember that each tack returns the argument to which it is pointing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="o">⊣</span> <span class="s1">&#39;Bananas&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="o">⊢</span> <span class="s1">&#39;Bananas&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">Bananas
</span></div></div>
</div>
</div>
</div>
<div class="section" id="processing-binary-data">
<span id="some-primitive-functions-processing-binary-data"></span><h2><span class="section-number">4.6. </span>Processing Binary Data<a class="headerlink" href="#processing-binary-data" title="Permalink to this headline">¶</a></h2>
<div class="tip admonition">
<p class="admonition-title">Remark</p>
<p>Binary values are most often produced by the comparison functions that we have already seen. However, the result of <em>any</em> function (such as addition or subtraction) which is composed only of 1s and 0s can be used as a binary (or Boolean) value, and may be used as an argument to any of the special primitive functions that apply to Boolean values.</p>
</div>
<p>Among the various ways of producing binary results, <em>Membership</em> appears to be one of the most interesting tools.</p>
<div class="section" id="membership">
<span id="some-primitive-functions-membership"></span><h3><span class="section-number">4.6.1. </span>Membership<a class="headerlink" href="#membership" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><em><strong>Membership</strong></em> tells whether the items of its left argument are present (<code class="docutils literal notranslate"><span class="pre">1</span></code>) or not (<code class="docutils literal notranslate"><span class="pre">0</span></code>) in the right argument, regardless of their position in it;</p></li>
<li><p>it accepts arguments of any shape or type;</p></li>
<li><p>the result produced always has the same shape as the <strong>left</strong> argument.</p></li>
</ul>
<p>Some examples will help you understand the function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">23</span> <span class="m">14</span> <span class="m">41</span> <span class="m">19</span> <span class="o">∊</span> <span class="m">17</span> <span class="m">88</span> <span class="m">19</span> <span class="m">50</span> <span class="m">51</span> <span class="m">52</span> <span class="m">23</span> <span class="m">40</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 0 0 1
</span></div></div>
</div>
<p>This means that 23 and 19 appear somewhere in the rightmost vector, whereas 14 and 41 do not. The left argument has 4 items, and so has the result.</p>
<p>The <em>Membership</em> function can operate on arguments of completely different shape. For example, it is possible to detect the presence of each item of a vector in a matrix, or vice versa.</p>
<p>In an earlier chapter we used a matrix containing the first 6 months of the year:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">monMat</span> <span class="kd">←</span> <span class="m">6</span> <span class="m">8</span><span class="o">⍴</span><span class="s1">&#39;January FebruaryMarch   April   May     June    &#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">January 
February
March   
April   
May     
June    
</span></div></div>
</div>
<p>We can ask if certain letters are present in this matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;December&#39;</span> <span class="o">∊</span> <span class="nv">monMat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 1 1 0 1 1 1
</span></div></div>
</div>
<p>The result shows that all letters of the word “December” appear in <code class="docutils literal notranslate"><span class="pre">monMat</span></code>, except “D” and lowercase “m” (which should not be confused with the uppercase “M” or March and May).</p>
<p>In this case we used a vector left argument and a matrix right argument. Let’s try it the other way around. The following expression tells us which letters in the matrix <code class="docutils literal notranslate"><span class="pre">monMat</span></code> appear in the word “Century”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">monMat</span> <span class="o">∊</span> <span class="s1">&#39;Century&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 1 1 0 1 1 0
0 1 0 1 1 0 1 1
0 0 1 0 0 0 0 0
0 0 1 0 0 0 0 0
0 0 1 0 0 0 0 0
0 1 1 1 0 0 0 0
</span></div></div>
</div>
<p>As you might imagine, any comparison between numbers and letters gives zero:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1952</span> <span class="o">∊</span> <span class="s1">&#39;1952&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;1952&#39;</span> <span class="o">∊</span> <span class="m">1952</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 0
</span></div></div>
</div>
<p>Remember that <code class="docutils literal notranslate"><span class="pre">'1952'</span></code> is a vector of 4 letters, none of which can be found in the number 1952.</p>
<p>We <strong>recommend</strong> that you do exercise 22 to discover all possibilities of <em>Membership</em>.</p>
</div>
<div class="section" id="binary-algebra">
<span id="some-primitive-functions-binary-algebra"></span><h3><span class="section-number">4.6.2. </span>Binary Algebra<a class="headerlink" href="#binary-algebra" title="Permalink to this headline">¶</a></h3>
<p>Binary values can be processed using half a dozen specialised primitive functions, the main ones being <em><strong>And</strong></em>, <em><strong>Or</strong></em>, <em><strong>Xor</strong></em> and <em><strong>Not</strong></em>. Additional functions will be described in the <em>Specialist’s Section</em>.</p>
<p>The function <em><strong>And</strong></em> is represented by the symbol <code class="docutils literal notranslate"><span class="pre">∧</span></code> (<kbd>APL</kbd>+<kbd>0</kbd>), as it is in mathematics. It returns the result 1 if the left <em><strong>and</strong></em> the right arguments are both equal to 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span> <span class="o">∧</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span> <span class="o">∧</span> <span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="o">∧</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="o">∧</span> <span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>We can condense the four expressions above into a single one, given that <code class="docutils literal notranslate"><span class="pre">∧</span></code> is also a scalar function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span> <span class="m">0</span> <span class="m">1</span> <span class="m">1</span> <span class="o">∧</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 1
</span></div></div>
</div>
<p>The function <em><strong>Or</strong></em> is represented by the symbol <code class="docutils literal notranslate"><span class="pre">∨</span></code> (<kbd>APL</kbd>+<kbd>9</kbd>), as it is in mathematics. It returns the result 1 if the left <em><strong>or</strong></em> right argument is equal to 1.</p>
<p>The four possible cases are shown in the following expression:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span> <span class="m">0</span> <span class="m">1</span> <span class="m">1</span> <span class="o">∨</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 1 1
</span></div></div>
</div>
<p><em><strong>Xor</strong></em> is an acronym for <em><strong>eXclusive Or</strong></em>. It returns the result 1 if one of the arguments is equal to 1, but not if both are equal to 1.</p>
<p>In automation, the same function is generally represented by a circled Plus sign, like <span class="math notranslate nohighlight">\(\oplus\)</span>.</p>
<p>APL does not need a different symbol for the function, because <em><strong>Xor</strong></em> is the same as one of the comparison functions we have already met: <code class="docutils literal notranslate"><span class="pre">≠</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span> <span class="m">0</span> <span class="m">1</span> <span class="m">1</span> <span class="o">≠</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 1 0
</span></div></div>
</div>
<p>The last function is the monadic function <em><strong>Not</strong></em>. Represented by the <em>Tilde</em> <code class="docutils literal notranslate"><span class="pre">~</span></code> (<kbd>APL</kbd>+<kbd>t</kbd>), it converts 0 into 1 and 1 into 0:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">~</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">1</span> <span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 0 1 1 1 0 0
</span></div></div>
</div>
<div class="tip admonition">
<p class="admonition-title">Remark</p>
<ul class="simple">
<li><p><em><strong>And</strong></em>, <em><strong>Or</strong></em> and <em><strong>Xor</strong></em> are scalar dyadic functions;</p></li>
<li><p><em><strong>Not</strong></em> is a scalar monadic function;</p></li>
<li><p><em><strong>Membership</strong></em> is a dyadic function, but it is not a scalar function.</p></li>
</ul>
</div>
<p>All these functions can be applied to binary data of any shape. For example, let us see if any of those items of <code class="docutils literal notranslate"><span class="pre">forecast</span></code>, which are greater than 350 thousand Euros, have been exceeded by <code class="docutils literal notranslate"><span class="pre">actual</span></code> sales:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">bin</span> <span class="kd">←</span> <span class="p">(</span><span class="nv">forecast</span><span class="o">&gt;</span><span class="m">350</span><span class="p">)</span> <span class="o">∧</span> <span class="p">(</span><span class="nv">actual</span><span class="o">&gt;</span><span class="nv">forecast</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 1 0 0
0 1 0 0 0 0
0 0 0 0 1 1
0 1 0 0 0 0
</span></div></div>
</div>
<p>A side note: the parentheses around the rightmost expression <code class="docutils literal notranslate"><span class="pre">(actual&gt;forecast)</span></code> are not strictly needed. However, they do no harm either, so we have added them here to help you read the expression, since you may not yet be fully familiar with APL’s order of evaluation.</p>
</div>
<div class="section" id="without">
<span id="some-primitive-functions-without"></span><h3><span class="section-number">4.6.3. </span>Without<a class="headerlink" href="#without" title="Permalink to this headline">¶</a></h3>
<p>Given a vector <code class="docutils literal notranslate"><span class="pre">X</span></code> and any array <code class="docutils literal notranslate"><span class="pre">Y</span></code>, the expression <code class="docutils literal notranslate"><span class="pre">X~Y</span></code> returns a vector equal to <code class="docutils literal notranslate"><span class="pre">X</span></code>, but in which all items of <code class="docutils literal notranslate"><span class="pre">Y</span></code> have been removed. The size and shape of <code class="docutils literal notranslate"><span class="pre">Y</span></code> is immaterial, only the individual items of <code class="docutils literal notranslate"><span class="pre">Y</span></code> are used.</p>
<p>This function is called <em><strong>Without</strong></em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;This Winter is warm&#39;</span> <span class="o">~</span> <span class="nv">monMat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">TsWtswm
</span></div></div>
</div>
<p>Notice how the right argument above (<code class="docutils literal notranslate"><span class="pre">monMat</span></code>) is a matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;Congratulations&#39;</span> <span class="o">~</span> <span class="s1">&#39;ceremony&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">Cgatulatis
</span></div></div>
</div>
<p>The uppercase “C” is preserved here because it is different from the lowercase “c”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3
4 5 6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span> <span class="m">2</span> <span class="m">4</span> <span class="m">6</span> <span class="m">8</span> <span class="m">10</span> <span class="m">12</span> <span class="o">~</span> <span class="nv">matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 8 10 12
</span></div></div>
</div>
<p>Of course, it also works on numbers.</p>
</div>
</div>
<div class="section" id="processing-nested-arrays">
<span id="some-primitive-functions-processing-nested-arrays"></span><h2><span class="section-number">4.7. </span>Processing Nested Arrays<a class="headerlink" href="#processing-nested-arrays" title="Permalink to this headline">¶</a></h2>
<p>When working with nested arrays, it is important to recognise whether or not you are using a scalar function.</p>
<div class="section" id="scalar-vs-non-scalar-functions">
<span id="some-primitive-functions-scalar-vs-non-scalar-functions"></span><h3><span class="section-number">4.7.1. </span>Scalar vs. Non-scalar Functions<a class="headerlink" href="#scalar-vs-non-scalar-functions" title="Permalink to this headline">¶</a></h3>
<p>In <a class="reference internal" href="Data-and-Variables.html#data-and-variables-data-and-variables"><span class="std std-numref">Section 3</span></a>, we set up a nested vector <code class="docutils literal notranslate"><span class="pre">children</span></code>, which is composed only of numeric items:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">)</span><span class="nv">copy</span> <span class="nv">DISPLAY</span>
<span class="nv">children</span> <span class="kd">←</span> <span class="p">(</span><span class="m">6</span> <span class="m">2</span><span class="p">)</span> <span class="p">(</span><span class="m">35</span> <span class="m">33</span> <span class="m">26</span> <span class="m">21</span><span class="p">)</span> <span class="p">(</span><span class="m">7</span> <span class="m">7</span><span class="p">)</span> <span class="m">3</span> <span class="p">(</span><span class="m">19</span> <span class="m">14</span><span class="p">)</span>
<span class="nv">DISPLAY</span> <span class="nv">children</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">C:\Program Files\Dyalog\Dyalog APL-64 18.0 Unicode\ws\DISPLAY.dws saved Tue Dec  1 20:08:12 2020
</span></div><div class="output text_html"><span style="white-space:pre; font-family: monospace">┌→────────────────────────────────────┐
│ ┌→──┐ ┌→──────────┐ ┌→──┐   ┌→────┐ │
│ │6 2│ │35 33 26 21│ │7 7│ 3 │19 14│ │
│ └~──┘ └~──────────┘ └~──┘   └~────┘ │
└∊────────────────────────────────────┘
</span></div></div>
</div>
<p>The application of scalar functions is straightforward.</p>
<p>For example, when we add 50 to <code class="docutils literal notranslate"><span class="pre">children</span></code>, the value 50 is added to each of the items of <code class="docutils literal notranslate"><span class="pre">children</span></code>. As these items are themselves scalars or vectors, adding 50 means adding 50 to each of <em>their</em> individual items. This process continues through all levels of nesting, ensuring that 50 gets added to all the individual items of <code class="docutils literal notranslate"><span class="pre">children</span></code>. The result is therefore structurally identical to <code class="docutils literal notranslate"><span class="pre">children</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">DISPLAY</span> <span class="nv">children</span> <span class="o">+</span> <span class="m">50</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌→─────────────────────────────────────────┐
│ ┌→────┐ ┌→──────────┐ ┌→────┐    ┌→────┐ │
│ │56 52│ │85 83 76 71│ │57 57│ 53 │69 64│ │
│ └~────┘ └~──────────┘ └~────┘    └~────┘ │
└∊─────────────────────────────────────────┘
</span></div></div>
</div>
<p>One way of expressing this behaviour is to say that the scalar functions (both the dyadic and monadic ones) permeate down through the structure of nested arrays, until they reach the lowest-level items, and then apply themselves at this level. They are said to be <em><strong>pervasive</strong></em> functions.</p>
<p>Non-scalar functions, like <em>Membership</em>, are not pervasive.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">what</span> <span class="kd">←</span> <span class="m">19</span> <span class="p">(</span><span class="m">6</span> <span class="m">2</span><span class="p">)</span> <span class="m">3</span> <span class="p">(</span><span class="m">33</span> <span class="m">26</span><span class="p">)</span>
<span class="nv">what</span> <span class="o">∊</span> <span class="nv">children</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 1 0
</span></div></div>
</div>
<p>The item <code class="docutils literal notranslate"><span class="pre">(6</span> <span class="pre">2)</span></code> of <code class="docutils literal notranslate"><span class="pre">what</span></code> is also an item of <code class="docutils literal notranslate"><span class="pre">children</span></code>, hence <em>Membership</em> gives the answer 1, and the same is true for the value 3.</p>
<p>In contrast, 19 is only an item of the fifth item of <code class="docutils literal notranslate"><span class="pre">children</span></code>, it is not an <em>entire</em> item of <code class="docutils literal notranslate"><span class="pre">children</span></code>. Because a non-pervasive function processes each item as a whole, 19 is not the same as (19 14), so the answer is 0. The same goes for (33 26), which is only part of the second item of <code class="docutils literal notranslate"><span class="pre">children</span></code>.</p>
</div>
<div class="section" id="be-careful-with-shape-type-compatibility">
<span id="some-primitive-functions-be-careful-with-shapetype-compatibility"></span><h3><span class="section-number">4.7.2. </span>Be Careful With Shape/Type Compatibility<a class="headerlink" href="#be-careful-with-shape-type-compatibility" title="Permalink to this headline">¶</a></h3>
<p>It is easy to add a vector of 5 scalar items to <code class="docutils literal notranslate"><span class="pre">children</span></code>, because each of the 5 scalars can be added to the corresponding item of <code class="docutils literal notranslate"><span class="pre">children</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">children</span> <span class="o">+</span> <span class="m">10</span> <span class="m">20</span> <span class="m">30</span> <span class="m">40</span> <span class="m">50</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─────┬───────────┬─────┬──┬─────┐
│16 12│55 53 46 41│37 37│43│69 64│
└─────┴───────────┴─────┴──┴─────┘
</span></div></div>
</div>
<p>But if we try to add a vector of 5 sub-vectors to <code class="docutils literal notranslate"><span class="pre">children</span></code>, we must ensure that the shape of each sub-vector is compatible with the shape of the corresponding item of <code class="docutils literal notranslate"><span class="pre">children</span></code>, for example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">children</span> <span class="o">+</span> <span class="p">(</span><span class="m">4</span> <span class="m">8</span><span class="p">)</span> <span class="p">(</span><span class="m">5</span> <span class="m">7</span> <span class="m">4</span> <span class="m">9</span><span class="p">)</span> <span class="p">(</span><span class="m">1</span> <span class="m">¯1</span><span class="p">)</span> <span class="p">(</span><span class="m">100</span> <span class="m">200</span> <span class="m">500</span><span class="p">)</span> <span class="p">(</span><span class="m">14</span> <span class="m">51</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─────┬───────────┬───┬───────────┬─────┐
│10 10│40 40 30 30│8 6│103 203 503│33 65│
└─────┴───────────┴───┴───────────┴─────┘
</span></div></div>
</div>
<p>or</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">children</span> <span class="o">+</span> <span class="p">(</span><span class="m">4</span> <span class="m">8</span><span class="p">)</span> <span class="m">0</span> <span class="p">(</span><span class="m">1</span> <span class="m">¯1</span><span class="p">)</span> <span class="p">(</span><span class="m">100</span> <span class="m">200</span> <span class="m">500</span><span class="p">)</span> <span class="m">¯100</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─────┬───────────┬───┬───────────┬───────┐
│10 10│35 33 26 21│8 6│103 203 503│¯81 ¯86│
└─────┴───────────┴───┴───────────┴───────┘
</span></div></div>
</div>
<p>If there is any incompatibility, a <code class="docutils literal notranslate"><span class="pre">LENGTH</span> <span class="pre">ERROR</span></code> is issued:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">children</span> <span class="o">+</span> <span class="p">(</span><span class="m">1</span> <span class="m">2</span><span class="p">)(</span><span class="m">2</span> <span class="m">3</span><span class="p">)(</span><span class="m">3</span> <span class="m">4</span><span class="p">)(</span><span class="m">4</span> <span class="m">5</span><span class="p">)(</span><span class="m">5</span> <span class="m">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LENGTH ERROR: Mismatched left and right argument shapes
      children+(1 2)(2 3)(3 4)(4 5)(5 6)
              ∧
</pre></div>
</div>
</div>
</div>
<p>All of the items of our vector could have been added to the corresponding items of <code class="docutils literal notranslate"><span class="pre">children</span></code> except the second one. APL has detected and signalled this error.</p>
<p>You must also be careful if a nested or mixed array contains character data; it will not be possible to apply any arithmetic function to the array as a whole.</p>
</div>
<div class="section" id="tally">
<span id="some-primitive-functions-tally"></span><h3><span class="section-number">4.7.3. </span>Tally<a class="headerlink" href="#tally" title="Permalink to this headline">¶</a></h3>
<p>We have seen the dyadic <em>Match</em> <code class="docutils literal notranslate"><span class="pre">≡</span></code> and <em>Not Match</em> <code class="docutils literal notranslate"><span class="pre">≢</span></code> functions, and now we will see how we can use their monadic versions to work with (nested) arrays.</p>
<p>We mentioned <em><strong>Tally</strong></em> briefly in the first chapter, which is the monadic use of <code class="docutils literal notranslate"><span class="pre">≢</span></code>. <em><strong>Tally</strong></em> does exactly what its name suggests: it <em>counts</em> the amount of items an array has along its first dimension.</p>
<p>For a vector, this corresponds to its length:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≢</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≢</span> <span class="s1">&#39;ui&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2
</span></div></div>
</div>
<p>A nested vector is still a vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">4</span> <span class="m">5</span><span class="p">)</span> <span class="s1">&#39;a&#39;</span> <span class="s1">&#39;Bag&#39;</span> <span class="p">(</span><span class="m">35</span> <span class="s1">&#39;Cat&#39;</span> <span class="m">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───┬─┬───┬───────────┐
│4 5│a│Bag│┌──┬───┬──┐│
│   │ │   ││35│Cat│42││
│   │ │   │└──┴───┴──┘│
└───┴─┴───┴───────────┘
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≢</span> <span class="p">(</span><span class="m">4</span> <span class="m">5</span><span class="p">)</span> <span class="s1">&#39;a&#39;</span> <span class="s1">&#39;Bag&#39;</span> <span class="p">(</span><span class="m">35</span> <span class="s1">&#39;Cat&#39;</span> <span class="m">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4
</span></div></div>
</div>
<p>For higher dimensional arrays, <em>Tally</em> returns the size of its first dimension:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≢</span> <span class="m">3</span> <span class="m">3</span><span class="o">⍴</span><span class="m">9</span> <span class="m">8</span> <span class="m">7</span> <span class="m">6</span> <span class="m">5</span> <span class="m">4</span> <span class="m">3</span> <span class="m">2</span> <span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≢</span> <span class="m">2</span> <span class="m">5</span> <span class="m">27</span><span class="o">⍴</span><span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2
</span></div></div>
</div>
<p>For scalars, <em>Tally</em> returns 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≢</span> <span class="m">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≢</span> <span class="s1">&#39;3&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>In case you don’t think it makes sense to have the tally of a scalar return 1, consider the sequence below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≢</span> <span class="s1">&#39;abcd&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≢</span> <span class="s1">&#39;abc&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≢</span> <span class="s1">&#39;ab&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="c1">⍝≢ &#39;a&#39;    ⍝ what should this give??</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≢</span> <span class="s1">&#39;&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<p>Putting things this way, it sure looks reasonable that <code class="docutils literal notranslate"><span class="pre">≢</span> <span class="pre">'a'</span></code> give 1, right?</p>
</div>
<div class="section" id="depth">
<span id="some-primitive-functions-depth"></span><h3><span class="section-number">4.7.4. </span>Depth<a class="headerlink" href="#depth" title="Permalink to this headline">¶</a></h3>
<p>Dyadic <code class="docutils literal notranslate"><span class="pre">≡</span></code> and <code class="docutils literal notranslate"><span class="pre">≢</span></code> are very closely related, but their monadic versions aren’t. The monadic function <em><strong>Depth</strong></em> <code class="docutils literal notranslate"><span class="pre">≡</span></code> helps us work with nested arrays, in that it helps us count how many levels of nesting there are.</p>
<p>The result of <code class="docutils literal notranslate"><span class="pre">≡</span></code> is really simple to understand. First of all, the depth of a scalar is 0:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≡</span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≡</span><span class="s1">&#39;a&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≡</span><span class="m">4525324</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<p>Then, the depth of an array is 1 larger than the depth of its deepest item, or sub-array. For example, a simple vector like <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">2</span> <span class="pre">3</span> <span class="pre">4</span></code> only has scalars as items, whose depths are 0, so the depth of the vector will be 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≡</span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>Now let us consider a nested vector composed of simple vectors like the one we just saw.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">nested</span> <span class="kd">←</span> <span class="p">(</span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span><span class="p">)</span> <span class="p">(</span><span class="m">3</span> <span class="m">5</span><span class="p">)</span> <span class="p">(</span><span class="m">10</span> <span class="m">20</span> <span class="m">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───────┬───┬────────┐
│1 2 3 4│3 5│10 20 30│
└───────┴───┴────────┘
</span></div></div>
</div>
<p>The items of <code class="docutils literal notranslate"><span class="pre">nested</span></code> are vectors of depth 1, so the depth of <code class="docutils literal notranslate"><span class="pre">nested</span></code> should be 2:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≡</span><span class="nv">nested</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2
</span></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">≡</span></code> has one more thing to it: if the nesting of the sub-arrays is not uniform then the result will be negative.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">2</span> <span class="pre">3</span> <span class="pre">4</span></code> has depth 1 and <code class="docutils literal notranslate"><span class="pre">42</span></code> has depth 0, so a vector composed of these two sub-arrays has depth -2:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≡</span><span class="p">(</span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span><span class="p">)</span> <span class="m">42</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯2
</span></div></div>
</div>
</div>
</div>
<div class="section" id="reduce">
<span id="some-primitive-functions-reduce"></span><h2><span class="section-number">4.8. </span>Reduce<a class="headerlink" href="#reduce" title="Permalink to this headline">¶</a></h2>
<div class="section" id="presentation">
<span id="some-primitive-functions-presentation"></span><h3><span class="section-number">4.8.1. </span>Presentation<a class="headerlink" href="#presentation" title="Permalink to this headline">¶</a></h3>
<p>A few pages ago we calculated the costs of some purchased goods:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">costs</span> <span class="kd">←</span> <span class="nv">price</span> <span class="o">×</span> <span class="nv">qty</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">10.4 11.5 10.8 24 16.9
</span></div></div>
</div>
<p>How much did we spend?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">10.4</span> <span class="o">+</span> <span class="m">11.5</span> <span class="o">+</span> <span class="m">10.8</span> <span class="o">+</span> <span class="m">24</span> <span class="o">+</span> <span class="m">16.9</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">73.6
</span></div></div>
</div>
<p>But writing things out like this is cumbersome and depends on us looking at the scalars in the <code class="docutils literal notranslate"><span class="pre">costs</span></code> vector. What if the <code class="docutils literal notranslate"><span class="pre">price</span></code> or the <code class="docutils literal notranslate"><span class="pre">qty</span></code> changes?</p>
<p>Mathematicians are creative people who long ago devised the symbol <span class="math notranslate nohighlight">\(\sum\)</span>, always with a pretty collection of indices above and below, that is used to indicate the sum of some numbers. This symbol makes it complex to understand and is difficult to type on a keyboard.</p>
<p>In APL, the operation is written like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span> <span class="nv">costs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">73.6
</span></div></div>
</div>
<p>Simple, isn’t it? This expression gives the total of all the items in the vector. You can read this as “<em><strong>Plus Reduction</strong></em>” of the variable <code class="docutils literal notranslate"><span class="pre">costs</span></code>.</p>
<p>To gain a better understanding of the process:</p>
<p>When we write an expression such as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span> <span class="m">21</span> <span class="m">45</span> <span class="m">18</span> <span class="m">27</span> <span class="m">11</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">122
</span></div></div>
</div>
<p>it works as if we had written</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">21</span> <span class="o">+</span> <span class="m">45</span> <span class="o">+</span> <span class="m">18</span> <span class="o">+</span> <span class="m">27</span> <span class="o">+</span> <span class="m">11</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">122
</span></div></div>
</div>
<p>and we obtain the sum <code class="docutils literal notranslate"><span class="pre">122</span></code>.</p>
<p>In fact, it works as if we had “inserted” the symbol <code class="docutils literal notranslate"><span class="pre">+</span></code> between the values. But then, if we write</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">×</span><span class="na">/</span> <span class="m">21</span> <span class="m">45</span> <span class="m">18</span> <span class="m">27</span> <span class="m">11</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5051970
</span></div></div>
</div>
<p>it works as if we had written</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">21</span> <span class="o">×</span> <span class="m">45</span> <span class="o">×</span> <span class="m">18</span> <span class="o">×</span> <span class="m">27</span> <span class="o">×</span> <span class="m">11</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5051970
</span></div></div>
</div>
<p>so, we get the product <code class="docutils literal notranslate"><span class="pre">5051970</span></code>.</p>
<p>Similarly, if we write</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⌈</span><span class="na">/</span> <span class="m">21</span> <span class="m">45</span> <span class="m">18</span> <span class="m">27</span> <span class="m">11</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">45
</span></div></div>
</div>
<p>it works as if we had written</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">21</span> <span class="o">⌈</span> <span class="m">45</span> <span class="o">⌈</span> <span class="m">18</span> <span class="o">⌈</span> <span class="m">27</span> <span class="o">⌈</span> <span class="m">11</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">45
</span></div></div>
</div>
<p>so, we get the maximum <code class="docutils literal notranslate"><span class="pre">45</span></code>. And so on for other functions we put to the left of <code class="docutils literal notranslate"><span class="pre">/</span></code>.</p>
<div class="hint admonition">
<p class="admonition-title">Exercise</p>
<p>Try to evaluate the following expression in your head or with pen and paper: <code class="docutils literal notranslate"><span class="pre">23⌈</span> <span class="pre">⌈</span> <span class="pre">⌈/</span> <span class="pre">17.81</span> <span class="pre">21.41</span> <span class="pre">9.34</span> <span class="pre">16.53</span></code></p>
<p>Don’t panic! Remember to evaluate it symbol by symbol, from right to left.</p>
</div>
</div>
<div class="section" id="definition">
<span id="some-primitive-functions-definition"></span><h3><span class="section-number">4.8.2. </span>Definition<a class="headerlink" href="#definition" title="Permalink to this headline">¶</a></h3>
<p>Reduce, represented by the symbol <code class="docutils literal notranslate"><span class="pre">/</span></code>, belongs to a special category of symbols called <em><strong>Operators</strong></em>.</p>
<p>In most programming languages the word <em>operator</em> is used to describe operations like addition, subtraction, multiplication, and so on. In APL such operations are called <em>Functions</em>; typical examples are <code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">×</span></code> and <code class="docutils literal notranslate"><span class="pre">⍴</span></code>. The word <em>operator</em> has a separate meaning in APL.</p>
<p>In APL a <em><strong>function</strong></em> works on an <strong>array</strong> or between two arrays to produce a result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">price</span> <span class="o">×</span> <span class="nv">qty</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">10.4 11.5 10.8 24 16.9
</span></div></div>
</div>
<p>Whereas an <em><strong>operator</strong></em> applies to one or two <em><strong>operands</strong></em> (its “arguments”) to produce what we call a <em>derived function</em>. That is, after we use the <em>operator</em> on its <em>operands</em>, we get a (derived) function which may then be used with an array, or between two arrays, to produce a result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">  /
┌─┘
+  
</span></div></div>
</div>
<p>This is the representation APL gives to the <em>Plus Reduction</em>, where the tree-like structure shows that <code class="docutils literal notranslate"><span class="pre">+</span></code> is an operand to <code class="docutils literal notranslate"><span class="pre">/</span></code>. We may then use this derived function with an array in order to get a result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">stock</span> <span class="kd">←</span> <span class="o">+</span><span class="na">/</span> <span class="nv">qty</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">14
</span></div></div>
</div>
<p>In the expression above, the symbol <code class="docutils literal notranslate"><span class="pre">/</span></code> is the operator. It takes the function <code class="docutils literal notranslate"><span class="pre">+</span></code> as its single operand (similar to how we give arguments to functions) and produces the derived function <code class="docutils literal notranslate"><span class="pre">+/</span></code>. This derived function is then applied to <code class="docutils literal notranslate"><span class="pre">qty</span></code>, giving a result which is assigned to <code class="docutils literal notranslate"><span class="pre">stock</span></code> and displayed with <code class="docutils literal notranslate"><span class="pre">⊢</span></code>.</p>
<p>Please note that the argument to a monadic function is always to the right of the function, whereas the function applied to a monadic operator (its operand) is always to the left of the operator.</p>
<p>All of the APL primitive functions may be used as the operand to <em>Reduction</em>; you can even apply a dyadic user-defined function. This generality makes Reduction, and other operators, extremely powerful.</p>
<p>Dyalog APL provides a total of around 20 such powerful <em>operators</em>, listed in <a class="reference internal" href="Appendices.html#appendices-dyalog-apl-operators"><span class="std std-numref">Section 6.3</span></a>. It is also possible to write your own operators, just as it is possible to write your own functions.</p>
</div>
<div class="section" id="reduction-of-binary-data">
<span id="some-primitive-functions-reduction-of-binary-data"></span><h3><span class="section-number">4.8.3. </span>Reduction of Binary Data<a class="headerlink" href="#reduction-of-binary-data" title="Permalink to this headline">¶</a></h3>
<p>Among the typical usages of <em>Reduction</em> are <code class="docutils literal notranslate"><span class="pre">∧</span></code> and <code class="docutils literal notranslate"><span class="pre">∨</span></code> applied to binary data.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">∧/</span> <span class="pre">bin</span></code> gives the result <code class="docutils literal notranslate"><span class="pre">1</span></code> if <em><strong>All</strong></em> the items of <code class="docutils literal notranslate"><span class="pre">bin</span></code> are equal to 1;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">∨/</span> <span class="pre">bin</span></code> gives the result <code class="docutils literal notranslate"><span class="pre">1</span></code> if <em><strong>At least one</strong></em> of the items of <code class="docutils literal notranslate"><span class="pre">bin</span></code> is equal to 1;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">+/</span> <span class="pre">bin</span></code> tells us <em><strong>How many</strong></em> items of <code class="docutils literal notranslate"><span class="pre">bin</span></code> are equal to 1.</p></li>
</ul>
<p>You can verify it on some small examples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">bin</span> <span class="kd">←</span> <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 1 1 0 1 0 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">∧</span><span class="na">/</span> <span class="nv">bin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">∨</span><span class="na">/</span> <span class="nv">bin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span> <span class="nv">bin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">allOnes</span> <span class="kd">←</span> <span class="m">1</span><span class="o">∨</span><span class="nv">bin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 1 1 1 1 1 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">∧</span><span class="na">/</span> <span class="nv">allOnes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>Let us revisit a vector named <code class="docutils literal notranslate"><span class="pre">contents</span></code> (from <a class="reference internal" href="Data-and-Variables.html#data-and-variables-data-and-variables"><span class="std std-numref">Section 3</span></a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">contents</span> <span class="kd">←</span> <span class="m">12</span> <span class="m">56</span> <span class="m">78</span> <span class="m">74</span> <span class="m">85</span> <span class="m">96</span> <span class="m">30</span> <span class="m">22</span> <span class="m">44</span> <span class="m">66</span> <span class="m">82</span> <span class="m">27</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12 56 78 74 85 96 30 22 44 66 82 27
</span></div></div>
</div>
<p>Now we will answer some questions about the values of the items of <code class="docutils literal notranslate"><span class="pre">contents</span></code>:</p>
<p>Are all the values greater than 20?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">∧</span><span class="na">/</span> <span class="nv">contents</span> <span class="o">&gt;</span> <span class="m">20</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<p>The answer is no.</p>
<p>Is there at least one value smaller than 30?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">∨</span><span class="na">/</span> <span class="nv">contents</span> <span class="o">&lt;</span> <span class="m">30</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>The answer is yes.</p>
<p>How many values are smaller than 30?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span> <span class="nv">contents</span> <span class="o">&lt;</span> <span class="m">30</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3
</span></div></div>
</div>
<p>The answer is 3.</p>
</div>
<div class="section" id="reduction-of-nested-arrays">
<span id="some-primitive-functions-reduction-of-nested-arrays"></span><h3><span class="section-number">4.8.4. </span>Reduction of Nested Arrays<a class="headerlink" href="#reduction-of-nested-arrays" title="Permalink to this headline">¶</a></h3>
<p>When you apply reduction to a nested array, you must check that the items of the nested array are compatible (in shape and type) with the function that you intend to apply:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span> <span class="p">(</span><span class="m">4</span> <span class="m">8</span><span class="p">)</span> <span class="p">(</span><span class="m">1</span> <span class="m">4</span><span class="p">)</span> <span class="m">10</span> <span class="p">(</span><span class="m">9</span> <span class="m">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─────┐
│24 27│
└─────┘
</span></div></div>
</div>
<p>The expression above works because all 2-item vectors can be added together, and a single scalar (the 10) can be added to an array of any shape, because <code class="docutils literal notranslate"><span class="pre">+</span></code> is a scalar function.</p>
<p>Notice, however, that in the expression below the 3-item vector cannot be added to the other 2-item vectors, so APL reports an error:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span> <span class="p">(</span><span class="m">4</span> <span class="m">8</span><span class="p">)</span> <span class="p">(</span><span class="m">1</span> <span class="m">4</span><span class="p">)</span> <span class="p">(</span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span><span class="p">)</span> <span class="p">(</span><span class="m">9</span> <span class="m">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LENGTH ERROR: Mismatched left and right argument shapes
      +/(4 8)(1 4)(1 2 3)(9 5)
      ∧
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="reduction-with-noncommutative-functions">
<span id="some-primitive-functions-reduction-with-noncommutative-functions"></span><h3><span class="section-number">4.8.5. </span>Reduction With Noncommutative Functions<a class="headerlink" href="#reduction-with-noncommutative-functions" title="Permalink to this headline">¶</a></h3>
<p>Another thing to be careful about is the use of reduction with noncommutative functions, like <code class="docutils literal notranslate"><span class="pre">-</span></code> or <code class="docutils literal notranslate"><span class="pre">÷</span></code>. Reducing an array by such a function yields results which may be counter-intuitive, but which may nevertheless be useful in a number of applications.</p>
<p>For example, remember that</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="na">/</span> <span class="m">45</span> <span class="m">9</span> <span class="m">11</span> <span class="m">2</span> <span class="m">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">50
</span></div></div>
</div>
<p>is equivalent to</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">45</span> <span class="o">-</span> <span class="m">9</span> <span class="o">-</span> <span class="m">11</span> <span class="o">-</span> <span class="m">2</span> <span class="o">-</span> <span class="m">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">50
</span></div></div>
</div>
<p>which, by APL’s order of evaluation is equivalent to:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">45</span> <span class="o">-</span> <span class="p">(</span><span class="m">9</span> <span class="o">-</span> <span class="p">(</span><span class="m">11</span> <span class="o">-</span> <span class="p">(</span><span class="m">2</span> <span class="o">-</span> <span class="m">5</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">50
</span></div></div>
</div>
<p>If, instead, we use the traditional mathematical convention that interprets</p>
<div class="math notranslate nohighlight">
\[45 - 9 - 11 - 2 - 5\]</div>
<p>as</p>
<div class="math notranslate nohighlight">
\[(((45 - 9) - 11) - 2) - 5\]</div>
<p>we get the result 18.</p>
<p>This kind of “alternating series” can be useful for some calculations, although only rarely for business applications.</p>
</div>
<div class="section" id="application-1">
<span id="some-primitive-functions-application-1"></span><h3><span class="section-number">4.8.6. </span>Application 1<a class="headerlink" href="#application-1" title="Permalink to this headline">¶</a></h3>
<p>The employees of a company are divided into three hierarchical categories, denoted simply 1, 2 and 3. Two variables contain the salaries and the categories of these employees; we define them below and then use <code class="docutils literal notranslate"><span class="pre">⍴</span></code> to show some of their initial values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕RL</span> <span class="kd">←</span> <span class="m">73</span>
<span class="nv">salaries</span> <span class="kd">←</span> <span class="o">?</span><span class="m">100</span><span class="o">⍴</span><span class="m">5000</span>
<span class="m">10</span><span class="o">⍴</span><span class="nv">salaries</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2121 4778 4914 3139 4561 221 1252 1530 4475 332
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕RL</span> <span class="kd">←</span> <span class="m">73</span>
<span class="nv">categories</span> <span class="kd">←</span> <span class="o">?</span><span class="m">100</span><span class="o">⍴</span><span class="m">3</span>
<span class="m">10</span><span class="o">⍴</span><span class="nv">categories</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 2 2 3 3 1 1 1 1
</span></div></div>
</div>
<p>We can see the salaries of the first three employees are, respectively, 2121, 4778 and 4914 (of some currency) and their respective categories are 1, 2 and 2.</p>
<p>With what we learned in <a class="reference internal" href="#some-primitive-functions-reduction-of-binary-data"><span class="std std-numref">Section 4.8.3</span></a> we can also find out how many employees belong in the third category:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span> <span class="nv">categories</span> <span class="o">=</span> <span class="m">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">32
</span></div></div>
</div>
<p>Now the employees ask for an increase in their salaries. Each category of employee requests a different percentage increase, as shown in the following table:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Category</p></th>
<th class="text-align:center head"><p>Upgrade</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>8%</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>5%</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>3</p></td>
<td class="text-align:center"><p>2%</p></td>
</tr>
</tbody>
</table>
<p>How much is that going to cost the company?</p>
<p>Let us just create a variable containing the three rates shown above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">rates</span> <span class="kd">←</span> <span class="m">8</span> <span class="m">5</span> <span class="m">2</span> <span class="o">÷</span> <span class="m">100</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.08 0.05 0.02
</span></div></div>
</div>
<p>The first employee is in category 1, so the rate that applies to this person is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">rates</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.08
</span></div></div>
</div>
<p>More generally, the rates applied to all of our employees can easily be obtained with <code class="docutils literal notranslate"><span class="pre">rates[categories]</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">10</span><span class="o">⍴</span><span class="nv">rates</span><span class="sr">[</span><span class="nv">categories</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.08 0.05 0.05 0.05 0.02 0.02 0.08 0.08 0.08 0.08
</span></div></div>
</div>
<p>Having the rates, we only have to multiply them by the salaries to obtain the individual increases:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">10</span><span class="o">⍴</span> <span class="nv">salaries</span> <span class="o">×</span> <span class="nv">rates</span><span class="sr">[</span><span class="nv">categories</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">169.68 238.9 245.7 156.95 91.22 4.42 100.16 122.4 358 26.56
</span></div></div>
</div>
<p>Finally, by adding them all together, we discover how much it will cost the company:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span> <span class="nv">salaries</span> <span class="o">×</span> <span class="nv">rates</span><span class="sr">[</span><span class="nv">categories</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12070.6
</span></div></div>
</div>
<p>Note that:</p>
<ul class="simple">
<li><p>the expression remains valid regardless of the number of employees or categories;</p></li>
<li><p>the result has been obtained without writing a program (no loops, no tests);</p></li>
<li><p>this expression can be phrased in the simplest possible English, namely:</p></li>
</ul>
<blockquote>
<div><p><em>Sum the salaries multiplied by rates according to categories</em></p>
</div></blockquote>
<p>This illustrates how the implementation of a solution in APL can be very close to the way that the solution would be expressed in everyday language. It also shows the advantage of not having to deal with trivial and “irrelevant” matters such as looping, memory allocation, declarations, etc. before a working solution can be developed.</p>
</div>
<div class="section" id="application-2">
<span id="some-primitive-functions-application-2"></span><h3><span class="section-number">4.8.7. </span>Application 2<a class="headerlink" href="#application-2" title="Permalink to this headline">¶</a></h3>
<p>Imagine now that we want to calculate the average of a set of values, for example the values contained in the variable <code class="docutils literal notranslate"><span class="pre">contents</span></code>.</p>
<p>To do that, we must:</p>
<ul class="simple">
<li><p>add all the values:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span> <span class="nv">contents</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">672
</span></div></div>
</div>
<ul class="simple">
<li><p>count how many values we have:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≢</span><span class="nv">contents</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12
</span></div></div>
</div>
<ul class="simple">
<li><p>divide one by the other:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">+</span><span class="na">/</span><span class="nv">contents</span><span class="p">)</span> <span class="o">÷</span> <span class="p">(</span><span class="o">≢</span><span class="nv">contents</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">56
</span></div></div>
</div>
<p>The result is 56.</p>
<p>Again, because of APL’s simple rule for the order of evaluation, the rightmost set of parentheses could be omitted.</p>
</div>
</div>
<div class="section" id="axis-specification">
<span id="some-primitive-functions-axis-specification"></span><h2><span class="section-number">4.9. </span>Axis Specification<a class="headerlink" href="#axis-specification" title="Permalink to this headline">¶</a></h2>
<div class="section" id="totals-in-an-array">
<span id="some-primitive-functions-totals-in-an-array"></span><h3><span class="section-number">4.9.1. </span>Totals in an Array<a class="headerlink" href="#totals-in-an-array" title="Permalink to this headline">¶</a></h3>
<div class="section" id="processing-arrays">
<span id="some-primitive-functions-processing-arrays"></span><h4><span class="section-number">4.9.1.1. </span>Processing Arrays<a class="headerlink" href="#processing-arrays" title="Permalink to this headline">¶</a></h4>
<p>We have seen the result of applying reduction to vectors, but what about matrices and higher rank arrays?</p>
<p>As an example, let us recall the array <code class="docutils literal notranslate"><span class="pre">prod</span></code>. Its three dimensions represent respectively:</p>
<ol class="simple">
<li><p>  5 years;</p></li>
<li><p>  2 assembly lines;</p></li>
<li><p>  12 months.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕RL</span> <span class="kd">←</span> <span class="m">73</span>
<span class="o">⊢</span><span class="nv">prod</span> <span class="kd">←</span> <span class="o">?</span><span class="m">5</span> <span class="m">2</span> <span class="m">12</span><span class="o">⍴</span><span class="m">50</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 9 16 42 50  2  3 11 45 17 37 29 36
34 19 32 12 37 15 46 24 49 28 36  9

29  5 45 23 27  4 23 16 39 22 22  2
46 20 47 17 18 25 13 38 42 38 45 28

37 19  5 10 30 49 16 18 46 47 47  3
39 23 41 20  6 40 21 22 40 49 20  1

13 36 12 40 12 15 24 20 21 12 19 25
 8 48 22 37 33  1 39 30 50 50  8 35

38 31 24 40 23  7 20 34 35  6 19 27
41  1 14 50 17 42  6 35 12 48 30 29
</span></div></div>
</div>
<p>We can calculate totals along any of these 3 dimensions: years, lines and months.</p>
<p>We specify the dimension (or <em><strong>Axis</strong></em>) between brackets after the <em>Reduce</em> symbol:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span><span class="sr">[</span><span class="nv">axis</span><span class="sr">]</span> <span class="nv">prod</span>
</pre></div>
</div>
<p>For example, suppose we want to calculate the total monthly production values over the 5 years. Years are represented by the 1st dimension of <code class="docutils literal notranslate"><span class="pre">prod</span></code>, so we write:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span> <span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">126 107 128 163  94  78  94 133 158 124 136  93
168 111 156 136 111 123 125 149 193 213 139 102
</span></div></div>
</div>
<p>We obtain a 2 by 12 matrix, giving the production of the 2 assembly lines, month by month. If we were to divide this matrix by 5, we would get the average production for each month, per assembly line.</p>
<p>Now, let us add up the production numbers of the two assembly lines. Lines are represented by the 2nd dimension of <code class="docutils literal notranslate"><span class="pre">prod</span></code>, so we write:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span> <span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">43 35 74 62 39 18 57 69 66 65 65 45
75 25 92 40 45 29 36 54 81 60 67 30
76 42 46 30 36 89 37 40 86 96 67  4
21 84 34 77 45 16 63 50 71 62 27 60
79 32 38 90 40 49 26 69 47 54 49 56
</span></div></div>
</div>
<p>We obtain a 5 by 12 matrix, with the total production of both assembly lines, month by month, in each of the 5 years.</p>
<p>And finally, let us calculate the annual production of each assembly line. Months are represented by the 3rd dimension of <code class="docutils literal notranslate"><span class="pre">prod</span></code>, so we write:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span><span class="sr">[</span><span class="m">3</span><span class="sr">]</span> <span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">297 341
257 377
327 322
249 361
304 325
</span></div></div>
</div>
<p>The result is a 5 by 2 matrix, in which the columns contain the annual production of the two assembly lines in each of the five years.</p>
</div>
<div class="section" id="axis-is-like-an-operator">
<span id="some-primitive-functions-axis-is-like-an-operator"></span><h4><span class="section-number">4.9.1.2. </span>Axis Is Like an Operator<a class="headerlink" href="#axis-is-like-an-operator" title="Permalink to this headline">¶</a></h4>
<p>The dimension specified within brackets is the axis along which the function is applied.</p>
<p>This produces a derived function, and for this reason, the pair of <em>Axis</em> brackets is often called the <em><strong>Axis Operator</strong></em>.</p>
<p>The syntax for <em>Axis</em> does not quite follow the general syntax for operators, but it shares all other properties with genuine operators. <em>Axis</em> takes a function as its left operand (the derived function <code class="docutils literal notranslate"><span class="pre">+/</span></code> in the last example above), the dimension specification as its “right operand” (3 in the example), and produces a derived function, which is applied to <code class="docutils literal notranslate"><span class="pre">prod</span></code> to calculate the annual sums.</p>
<p>Viewed as an operator <em>Axis</em> is therefore dyadic. It is, however, important to emphasise that its “right” operand is not <code class="docutils literal notranslate"><span class="pre">prod</span></code>, it is the expression within the brackets. This is the first example of an operator that takes an array as an operand. We will find some more as we explore operators later on.</p>
</div>
<div class="section" id="id1">
<span id="id2"></span><h4><span class="section-number">4.9.1.3. </span>Processing Arrays<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>We shall learn more about <em>Axis</em> in <span class="xref myst">the “Operators” chapter</span>; let us first explore another simple use of this operator.</p>
<p>Suppose that we would like to multiply each of the rows (or columns) of a matrix by different values; we can use <em>Axis</em> to specify whether we multiply row-wise or column-wise. First, here is a matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕RL</span> <span class="kd">←</span> <span class="m">73</span>
<span class="o">⊢</span><span class="nv">tam</span> <span class="kd">←</span> <span class="o">?</span><span class="m">3</span> <span class="m">5</span><span class="o">⍴</span><span class="m">9</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">9 2 2 3 1
5 4 2 3 3
5 8 4 1 4
</span></div></div>
</div>
<p>Let us multiply row-wise:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">tam</span><span class="o">×</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="m">5</span> <span class="m">2</span> <span class="m">10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">45 10 10 15  5
10  8  4  6  6
50 80 40 10 40
</span></div></div>
</div>
<p>And now column-wise:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">tam</span><span class="o">×</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="m">2</span> <span class="m">5</span> <span class="m">0</span> <span class="m">2</span> <span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">18 10 0 6 1
10 20 0 6 3
10 40 0 2 4
</span></div></div>
</div>
</div>
</div>
<div class="section" id="the-shape-of-the-result">
<span id="some-primitive-functions-the-shape-of-the-result"></span><h3><span class="section-number">4.9.2. </span>The Shape of the Result<a class="headerlink" href="#the-shape-of-the-result" title="Permalink to this headline">¶</a></h3>
<p>The dimensions of <code class="docutils literal notranslate"><span class="pre">prod</span></code> are</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 2 12
</span></div></div>
</div>
<p>and we can see that the dimensions of <code class="docutils literal notranslate"><span class="pre">+/[1]prod</span></code>, <code class="docutils literal notranslate"><span class="pre">+/[2]prod</span></code> and <code class="docutils literal notranslate"><span class="pre">+/[3]prod</span></code> depend on this shape. In fact, when the axis is 1, the shape of the result is the original shape without the 1st item:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴+</span><span class="na">/</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 12
</span></div></div>
</div>
<p>When the axis is 2, the shape of the result is the original shape without the 2nd item:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴+</span><span class="na">/</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 12
</span></div></div>
</div>
<p>And when the axis is 3, the shape of the result is the original shape without the 3rd item:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴+</span><span class="na">/</span><span class="sr">[</span><span class="m">3</span><span class="sr">]</span><span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 2
</span></div></div>
</div>
<p>You can see that <em>Reduction</em> of a 3-D array gives a 2-D array, in which the summed dimension has “disappeared”. This is the origin of the term “<em>Reduce</em>”; it <em>reduces</em> the <em>rank</em> of the array.</p>
<p>This rule will help you predict the dimensions of the result of a reduction.</p>
<div class="tip admonition">
<p class="admonition-title">Rule</p>
<p>When <em><strong>Reduce</strong></em> is applied along the Nth dimension of an array, the shape of the result is the same shape of the array, but without its Nth item.</p>
<p>The <em><strong>Rank</strong></em> of the result is 1 less than the rank of the original array.</p>
</div>
<p>Whenever you want to calculate the sum along a particular dimension of an array, think of the dimensions in terms of concrete things: years, lines, months, etc. This should help you.</p>
</div>
<div class="section" id="special-notations">
<span id="some-primitive-functions-special-notations"></span><h3><span class="section-number">4.9.3. </span>Special Notations<a class="headerlink" href="#special-notations" title="Permalink to this headline">¶</a></h3>
<p>By default, if no axis is specified, reduction is applied along the <strong>last</strong> dimension of the array.</p>
<p>This means <code class="docutils literal notranslate"><span class="pre">+/prod</span></code> and <code class="docutils literal notranslate"><span class="pre">+/[3]prod</span></code> are the same,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">+</span><span class="na">/</span><span class="nv">prod</span><span class="p">)</span><span class="o">≡</span><span class="p">(</span><span class="o">+</span><span class="na">/</span><span class="sr">[</span><span class="m">3</span><span class="sr">]</span><span class="nv">prod</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>much like <code class="docutils literal notranslate"><span class="pre">+/forecast</span></code> and <code class="docutils literal notranslate"><span class="pre">+/[2]forecast</span></code> are the same:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">+</span><span class="na">/</span><span class="nv">forecast</span><span class="p">)</span><span class="o">≡</span><span class="p">(</span><span class="o">+</span><span class="na">/</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="nv">forecast</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>But it is also common to work along the first dimension of an array. For this reason, APL includes a special symbol for reduction along the first dimension: <code class="docutils literal notranslate"><span class="pre">⌿</span></code> (you can type it with <kbd>APL</kbd>+<kbd>/</kbd>).</p>
<p>This means <code class="docutils literal notranslate"><span class="pre">+⌿prod</span></code> and <code class="docutils literal notranslate"><span class="pre">+/[1]prod</span></code> are the same,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">+</span><span class="na">⌿</span><span class="nv">prod</span><span class="p">)</span><span class="o">≡</span><span class="p">(</span><span class="o">+</span><span class="na">/</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="nv">prod</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>much like <code class="docutils literal notranslate"><span class="pre">+⌿forecast</span></code> and <code class="docutils literal notranslate"><span class="pre">+/[1]forecast</span></code> are the same:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">+</span><span class="na">⌿</span><span class="nv">forecast</span><span class="p">)</span><span class="o">≡</span><span class="p">(</span><span class="o">+</span><span class="na">/</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="nv">forecast</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>If one specifies an axis after the symbol <code class="docutils literal notranslate"><span class="pre">/</span></code> or <code class="docutils literal notranslate"><span class="pre">⌿</span></code>, the function is applied along the specified <em>Axis</em>, regardless of the symbol that is actually used.</p>
</div>
<p>We demonstrate this note with two examples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">+</span><span class="na">⌿</span><span class="sr">[</span><span class="m">3</span><span class="sr">]</span><span class="nv">prod</span><span class="p">)</span><span class="o">≡</span><span class="p">(</span><span class="o">+</span><span class="na">/</span><span class="sr">[</span><span class="m">3</span><span class="sr">]</span><span class="nv">prod</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">+</span><span class="na">⌿</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="nv">forecast</span><span class="p">)</span><span class="o">≡</span><span class="p">(</span><span class="o">+</span><span class="na">/</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="nv">forecast</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
</div>
</div>
<div class="section" id="our-first-program">
<span id="some-primitive-functions-our-first-program"></span><h2><span class="section-number">4.10. </span>Our First Program<a class="headerlink" href="#our-first-program" title="Permalink to this headline">¶</a></h2>
<p>The expression we wrote in <a class="reference internal" href="#some-primitive-functions-application-2"><span class="std std-numref">Section 4.8.7</span></a> to calculate the average of a set of values is one that we may want to use time and time again. So let us store it as a program, or, to use the proper APL terminology, as a <em><strong>User Defined Function</strong></em>.</p>
<p>There are many different ways to define functions, and these will be covered in detail in <a class="reference internal" href="User-Defined-Functions.html"><span class="doc std std-doc">the “User Defined Functions” chapter</span></a>. For now we shall use the simplest, which is perfectly suitable for straightforward calculation functions like this one. Let’s type:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">Average</span> <span class="kd">←</span> <span class="kt">{</span><span class="p">(</span><span class="o">+</span><span class="na">/</span><span class="bp">⍵</span><span class="p">)</span><span class="o">÷</span><span class="p">(</span><span class="o">≢</span><span class="bp">⍵</span><span class="p">)</span><span class="kt">}</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Average</span></code> is the name of the function. It is followed by the definition, delimited by a pair of curly braces <code class="docutils literal notranslate"><span class="pre">{</span></code> and <code class="docutils literal notranslate"><span class="pre">}</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">⍵</span></code> is a generic symbol that represents the array that will be passed as the right argument of the function;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">⍺</span></code> is a generic symbol that represents the array that will be passed as the left argument of the function, if any.</p></li>
</ul>
<p>The symbols <code class="docutils literal notranslate"><span class="pre">⍵</span></code> and <code class="docutils literal notranslate"><span class="pre">⍺</span></code> are obtained using <kbd>APL</kbd>+<kbd>w</kbd> and <kbd>APL</kbd>+<kbd>a</kbd>, respectively.</p>
<p>For more complex multi-line functions it is obviously more appropriate to use a text editor. However, this is beyond the scope of this chapter.</p>
<p>Once defined, this function may be invoked directly, just as if it were a built-in (<em>primitive</em>) function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">Average</span> <span class="nv">salaries</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2415.69
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">Average</span> <span class="m">12</span> <span class="m">74</span> <span class="m">56</span> <span class="m">23</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">41.25
</span></div></div>
</div>
<p>The word <code class="docutils literal notranslate"><span class="pre">Average</span></code> can now be used in any APL expression. We have enriched the vocabulary which can be used to process data in this workspace (provided that we save it).</p>
<p>Be patient: we shall see many other possibilities in <a class="reference internal" href="User-Defined-Functions.html"><span class="doc std std-doc">the “User Defined Functions” chapter</span></a>.</p>
</div>
<div class="section" id="concatenate">
<span id="some-primitive-functions-concatenate"></span><h2><span class="section-number">4.11. </span>Concatenate<a class="headerlink" href="#concatenate" title="Permalink to this headline">¶</a></h2>
<p><em><strong>Concatenate</strong></em> is a dyadic function which joins two arrays together. It is represented by comma (<code class="docutils literal notranslate"><span class="pre">,</span></code>). The function name is normally abbreviated to <em><strong>Catenate</strong></em>, and we will use both terms.</p>
<div class="section" id="concatenating-vectors">
<span id="some-primitive-functions-concatenating-vectors"></span><h3><span class="section-number">4.11.1. </span>Concatenating Vectors<a class="headerlink" href="#concatenating-vectors" title="Permalink to this headline">¶</a></h3>
<p><em>Catenate</em> is easy to understand:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">X</span> <span class="kd">←</span> <span class="m">24</span> <span class="m">15</span> <span class="m">67</span> <span class="m">89</span>
<span class="nv">Y</span> <span class="kd">←</span> <span class="m">11</span> <span class="m">33</span> <span class="m">75</span>
<span class="nv">X</span><span class="o">,</span><span class="nv">Y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">24 15 67 89 11 33 75
</span></div></div>
</div>
<p>It is like joining two sentences together, so it is easy to remember which symbol to use. You can see that the length of the result (<code class="docutils literal notranslate"><span class="pre">≢(X,Y)</span></code>) is equal to the sum of the lengths of the arguments (<code class="docutils literal notranslate"><span class="pre">(≢X)</span> <span class="pre">+</span> <span class="pre">(≢Y)</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="o">≢</span><span class="nv">X</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">≢</span><span class="nv">Y</span><span class="p">))</span><span class="o">=≢</span><span class="nv">X</span><span class="o">,</span><span class="nv">Y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>Character strings are processed in the same way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">C</span> <span class="kd">←</span> <span class="s1">&#39;Tell me&#39;</span>
<span class="nv">D</span> <span class="kd">←</span> <span class="s1">&#39;More&#39;</span>
<span class="nv">C</span><span class="o">,</span><span class="nv">D</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">Tell meMore
</span></div></div>
</div>
<p>Note that there is no space inserted between the contents of the two vectors, just like there was no number inserted between <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">Y</span></code> when we concatenated them above. When we concatenate a vector of 7 characters (like <code class="docutils literal notranslate"><span class="pre">C</span></code>) with a vector of 4 characters (like <code class="docutils literal notranslate"><span class="pre">D</span></code>), the result must have 11 characters.</p>
<p>When you concatenate an empty vector to another vector, the result is the same as the original. Let us define an empty numeric vector <code class="docutils literal notranslate"><span class="pre">v</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">v</span> <span class="kd">←</span> <span class="m">0</span><span class="o">⍴</span><span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">
</span></div></div>
</div>
<p>We could use <code class="docutils literal notranslate"><span class="pre">⍬</span></code> instead.</p>
<p>Notice how the numeric vector <code class="docutils literal notranslate"><span class="pre">X</span></code> remains unchanged:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">X</span><span class="o">,</span><span class="nv">v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">24 15 67 89
</span></div></div>
</div>
<p>Similarly, concatenating character strings with <code class="docutils literal notranslate"><span class="pre">''</span></code> does nothing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">C</span><span class="o">,</span><span class="s1">&#39;&#39;</span><span class="o">,</span><span class="nv">D</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">Tell meMore
</span></div></div>
</div>
</div>
<div class="section" id="concatenating-other-arrays">
<span id="some-primitive-functions-concatenating-other-arrays"></span><h3><span class="section-number">4.11.2. </span>Concatenating Other Arrays<a class="headerlink" href="#concatenating-other-arrays" title="Permalink to this headline">¶</a></h3>
<p>It is possible to concatenate two arrays if their shapes are compatible. The axis along which the concatenation is to be performed must be specified, if it is different from the default.</p>
<p>Let us use three matrices <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">A</span> <span class="kd">←</span> <span class="m">3</span> <span class="m">4</span> <span class="o">⍴</span> <span class="s1">&#39;A&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">AAAA
AAAA
AAAA
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">B</span> <span class="kd">←</span> <span class="m">2</span> <span class="m">4</span> <span class="o">⍴</span> <span class="s1">&#39;B&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">BBBB
BBBB
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">C</span> <span class="kd">←</span> <span class="m">3</span> <span class="m">3</span> <span class="o">⍴</span> <span class="s1">&#39;C&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">CCC
CCC
CCC
</span></div></div>
</div>
<p>The possible concatenations are:</p>
<ul class="simple">
<li><p>the vertical concatenation of <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>:</p></li>
</ul>
<div class="figure align-default" id="vertical-concatenation-ab">
<span id="fig-vertical-concatenation-ab"></span><img alt="_images/Vertical_Concatenation_AB.png" src="_images/Vertical_Concatenation_AB.png" />
<p class="caption"><span class="caption-number">Fig. 4.4 </span><span class="caption-text">Matrices <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> concatenated together vertically.</span><a class="headerlink" href="#vertical-concatenation-ab" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>and the horizontal concatenation of <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code>:</p></li>
</ul>
<div class="figure align-default" id="horizontal-concatenation-ac">
<span id="fig-horizontal-concatenation-ac"></span><img alt="_images/Horizontal_Concatenation_AC.png" src="_images/Horizontal_Concatenation_AC.png" />
<p class="caption"><span class="caption-number">Fig. 4.5 </span><span class="caption-text">Matrices <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code> concatenated together horizontally.</span><a class="headerlink" href="#horizontal-concatenation-ac" title="Permalink to this image">¶</a></p>
</div>
<p>It is not possible to concatenate <code class="docutils literal notranslate"><span class="pre">B</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code> because none of their dimensions are compatible.</p>
<p>To concatenate vertically, we want the two matrices to be stacked on top of each other, creating a matrix with more <em>rows</em>, i.e. we want to create a matrix with a larger 1st dimension:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="nv">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">AAAA
AAAA
AAAA
BBBB
BBBB
</span></div></div>
</div>
<p>The shape of the result is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="nv">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 4
</span></div></div>
</div>
<p>and writing</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">B</span><span class="o">,</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="nv">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">BBBB
BBBB
AAAA
AAAA
AAAA
</span></div></div>
</div>
<p>puts <code class="docutils literal notranslate"><span class="pre">B</span></code> on top of <code class="docutils literal notranslate"><span class="pre">A</span></code> instead.</p>
<p>Similarly, to stack matrices <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code> horizontally we create a matrix where the 2nd dimension is larger:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="nv">C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">AAAACCC
AAAACCC
AAAACCC
</span></div></div>
</div>
<p>The shape of the result is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="nv">C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 7
</span></div></div>
</div>
<p>and writing</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">C</span><span class="o">,</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="nv">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">CCCAAAA
CCCAAAA
CCCAAAA
</span></div></div>
</div>
<p>puts <code class="docutils literal notranslate"><span class="pre">C</span></code> to the left of <code class="docutils literal notranslate"><span class="pre">A</span></code> instead.</p>
<p>In the same way as for <em>Reduce</em>, the <em>Axis</em> operator indicates which dimension will change during the operation, as we can see by inspecting the shapes of <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>, <code class="docutils literal notranslate"><span class="pre">C</span></code> and the stacked matrices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 4
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 4
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="nv">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 4
</span></div></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">,[1]</span></code>changes the 1st dimension.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">,[2]</span></code> instead, we change the 2nd dimension:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 4
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="nv">C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 7
</span></div></div>
</div>
<p>The following nested array shows the four possible different catenations side by side:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="nv">B</span><span class="p">)</span> <span class="p">(</span><span class="nv">B</span><span class="o">,</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="nv">A</span><span class="p">)</span> <span class="p">(</span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="nv">C</span><span class="p">)</span> <span class="p">(</span><span class="nv">C</span><span class="o">,</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="nv">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌────┬────┬───────┬───────┐
│AAAA│BBBB│AAAACCC│CCCAAAA│
│AAAA│BBBB│AAAACCC│CCCAAAA│
│AAAA│AAAA│AAAACCC│CCCAAAA│
│BBBB│AAAA│       │       │
│BBBB│AAAA│       │       │
└────┴────┴───────┴───────┘
</span></div></div>
</div>
<div class="tip admonition">
<p class="admonition-title">Rule</p>
<p>It is possible to <em><strong>Concatenate</strong></em> two arrays <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> along their <span class="math notranslate nohighlight">\(i^\text{th}\)</span> dimension, provided that they have the same rank, and provided that all other dimensions have the same lengths.</p>
<p>The operation is written like this: <code class="docutils literal notranslate"><span class="pre">A,[i]B</span></code></p>
<p>It is also possible to <em><strong>Concatenate</strong></em> an array <code class="docutils literal notranslate"><span class="pre">A</span></code> of rank <span class="math notranslate nohighlight">\(n\)</span> to another array <code class="docutils literal notranslate"><span class="pre">B</span></code> of rank <span class="math notranslate nohighlight">\(n-1\)</span>. The concatenation <strong>must</strong> then be done along a dimension of <code class="docutils literal notranslate"><span class="pre">A</span></code> such that its other dimensions are strictly identical to those of <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p>
</div>
<p>For example, it is possible to concatenate a vector to a matrix, provided that the vector has the same length as the corresponding dimension of the matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="s1">&#39;JUMP&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">AAAA
AAAA
AAAA
JUMP
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="s1">&#39;TOP&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">AAAAT
AAAAO
AAAAP
</span></div></div>
</div>
<p>In the first example, <code class="docutils literal notranslate"><span class="pre">'JUMP'</span></code> has length 4 and the shape of <code class="docutils literal notranslate"><span class="pre">A</span></code> is <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">4</span></code>, so we can see <code class="docutils literal notranslate"><span class="pre">'JUMP'</span></code> as having shape <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">4</span></code> and so we <strong>must</strong> catenate along <code class="docutils literal notranslate"><span class="pre">[1]</span></code>. The shape of the result is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="s1">&#39;JUMP&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4 4
</span></div></div>
</div>
<p>and we see it was the 1st dimension that changed.</p>
<p>In the second example, <code class="docutils literal notranslate"><span class="pre">'TOP'</span></code> has length 3 and the shape of <code class="docutils literal notranslate"><span class="pre">A</span></code> is <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">4</span></code>, so we can see <code class="docutils literal notranslate"><span class="pre">'TOP'</span></code> as having shape <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">1</span></code> and so we <strong>must</strong> catenate along <code class="docutils literal notranslate"><span class="pre">[2]</span></code>. The shape of the result is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="s1">&#39;TOP&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 5
</span></div></div>
</div>
<p>and we see it was the 2nd dimension that changed.</p>
<div class="tip admonition">
<p class="admonition-title">Example</p>
<p>We can add a row of totals to the bottom of a matrix <code class="docutils literal notranslate"><span class="pre">Y</span></code> with an expression like <code class="docutils literal notranslate"><span class="pre">Y,[1]</span> <span class="pre">(+/[1]Y)</span></code>:</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">forecast</span><span class="o">,</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span> <span class="p">(</span><span class="o">+</span><span class="na">/</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="nv">forecast</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 90  160  420  500   20   30
110  450  170  370  290  360
340  190  320  120  510  370
150  460  240  520  490  280
690 1260 1150 1510 1310 1040
</span></div></div>
</div>
<p>The parentheses are for ease of interpretation; they are not necessary.</p>
<p>In a similar way, it is possible to concatenate a matrix to a 3-D array.</p>
<div class="tip admonition">
<p class="admonition-title">Example</p>
<p>We would like to append to <code class="docutils literal notranslate"><span class="pre">prod</span></code> (a 3-D array) the production of a subcontractor, organised as an array of 5 years and 12 months.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕RL</span> <span class="kd">←</span> <span class="m">73</span>
<span class="o">⊢</span><span class="nv">subcon</span> <span class="kd">←</span> <span class="o">?</span><span class="m">5</span> <span class="m">12</span><span class="o">⍴</span><span class="m">20</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 9 16 10 18  2  3 11 13 17  5  4  2
19 12 19  5 15 14 20 17  4  9  5 13
 4 16  7  2 14 20 15 17 18 13  6 19
10  6 20 13  5 19  5 10 17 16 19 20
18 14 15 15  3  7  9 20  6  8  8 17
</span></div></div>
</div>
<p>The shape of <code class="docutils literal notranslate"><span class="pre">subcon</span></code> is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">subcon</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 12
</span></div></div>
</div>
<p>and the shape of <code class="docutils literal notranslate"><span class="pre">prod</span></code> is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 2 12
</span></div></div>
</div>
<p>The two <strong>must</strong> be concatenated along the 2nd dimension of <code class="docutils literal notranslate"><span class="pre">prod</span></code> and the result will have the shape</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">prod</span><span class="o">,</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="nv">subcon</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 3 12
</span></div></div>
</div>
<p>You see, it is as if <code class="docutils literal notranslate"><span class="pre">subcon</span></code> had the length 1 along the concatenation dimension (the missing one), i.e. it as if <code class="docutils literal notranslate"><span class="pre">subcon</span></code> had shape <code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">1</span> <span class="pre">12</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">prod</span><span class="o">,</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="nv">subcon</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 9 16 42 50  2  3 11 45 17 37 29 36
34 19 32 12 37 15 46 24 49 28 36  9
 9 16 10 18  2  3 11 13 17  5  4  2

29  5 45 23 27  4 23 16 39 22 22  2
46 20 47 17 18 25 13 38 42 38 45 28
19 12 19  5 15 14 20 17  4  9  5 13

37 19  5 10 30 49 16 18 46 47 47  3
39 23 41 20  6 40 21 22 40 49 20  1
 4 16  7  2 14 20 15 17 18 13  6 19

13 36 12 40 12 15 24 20 21 12 19 25
 8 48 22 37 33  1 39 30 50 50  8 35
10  6 20 13  5 19  5 10 17 16 19 20

38 31 24 40 23  7 20 34 35  6 19 27
41  1 14 50 17 42  6 35 12 48 30 29
18 14 15 15  3  7  9 20  6  8  8 17
</span></div></div>
</div>
</div>
<div class="section" id="concatenating-scalars">
<span id="some-primitive-functions-concatenating-scalars"></span><h3><span class="section-number">4.11.3. </span>Concatenating Scalars<a class="headerlink" href="#concatenating-scalars" title="Permalink to this headline">¶</a></h3>
<p>When a scalar is concatenated to an array it is repeated as many times as necessary to match the length of the appropriate dimension of the array.</p>
<p>Here are two examples, using the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> from before:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="s1">&#39;-&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">AAAA
AAAA
AAAA
----
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="s1">&#39;*&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">AAAA*
AAAA*
AAAA*
</span></div></div>
</div>
<p>This property is very useful, because it saves us working out how many items are needed to match the corresponding dimension of the array.</p>
<p>We can also concatenate two scalars. The result is of course a 2-item vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">7</span><span class="o">,</span><span class="m">9</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">7 9
</span></div></div>
</div>
</div>
<div class="section" id="special-cases-and-notations">
<span id="some-primitive-functions-special-cases-and-notations"></span><h3><span class="section-number">4.11.4. </span>Special Cases and Notations<a class="headerlink" href="#special-cases-and-notations" title="Permalink to this headline">¶</a></h3>
<p>By default, if no axis is specified catenation works along the last dimension of the array(s).</p>
<p>So</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">A</span><span class="o">,</span><span class="nv">C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">AAAACCC
AAAACCC
AAAACCC
</span></div></div>
</div>
<p>is equivalent to</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="nv">C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">AAAACCC
AAAACCC
AAAACCC
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">A</span><span class="o">,</span><span class="nv">C</span><span class="p">)</span><span class="o">≡</span><span class="p">(</span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="nv">C</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>APL also includes a special symbol that means “Concatenate along the <strong>first</strong> dimension”; this symbol is a comma topped by a minus sign: <code class="docutils literal notranslate"><span class="pre">⍪</span></code>.</p>
<p>It can be obtained by <kbd>APL</kbd>+<kbd>Shift</kbd>+<kbd>,</kbd>.</p>
<p>So</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">A</span><span class="o">⍪</span><span class="nv">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">AAAA
AAAA
AAAA
BBBB
BBBB
</span></div></div>
</div>
<p>is equivalent to</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="nv">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">AAAA
AAAA
AAAA
BBBB
BBBB
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">A</span><span class="o">⍪</span><span class="nv">B</span><span class="p">)</span><span class="o">≡</span><span class="p">(</span><span class="nv">A</span><span class="o">,</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="nv">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>If an axis is specified, the operation is processed according to the axis specification, regardless of the symbol (<code class="docutils literal notranslate"><span class="pre">,</span></code> or <code class="docutils literal notranslate"><span class="pre">⍪</span></code>) that is actually used.</p>
</div>
<p>This means <code class="docutils literal notranslate"><span class="pre">A,[2]C</span></code> and <code class="docutils literal notranslate"><span class="pre">A⍪[2]C</span></code> are both equivalent to <code class="docutils literal notranslate"><span class="pre">A,C</span></code> and <code class="docutils literal notranslate"><span class="pre">A,[1]B</span></code> and <code class="docutils literal notranslate"><span class="pre">A⍪[1]B</span></code> are both equivalent to <code class="docutils literal notranslate"><span class="pre">A⍪B</span></code>.</p>
</div>
<div class="section" id="dyalog-idioms-and-idiomatic-phrases">
<span id="some-primitive-functions-dyalog-idioms-and-idiomatic-phrases"></span><h3><span class="section-number">4.11.5. </span>Dyalog Idioms and Idiomatic Phrases<a class="headerlink" href="#dyalog-idioms-and-idiomatic-phrases" title="Permalink to this headline">¶</a></h3>
<p>It is common to see <em>Catenate</em> used in conjunction with <em>Reduce</em>, as <code class="docutils literal notranslate"><span class="pre">,/</span></code>. Let us start by understanding what it does:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span> <span class="p">(</span><span class="m">1</span> <span class="m">2</span><span class="p">)</span> <span class="p">(</span><span class="m">3</span> <span class="m">4</span> <span class="m">5</span><span class="p">)</span> <span class="p">(</span><span class="m">6</span> <span class="m">7</span> <span class="m">8</span> <span class="m">9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─┬───┬─────┬───────┐
│0│1 2│3 4 5│6 7 8 9│
└─┴───┴─────┴───────┘
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">,</span><span class="na">/</span><span class="m">0</span> <span class="p">(</span><span class="m">1</span> <span class="m">2</span><span class="p">)</span> <span class="p">(</span><span class="m">3</span> <span class="m">4</span> <span class="m">5</span><span class="p">)</span> <span class="p">(</span><span class="m">6</span> <span class="m">7</span> <span class="m">8</span> <span class="m">9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───────────────────┐
│0 1 2 3 4 5 6 7 8 9│
└───────────────────┘
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;a&#39;</span> <span class="s1">&#39;bcd&#39;</span> <span class="s1">&#39;efghi&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─┬───┬─────┐
│a│bcd│efghi│
└─┴───┴─────┘
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">,</span><span class="na">/</span> <span class="s1">&#39;a&#39;</span> <span class="s1">&#39;bcd&#39;</span> <span class="s1">&#39;efghi&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─────────┐
│abcdefghi│
└─────────┘
</span></div></div>
</div>
<p>We can see above that <em>Reduce by Catenate</em> joins all items of a vector together. Using <code class="docutils literal notranslate"><span class="pre">,/</span></code> is so common that you will get used to looking at <code class="docutils literal notranslate"><span class="pre">,/</span></code> and reading it as <em>join</em>, instead of <em>Reduce by Catenate</em>. Like <code class="docutils literal notranslate"><span class="pre">,/</span></code>, there are many expressions which can be understood as an entity at first sight (with some practice!).</p>
<p>For someone who knows nothing of APL the expression above may take a bit of time to digest (even if they have an extensive knowledge of other programming languages), and they cannot readily appreciate that an APL programmer can understand it immediately, without having to read each of the symbols one by one.</p>
<p>This is not a paradox. For young children, reading the word “Daddy” is complex. It requires the comprehension of a sequence of letters one-by-one. I presume that you no longer do that, do you? <strong>You do not read the letters</strong>; you understand <strong>the word</strong> as a whole. This is exactly the same for the above idiomatic phrase.</p>
<p>These common combinations of primitives are usually termed as <em><strong>Idioms</strong></em> or <em><strong>Idiomatic Phrases</strong></em>. We prefer the latter denomination to avoid any confusion with Dyalog APL’s <em>Idiom Recognition</em>. <a class="reference external" href="https://aplcart.info/">APLcart</a> is a very comprehensive online collection of such idiomatic phrases, although not all entries in APL Cart are idiomatic phrases. It is also noteworthy that there is no objective criteria to determine if a combination of primitives is an idiomatic phrase or not: it depends on your skill, experience and even the context you are working on.</p>
<p>Some idiomatic phrases are so common and useful that Dyalog APL introduced a special <em>Idiom Recognition</em> feature that speeds up the processing of APL code for many popular phrases. Both RIDE and the Windows IDE even have the capability of colouring these differently. For Dyalog APL, an <em>idiom</em> is like a “shortcut primitive” that replaces a sequence of consecutive primitive. This replacement will allow for a later speed up of the code in which it shows up.</p>
<p>For example, we have also been using another short idiom fairly often: <code class="docutils literal notranslate"><span class="pre">≢⍴</span></code> (or <code class="docutils literal notranslate"><span class="pre">⍴⍴</span></code> in Ancient times) computes the rank of an array. Because <code class="docutils literal notranslate"><span class="pre">≢⍴</span></code> is recognised by Dyalog APL’s idiom recognition feature, the interpreter doesn’t need to process two instructions:</p>
<ol class="simple">
<li><p>find shape of right argument;</p></li>
<li><p>return tally of elements of right argument.</p></li>
</ol>
<p>Instead processing a single instruction:</p>
<ol class="simple">
<li><p>find rank of right argument,</p></li>
</ol>
<p>which can be computed by a faster method than the 2 steps above.</p>
</div>
</div>
<div class="section" id="replicate">
<span id="some-primitive-functions-replicate"></span><h2><span class="section-number">4.12. </span>Replicate<a class="headerlink" href="#replicate" title="Permalink to this headline">¶</a></h2>
<div class="section" id="basic-approach-compress">
<span id="some-primitive-functions-basic-approach-compress"></span><h3><span class="section-number">4.12.1. </span>Basic Approach: Compress<a class="headerlink" href="#basic-approach-compress" title="Permalink to this headline">¶</a></h3>
<p>To extract scattered values from a vector, we can use indexing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">contents</span><span class="sr">[</span><span class="m">5</span> <span class="m">6</span> <span class="m">11</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">85 96 82
</span></div></div>
</div>
<p>We can also use a new function named <em><strong>Compress</strong></em>. It takes a Boolean vector as its left argument, and any array of appropriate shape as its right argument. The items of the right argument which match the 1s in the left argument are preserved, whereas those which match the 0s are removed. It acts like a mask or a filter:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span> <span class="m">1</span> <span class="m">1</span> <span class="m">0</span> <span class="na">/</span> <span class="m">42</span> <span class="m">15</span> <span class="m">79</span> <span class="m">66</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">15 79
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">1</span> <span class="m">1</span> <span class="na">/</span> <span class="s1">&#39;Drumstick&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">Duck
</span></div></div>
</div>
<p>This is extremely useful, because we can use <em>Compress</em> to select items which match a given condition.</p>
<p>For example, let us extract from <code class="docutils literal notranslate"><span class="pre">contents</span></code> the values which are greater than 80.</p>
<p>The Boolean vector for the left argument is obtained by <code class="docutils literal notranslate"><span class="pre">contents&gt;80</span></code>, and the selection is made by:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">contents</span><span class="o">&gt;</span><span class="m">80</span><span class="p">)</span> <span class="na">/</span> <span class="nv">contents</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">85 96 82
</span></div></div>
</div>
<p>Of course, the same operation can be applied to any array of any dimension. For higher dimensional arrays, we can use the <em>Axis</em> to specify along which axis to compress. For example, if we have a matrix of chemical formulas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">chemistry</span> <span class="kd">←</span> <span class="m">3</span> <span class="m">5</span><span class="o">⍴</span><span class="s1">&#39;H2SO4CaCO3Fe2O3&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">H2SO4
CaCO3
Fe2O3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="m">0</span> <span class="m">1</span> <span class="na">/</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span> <span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">H2SO4
Fe2O3
</span></div></div>
</div>
<p>By using <code class="docutils literal notranslate"><span class="pre">/[1]</span></code> we are compressing the 1st dimension of <code class="docutils literal notranslate"><span class="pre">chemistry</span></code>, hence selecting two rows, corresponding to the two 1s in the vector on the left.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="na">/</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span> <span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">H2O
CaO
FeO
</span></div></div>
</div>
<p>If we use <code class="docutils literal notranslate"><span class="pre">/[2]</span></code> we are compressing the 2nd dimension of <code class="docutils literal notranslate"><span class="pre">chemistry</span></code>, hence selecting three columns. In this example columns 3 and 5 have been removed.</p>
<p><em>Compress</em> is an excellent tool which allows you to:</p>
<ul class="simple">
<li><p>extract some useful items from a variable;</p></li>
<li><p>remove some unwanted items from a variable, which is the same thing.</p></li>
</ul>
<div class="hint admonition">
<p class="admonition-title">Advice</p>
<p>Every time you obtain a Boolean vector, you should immediately think of two major things you can do with it: <em>Count</em> or <em>select</em>.</p>
</div>
<p>For example, using <code class="docutils literal notranslate"><span class="pre">contents</span></code>, we can produce a Boolean vector that shows which items are smaller than 50:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">bin</span> <span class="kd">←</span> <span class="nv">contents</span> <span class="o">&lt;</span> <span class="m">50</span>
</pre></div>
</div>
</div>
</div>
<p>Then, we can:</p>
<ul class="simple">
<li><p>count the items that are smaller than 50:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span> <span class="nv">bin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5
</span></div></div>
</div>
<ul class="simple">
<li><p>select (or extract) said items:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">bin</span> <span class="na">/</span> <span class="nv">contents</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12 30 22 44 27
</span></div></div>
</div>
<div class="hint admonition">
<p class="admonition-title">Hint</p>
<p>Programmers who are new to APL and who are familiar with indexing as the natural selection mechanism may be tempted to use the Boolean selection vector to create some indices, and then use the indices to select the desired items.</p>
</div>
<p>This works very well, for example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">ix</span> <span class="kd">←</span> <span class="nv">bin</span> <span class="na">/</span> <span class="o">⍳⍴</span><span class="nv">contents</span>
<span class="nv">contents</span><span class="sr">[</span><span class="nv">ix</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12 30 22 44 27
</span></div></div>
</div>
<p>However this is an unnecessary complication that wastes memory and processing time, compared to the straightforward selection shown above.</p>
</div>
<div class="section" id="general-case-replicate">
<span id="some-primitive-functions-general-case-replicate"></span><h3><span class="section-number">4.12.2. </span>General Case: Replicate<a class="headerlink" href="#general-case-replicate" title="Permalink to this headline">¶</a></h3>
<p>In fact, <em>Compress</em> is just a special case of a more comprehensive function named <em><strong>Replicate</strong></em>. Its left argument can be any vector of integer values, each of which produces the following result:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Signum of the left item</p></th>
<th class="text-align:left head"><p>Effect on the corresponding right item</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td class="text-align:left"><p>item is replicated the number of times specified by the left item</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
<td class="text-align:left"><p>item is suppressed</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p><code class="docutils literal notranslate"><span class="pre">¯1</span></code></p></td>
<td class="text-align:left"><p>item is replaced by as many “<em><strong>Fill items</strong></em>” as is indicated by the left item</p></td>
</tr>
</tbody>
</table>
<p>The concept of a “Fill item” is new and will be discussed in full in <span class="xref myst">the “Nested Arrays” chapter</span>. For now, you only need to know that the fill item for a simple numeric array is 0 and the fill item for a simple character array is a blank space.</p>
<p>Here are some examples, using the same left argument applied to numeric and character vectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span> <span class="m">1</span> <span class="m">3</span> <span class="m">0</span> <span class="na">/</span> <span class="m">42</span> <span class="m">15</span> <span class="m">79</span> <span class="m">66</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">15 79 79 79
</span></div></div>
</div>
<p>42 and 66 have been removed, as their corresponding left items were 0. 15 was replicated 1 time and 79 was replicated 3 times, as indicated by their corresponding left items.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span> <span class="m">1</span> <span class="m">3</span> <span class="m">0</span> <span class="na">/</span> <span class="s1">&#39;boat&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">oaaa
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span> <span class="m">¯3</span> <span class="m">1</span> <span class="m">0</span> <span class="na">/</span> <span class="m">42</span> <span class="m">15</span> <span class="m">79</span> <span class="m">66</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">42 42 0 0 0 79
</span></div></div>
</div>
<p>For the example above, 15 has been replaced by 3 zeroes because the fill item for simple numeric arrays is a zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span> <span class="m">¯3</span> <span class="m">1</span> <span class="m">0</span> <span class="na">/</span> <span class="s1">&#39;boat&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">bb   a
</span></div></div>
</div>
<p>For this example, the letter “o” was replaced by 3 blank spaces because the fill item for simple numeric arrays is ” “.</p>
</div>
<div class="section" id="scalar-left-argument">
<span id="some-primitive-functions-scalar-left-argument"></span><h3><span class="section-number">4.12.3. </span>Scalar Left Argument<a class="headerlink" href="#scalar-left-argument" title="Permalink to this headline">¶</a></h3>
<p>If the left argument of <em>Compress</em> or <em>Replicate</em> is a scalar, it applies to all the items of the right argument.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">v</span> <span class="kd">←</span> <span class="s1">&#39;Phew&#39;</span>
<span class="m">1</span><span class="na">/</span><span class="nv">v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">Phew
</span></div></div>
</div>
<p>When the left argument is 1 all the items are retained.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span><span class="na">/</span><span class="nv">v</span>        <span class="c1">⍝ Repeat each letter 3 times.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">PPPhhheeewww
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span><span class="na">/</span><span class="nv">v</span>        <span class="c1">⍝ Repeat each letter 0 times.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;&#39;</span><span class="o">≡</span><span class="m">0</span><span class="na">/</span><span class="nv">v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>As you can see above, when we use 0 as the left argument to <em>Replicate</em> we get an empty vector. Because <code class="docutils literal notranslate"><span class="pre">v</span></code> was a simple character vector, we get an empty character vector.</p>
</div>
<div class="section" id="id3">
<span id="id4"></span><h3><span class="section-number">4.12.4. </span>Special Notations<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Like <em>Reduce</em> and <em>Catenate</em>, <em>Replicate</em> works by default along the last dimension of an array. However, it is possible for it to work on any dimension by using the <em>Axis</em>. It is also possible to use <code class="docutils literal notranslate"><span class="pre">⌿</span></code>, which we have already seen, to work on the first dimension by default.</p>
<p>For example,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="na">⌿</span> <span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">CaCO3
</span></div></div>
</div>
<p>which is equivalent to</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="na">/</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span> <span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">CaCO3
</span></div></div>
</div>
<p>Beware, the result obtained this way is <strong>not</strong> a vector, but a matrix having only one row:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="m">0</span> <span class="m">1</span> <span class="m">0</span><span class="na">⌿</span><span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 5
</span></div></div>
</div>
<p>You must not confuse <em>Reduce</em> and <em>Replicate</em>: even if the symbol used is the same, they are completely different operations:</p>
<ul class="simple">
<li><p><em><strong>Reduce</strong></em> takes a function as its left operand; it is a monadic <em>operator</em> (e.g. <code class="docutils literal notranslate"><span class="pre">+/</span> <span class="pre">contents</span></code>);</p></li>
<li><p><em><strong>Replicate</strong></em> takes a vector as its left argument and an array as its right argument; it is a dyadic <em>function</em> (e.g. <code class="docutils literal notranslate"><span class="pre">vec/</span> <span class="pre">contents</span></code>);</p></li>
</ul>
</div>
</div>
<div class="section" id="position-index-of">
<span id="some-primitive-functions-position-index-of"></span><h2><span class="section-number">4.13. </span>Position (Index Of)<a class="headerlink" href="#position-index-of" title="Permalink to this headline">¶</a></h2>
<div class="section" id="discovery">
<span id="some-primitive-functions-discovery"></span><h3><span class="section-number">4.13.1. </span>Discovery<a class="headerlink" href="#discovery" title="Permalink to this headline">¶</a></h3>
<p>It is very often necessary to locate the positions of particular values in a list of items. To solve this, APL has a special function named <em><strong>Position</strong></em> (also called “<em><strong>Index Of</strong></em>”), represented by the Greek letter Iota (<code class="docutils literal notranslate"><span class="pre">⍳</span></code>). This symbol can be obtained by <kbd>Ctrl</kbd>+<kbd>i</kbd> (the initial letter of Iota). Let us see how it works:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">vec</span> <span class="kd">←</span> <span class="m">15</span> <span class="m">42</span> <span class="m">53</span> <span class="m">19</span> <span class="m">46</span> <span class="m">53</span> <span class="m">82</span> <span class="m">17</span> <span class="m">14</span> <span class="m">53</span> <span class="m">24</span>
<span class="nv">vec</span> <span class="o">⍳</span> <span class="m">19</span> <span class="m">14</span> <span class="m">53</span> <span class="m">49</span> <span class="m">15</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4 9 3 12 1
</span></div></div>
</div>
<p>Above we asked for the positions of 5 values (19, 14, 53, 49 and 15) and naturally we obtain 5 answers.</p>
<ul class="simple">
<li><p>The result tells us that 19, 14 and 15 appear in positions 4, 9 and 1 respectively.</p></li>
<li><p>The result also tells us that 53 appears in position 3. This is of course true, but it also appears in positions 6 and 10, which are not included in the result. This is a necessary restriction: if we had searched for 5 values and obtained 7 results, it would not have been possible to say where each value appears. This is the reason why <em><strong>Index Of</strong></em> returns <em>only the first</em> occurrence of each value.</p></li>
</ul>
<p>We shall see later that this is an advantage: if instead we need to find all the positions in which a value occurs, there is another function that we can use (see <a class="reference internal" href="#some-primitive-functions-application-4"><span class="std std-numref">Section 4.14.1</span></a> below).</p>
<ul class="simple">
<li><p>Surprisingly, the result tells us that 49 appears in position 12, though <code class="docutils literal notranslate"><span class="pre">vec</span></code> has only 11 items! This is the way that <em>Index Of</em> indicates a missing value. We shall see that it is a great advantage, too.</p></li>
</ul>
<p>The following rule explains how dyadic Iota works when the left argument is a vector:</p>
<div class="tip admonition">
<p class="admonition-title">Rule</p>
<p>In the expression <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">←</span> <span class="pre">haystack</span> <span class="pre">⍳</span> <span class="pre">needles</span></code> we look for the <code class="docutils literal notranslate"><span class="pre">needles</span></code> in the <code class="docutils literal notranslate"><span class="pre">haystack</span></code>, and</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">haystack</span></code> can be a vector of any type: numeric, character, mixed, nested;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">needles</span></code> can be any array (any type, any shape, any rank);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r</span></code> will have the same rank and shape as <code class="docutils literal notranslate"><span class="pre">needles</span></code>;</p></li>
<li><p>the items of <code class="docutils literal notranslate"><span class="pre">r</span></code> contain the positions of the first occurrence of the corresponding items of <code class="docutils literal notranslate"><span class="pre">needles</span></code> in <code class="docutils literal notranslate"><span class="pre">haystack</span></code>;</p></li>
<li><p>items which do not appear in <code class="docutils literal notranslate"><span class="pre">haystack</span></code> give the result <code class="docutils literal notranslate"><span class="pre">1+≢haystack</span></code>.</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;ABC&#39;</span> <span class="o">⍳</span> <span class="m">57</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4
</span></div></div>
</div>
<p>A number cannot occur in a 3-item character vector, so the result is 4.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">4</span> <span class="m">8</span> <span class="o">⍳</span> <span class="s1">&#39;4 8&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 3 3
</span></div></div>
</div>
<p>Similarly, characters cannot appear in a 2-item numeric vector, so each character results in a 3.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">alpha</span> <span class="kd">←</span> <span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789&#39;</span>
<span class="nv">alpha</span> <span class="o">⍳</span> <span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">8 30 19 15 32
3 38  3 15 31
6 38 30 15 31
</span></div></div>
</div>
<p>The two lower case letters in <code class="docutils literal notranslate"><span class="pre">chemistry</span></code> give the answer 38 because <code class="docutils literal notranslate"><span class="pre">alpha</span></code> has 37 items. Also notice how the shape of <code class="docutils literal notranslate"><span class="pre">chemistry</span></code> and <code class="docutils literal notranslate"><span class="pre">alpha</span> <span class="pre">⍳</span> <span class="pre">chemistry</span></code> is the same, like the rule above specified.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">⍴</span><span class="nv">chemistry</span><span class="p">)</span><span class="o">≡</span><span class="p">(</span><span class="o">⍴</span><span class="nv">alpha</span><span class="o">⍳</span><span class="nv">chemistry</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>We can also use nested vectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;Tee&#39;</span> <span class="p">(</span><span class="m">3</span> <span class="m">7</span><span class="p">)</span> <span class="s1">&#39;Golf&#39;</span> <span class="o">⍳</span> <span class="m">3</span> <span class="m">7</span> <span class="p">(</span><span class="m">3</span> <span class="m">7</span><span class="p">)</span> <span class="s1">&#39;Tee&#39;</span> <span class="s1">&#39;Green&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4 4 2 1 4
</span></div></div>
</div>
<p>The function <em>Index Of</em> is one of the most important primitive functions in APL. It is very flexible and it can be used in many situations, as shown in the following examples.</p>
<div class="warning admonition">
<p class="admonition-title">Warning</p>
<p>In the expression <code class="docutils literal notranslate"><span class="pre">A⍳B</span></code> we search for <code class="docutils literal notranslate"><span class="pre">B</span></code> in <code class="docutils literal notranslate"><span class="pre">A</span></code> whereas in <code class="docutils literal notranslate"><span class="pre">A∊B</span></code> we search for <code class="docutils literal notranslate"><span class="pre">A</span></code> in <code class="docutils literal notranslate"><span class="pre">B</span></code>. Do not be confused!</p>
</div>
</div>
<div class="section" id="application-3">
<span id="some-primitive-functions-application-3"></span><h3><span class="section-number">4.13.2. </span>Application 3<a class="headerlink" href="#application-3" title="Permalink to this headline">¶</a></h3>
<p>A car manufacturer decided that they will offer their customers a discount on the catalogue price. The country has been split into 100 geographical areas, and the discount rate will depend on the geographic area according to the following table:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Area</p></th>
<th class="text-align:center head"><p>Discount</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>17</p></td>
<td class="text-align:center"><p>9%</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>50</p></td>
<td class="text-align:center"><p>8%</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>59</p></td>
<td class="text-align:center"><p>6%</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>84</p></td>
<td class="text-align:center"><p>5%</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>89</p></td>
<td class="text-align:center"><p>4%</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>Others</p></td>
<td class="text-align:center"><p>2%</p></td>
</tr>
</tbody>
</table>
<p>which we save to two vectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">area</span> <span class="kd">←</span> <span class="m">17</span> <span class="m">50</span> <span class="m">59</span> <span class="m">84</span> <span class="m">89</span>
<span class="nv">discount</span> <span class="kd">←</span> <span class="m">9</span> <span class="m">8</span> <span class="m">6</span> <span class="m">5</span> <span class="m">4</span> <span class="m">2</span>
</pre></div>
</div>
</div>
</div>
<p>The first task is to calculate the discount rate to be claimed for a potential customer who lives in area <code class="docutils literal notranslate"><span class="pre">d</span></code>; for example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">d</span> <span class="kd">←</span> <span class="m">84</span>
</pre></div>
</div>
</div>
</div>
<p>Let us see if 84 is in the list of favoured areas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">area</span> <span class="o">⍳</span> <span class="nv">d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4
</span></div></div>
</div>
<p>We can see that 84 is the 4th item in the list.</p>
<p>Let us find the current discount rate for this index position:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">discount</span><span class="sr">[</span><span class="m">4</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5
</span></div></div>
</div>
<p>This customer can claim a 5% discount.</p>
<p>We could simply write</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">discount</span><span class="sr">[</span><span class="nv">area</span><span class="o">⍳</span><span class="nv">d</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5
</span></div></div>
</div>
<p>Now, what if a customer lives in any other area, such as 75, 45 or 93?</p>
<p>The expression <code class="docutils literal notranslate"><span class="pre">area⍳d</span></code> will return the result <code class="docutils literal notranslate"><span class="pre">6</span></code> for all these area codes, because these values are absent from <code class="docutils literal notranslate"><span class="pre">area</span></code>.</p>
<p>Then <code class="docutils literal notranslate"><span class="pre">discount[6]</span></code> will always find the rate 2%, as specified. Here we can see that it is an advantage that <em>Index Of</em> returns 1 + the number of items in the vector to be searched.</p>
<div class="note admonition">
<p class="admonition-title">A Vector Solution</p>
<p>The importance of this approach to finding the discount rates is that it is vector-based. If publicity attracts crowds and therefore <code class="docutils literal notranslate"><span class="pre">d</span></code> is no longer a scalar but a vector, the solution is still valid.</p>
</div>
<p>As an example, consider the following vector of area codes and the respective discount rates:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">d</span> <span class="kd">←</span> <span class="m">24</span> <span class="m">75</span> <span class="m">89</span> <span class="m">60</span> <span class="m">92</span> <span class="m">50</span> <span class="m">51</span> <span class="m">50</span> <span class="m">84</span> <span class="m">66</span> <span class="m">17</span> <span class="m">89</span>
<span class="nv">discount</span><span class="sr">[</span><span class="nv">area</span><span class="o">⍳</span><span class="nv">d</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 2 4 2 2 8 2 8 5 2 9 4
</span></div></div>
</div>
<p>We have achieved all this without a program, neither a “loop” nor a “test”. And it works for any number of areas. Readers who know other programming languages will probably appreciate the simplicity of this approach.</p>
<div class="section" id="changing-the-frame-of-reference">
<span id="some-primitive-functions-changing-the-frame-of-reference"></span><h4><span class="section-number">4.13.2.1. </span>Changing The Frame of Reference<a class="headerlink" href="#changing-the-frame-of-reference" title="Permalink to this headline">¶</a></h4>
<p>In reality, the expression that we have just written is an example of an algorithm for “<em>changing the frame of reference</em>”. Don’t panic, this term may seem esoteric, but the concept is simple: a list of area numbers (the initial set) is translated into a list of discount rates (the final set). The algorithm comprises only the function <em>Index Of</em> and indexing:</p>
<div class="algorithm admonition">
<p class="admonition-title">Algorithm</p>
<p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">←</span> <span class="pre">finalSet[initialSet</span> <span class="pre">⍳</span> <span class="pre">values]</span></code></p>
</div>
<p>Let us imagine the initial set to be an alphabet composed of both lowercase and uppercase letters, and the final set to be composed of only uppercase letters, with a blank space in the middle:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">alphLower</span> <span class="kd">←</span> <span class="s1">&#39;abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span>
<span class="nv">alphUpper</span> <span class="kd">←</span> <span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ ABCDEFGHIJKLMNOPQRSTUVWXYZ*&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Now, let us write a sentence; we will write it in French in order to show what happens with missing characters:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">tale</span> <span class="kd">←</span> <span class="s1">&#39;Le Petit Chaperon-Rouge a bouffé le Loup&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>If we apply the algorithm seen above, the expression will convert the text from lower to upper case:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">alphUpper</span><span class="sr">[</span><span class="nv">alphLower</span><span class="o">⍳</span><span class="nv">tale</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">LE PETIT CHAPERON*ROUGE A BOUFF* LE LOUP
</span></div></div>
</div>
<p>As one might expect, the characters <code class="docutils literal notranslate"><span class="pre">'-'</span></code> and <code class="docutils literal notranslate"><span class="pre">'é'</span></code>, which are absent from the initial alphabetic set, have been replaced by the <code class="docutils literal notranslate"><span class="pre">'*'</span></code>, the “extra” character at the end of the final set. This works because once again the final set is one item longer than the initial set.</p>
<p>Once more, the logical steps needed to solve the problem are easily translated into a programming solution, and the programmer can thereby direct all his attention to solving the problem.</p>
</div>
</div>
<div class="section" id="general-case">
<span id="some-primitive-functions-general-case"></span><h3><span class="section-number">4.13.3. </span>General Case<a class="headerlink" href="#general-case" title="Permalink to this headline">¶</a></h3>
<p>The left argument to <em>Index Of</em> need not be a vector. In fact, in the expression <code class="docutils literal notranslate"><span class="pre">haystack</span> <span class="pre">⍳</span> <span class="pre">needles</span></code>, <code class="docutils literal notranslate"><span class="pre">haystack</span></code> can be an array of any rank, type and shape, as long as it is <em>not</em> a scalar. However, <code class="docutils literal notranslate"><span class="pre">needles</span></code> must have a shape that is appropriate for the <code class="docutils literal notranslate"><span class="pre">haystack</span></code> you use.</p>
<p>We will see what this means by using a 3-D <code class="docutils literal notranslate"><span class="pre">haystack</span></code> as an example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">haystack</span> <span class="kd">←</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span><span class="o">⍴</span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span> <span class="m">7</span> <span class="m">8</span> <span class="m">9</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3 4
5 6 7 8
9 0 1 2

3 4 5 6
7 8 9 0
1 2 3 4
</span></div></div>
</div>
<p>When <em>Index Of</em> is used, the first thing Dyalog APL does is look at its left argument and try to figure out what is the shape of the things contained in the <code class="docutils literal notranslate"><span class="pre">haystack</span></code>. For that matter, we first inspect the shape of the <code class="docutils literal notranslate"><span class="pre">haystack</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">haystack</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 3 4
</span></div></div>
</div>
<p>and interpret it as</p>
<blockquote>
<div><p>“<em><code class="docutils literal notranslate"><span class="pre">haystack</span></code> contains 2 items of shape <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">4</span></code></em>”</p>
</div></blockquote>
<p>which means we can look for needles with shape <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">4</span></code> inside the <code class="docutils literal notranslate"><span class="pre">haystack</span></code>. Therefore, for <code class="docutils literal notranslate"><span class="pre">needles</span></code> to be seen as “<em>containing items of shape <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">4</span></code></em>” its shape must also end in <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">4</span></code>. Whatever is not the final <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">4</span></code> in the shape of <code class="docutils literal notranslate"><span class="pre">needles</span></code> is what dictates the shape of the final result.</p>
<p>If the shape of <code class="docutils literal notranslate"><span class="pre">needles</span></code> is too short for it to match the shape of the items the <code class="docutils literal notranslate"><span class="pre">haystack</span></code> contains, we get a <code class="docutils literal notranslate"><span class="pre">RANK</span> <span class="pre">ERROR</span></code> because <code class="docutils literal notranslate"><span class="pre">needles</span></code> doesn’t have enough dimensions.</p>
<p>Similarly, if the shape of <code class="docutils literal notranslate"><span class="pre">needles</span></code> is long enough but its trailing dimensions don’t match those of the left argument, we get a <code class="docutils literal notranslate"><span class="pre">LENGTH</span> <span class="pre">ERROR</span></code> because the things we are comparing have different lengths along their dimensions.</p>
<p>In the table below we give examples of some <code class="docutils literal notranslate"><span class="pre">haystack</span></code> and <code class="docutils literal notranslate"><span class="pre">needles</span></code> shapes, along with the shape of the items that <code class="docutils literal notranslate"><span class="pre">⍳</span></code> thinks <code class="docutils literal notranslate"><span class="pre">haystack</span></code> contains and the shape of the result (remember that <code class="docutils literal notranslate"><span class="pre">⍬</span></code> is the shape of a scalar):</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p><code class="docutils literal notranslate"><span class="pre">⍴haystack</span></code></p></th>
<th class="text-align:left head"><p><code class="docutils literal notranslate"><span class="pre">⍴needles</span></code> must end with</p></th>
<th class="text-align:left head"><p><code class="docutils literal notranslate"><span class="pre">⍴needles</span></code></p></th>
<th class="text-align:left head"><p><code class="docutils literal notranslate"><span class="pre">⍴r</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">3</span> <span class="pre">4</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">4</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">4</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">⍬</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td class="text-align:left"><p></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">1</span> <span class="pre">3</span> <span class="pre">4</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">1</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td class="text-align:left"><p></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">1</span> <span class="pre">4</span> <span class="pre">4</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">LENGTH</span> <span class="pre">ERROR</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td class="text-align:left"><p></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">2</span> <span class="pre">3</span> <span class="pre">3</span> <span class="pre">4</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">2</span> <span class="pre">3</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td class="text-align:left"><p></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">3</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">RANK</span> <span class="pre">ERROR</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">6</span> <span class="pre">2</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">2</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">4</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td class="text-align:left"><p></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">⍬</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td class="text-align:left"><p></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">3</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">LENGTH</span> <span class="pre">ERROR</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">⍬</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">2</span> <span class="pre">3</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">2</span> <span class="pre">3</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td class="text-align:left"><p></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">3</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">3</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td class="text-align:left"><p></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td class="text-align:left"><p></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">⍬</span></code></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">⍬</span></code></p></td>
</tr>
</tbody>
</table>
<p>As a practical example, if we take the <code class="docutils literal notranslate"><span class="pre">haystack</span></code> we defined above, we can look for 3 by 4 matrices in there. Our <code class="docutils literal notranslate"><span class="pre">needles</span></code> variable has 4 such matrices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">needles</span> <span class="kd">←</span> <span class="m">4</span> <span class="m">3</span> <span class="m">4</span><span class="o">⍴</span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span> <span class="m">7</span> <span class="m">8</span> <span class="m">9</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3 4
5 6 7 8
9 0 1 2

3 4 5 6
7 8 9 0
1 2 3 4

5 6 7 8
9 0 1 2
3 4 5 6

7 8 9 0
1 2 3 4
5 6 7 8
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">haystack</span> <span class="o">⍳</span> <span class="nv">needles</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3 3
</span></div></div>
</div>
<p>This shows that the first and second matrices were found in positions 1 and 2, respectively, and the third and fourth matrices were found nowhere, thus getting 3 as a result. The result is 3 because 2 is the number of items that <code class="docutils literal notranslate"><span class="pre">haystack</span></code> has.</p>
<p>Now we write the rule that dictates how <em>Index Of</em> works in the general case:</p>
<div class="tip admonition">
<p class="admonition-title">Rule</p>
<p>In the expression <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">←</span> <span class="pre">haystack</span> <span class="pre">⍳</span> <span class="pre">needles</span></code> we look for the <code class="docutils literal notranslate"><span class="pre">needles</span></code> in the <code class="docutils literal notranslate"><span class="pre">haystack</span></code>, and</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">haystack</span></code> can be any array of rank <code class="docutils literal notranslate"><span class="pre">hr</span></code> with <code class="docutils literal notranslate"><span class="pre">hr</span></code> being at least 1;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">needles</span></code> can be any array of rank <code class="docutils literal notranslate"><span class="pre">nr</span></code> with <code class="docutils literal notranslate"><span class="pre">nr</span></code> being at least <code class="docutils literal notranslate"><span class="pre">hr-1</span></code>;</p></li>
<li><p>the last <code class="docutils literal notranslate"><span class="pre">hr-1</span></code> numbers of the shape of <code class="docutils literal notranslate"><span class="pre">needles</span></code> and the last <code class="docutils literal notranslate"><span class="pre">hr-1</span></code> numbers of the shape of <code class="docutils literal notranslate"><span class="pre">haystack</span></code> must be the same;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r</span></code> has rank equal to <code class="docutils literal notranslate"><span class="pre">nr-hr-1</span></code> and shape equal to the first <code class="docutils literal notranslate"><span class="pre">nr-hr-1</span></code> numbers of the shape of <code class="docutils literal notranslate"><span class="pre">needles</span></code>;</p></li>
<li><p>the items of <code class="docutils literal notranslate"><span class="pre">r</span></code> contain the positions of the first occurrence of the corresponding items of <code class="docutils literal notranslate"><span class="pre">needles</span></code> in <code class="docutils literal notranslate"><span class="pre">haystack</span></code>;</p></li>
<li><p>items which do not appear in <code class="docutils literal notranslate"><span class="pre">haystack</span></code> give the result <code class="docutils literal notranslate"><span class="pre">1+m</span></code> if <code class="docutils literal notranslate"><span class="pre">m</span></code> is the leading number in the shape of <code class="docutils literal notranslate"><span class="pre">haystack</span></code>.</p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="where">
<span id="some-primitive-functions-where"></span><h2><span class="section-number">4.14. </span>Where<a class="headerlink" href="#where" title="Permalink to this headline">¶</a></h2>
<p>The primitive function <em><strong>Where</strong></em> is the monadic use of the <em>Iota Underbar</em> <code class="docutils literal notranslate"><span class="pre">⍸</span></code>, which you can type with <kbd>APL</kbd>+<kbd>Shift</kbd>+<kbd>I</kbd>. The simplest use case for this primitive is to give it a simple Boolean array, for which <code class="docutils literal notranslate"><span class="pre">⍸</span></code> finds <em><strong>Where</strong></em> the values 1 are.</p>
<p>For example, given the <code class="docutils literal notranslate"><span class="pre">contents</span></code> vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">contents</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12 56 78 74 85 96 30 22 44 66 82 27
</span></div></div>
</div>
<p>What items are greater than 75?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">contents</span> <span class="o">&gt;</span> <span class="m">75</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 1 0 1 1 0 0 0 0 1 0
</span></div></div>
</div>
<p>And <em>Where</em> are they?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸</span><span class="nv">contents</span> <span class="o">&gt;</span> <span class="m">75</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 5 6 11
</span></div></div>
</div>
<p>They are at positions 3, 5, 6 and 11, referring respectively to the elements 78, 85, 96 and 82.</p>
<div class="section" id="application-4">
<span id="some-primitive-functions-application-4"></span><h3><span class="section-number">4.14.1. </span>Application 4<a class="headerlink" href="#application-4" title="Permalink to this headline">¶</a></h3>
<p>You probably remember that the function <em>Index Of</em> returns only the <em>first</em> occurrence of a value in a vector (cf. <a class="reference internal" href="#some-primitive-functions-discovery"><span class="std std-numref">Section 4.13.1</span></a>). Using <em>Where</em> we can find <em>all</em> the occurrences.</p>
<p>Here is a vector, in which we would like to find the positions of the number 19:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">vec</span> <span class="kd">←</span> <span class="m">41</span> <span class="m">17</span> <span class="m">19</span> <span class="m">53</span> <span class="m">42</span> <span class="m">27</span> <span class="m">19</span> <span class="m">88</span> <span class="m">14</span> <span class="m">56</span> <span class="m">19</span> <span class="m">33</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">vec</span><span class="o">=</span><span class="m">19</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 1 0 0 0 1 0 0 0 1 0
</span></div></div>
</div>
<p>Now that we have a Boolean vector, we can just use <code class="docutils literal notranslate"><span class="pre">⍸</span></code> to find out <em>Where</em> the 1s are:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸</span><span class="nv">vec</span><span class="o">=</span><span class="m">19</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 7 11
</span></div></div>
</div>
<p>It is as simple as that!</p>
<p>Of course the same search technique will work on characters, because what we really care about is the Boolean vector we generate at a later step, not what the initial vector was. For example, let us find all the letters “a” in a sentence:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">sentence</span> <span class="kd">←</span> <span class="s1">&#39;Panama is a canal between Atlantic and Pacific&#39;</span>
<span class="o">⍸</span><span class="nv">sentence</span><span class="o">=</span><span class="s1">&#39;a&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 4 6 11 14 16 30 36 41
</span></div></div>
</div>
<p>Having found all the “a”s, we may wish to find all the lowercase vowels. For that matter, we need to create a Boolean vector with 1s in the positions with lowercase vowels. In the example above, <code class="docutils literal notranslate"><span class="pre">sentence='a'</span></code> worked because we are allowed to compare a vector with a single scalar, but now we can’t change this to</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">sentence</span><span class="o">=</span><span class="s1">&#39;aeiouy&#39;</span>        <span class="c1">⍝ &#39;y&#39; is a vowel in many European languages</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LENGTH ERROR: Mismatched left and right argument shapes
      sentence=&#39;aeiouy&#39;        ⍝ &#39;y&#39; is a vowel in many European languages
              ∧
</pre></div>
</div>
</div>
</div>
<p>The code above does not work because <code class="docutils literal notranslate"><span class="pre">=</span></code> is trying to compare the two vectors item by item, only to realise the vector <code class="docutils literal notranslate"><span class="pre">'aeiouy'</span></code> is too short for that. Instead, what we can do is check whether or not each character of <code class="docutils literal notranslate"><span class="pre">sentence</span></code> is a <em>member</em> of the character vector <code class="docutils literal notranslate"><span class="pre">'aeiouy'</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">sentence</span><span class="o">∊</span><span class="s1">&#39;aeiouy&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 0 1 0 1 0 1 0 0 1 0 0 1 0 1 0 0 0 1 0 0 1 1 0 0 0 0 0 1 0 0 1 0 0 1 0 0 0 0 1 0 1 0 1 0
</span></div></div>
</div>
<p>Having computed this Boolean vector, the finishing touch is to compute <em>Where</em> the vowels were found:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸</span><span class="nv">sentence</span><span class="o">∊</span><span class="s1">&#39;aeiouy&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 4 6 8 11 14 16 20 23 24 30 33 36 41 43 45
</span></div></div>
</div>
</div>
<div class="section" id="increasing-the-dimension">
<span id="some-primitive-functions-increasing-the-dimension"></span><h3><span class="section-number">4.14.2. </span>Increasing The Dimension<a class="headerlink" href="#increasing-the-dimension" title="Permalink to this headline">¶</a></h3>
<p>Up until now we only used simple vectors as arguments to <em>Where</em>, but in the beginning we talked about Boolean <em>arrays</em>, not <em>vectors</em>.</p>
<p>For higher dimensional arrays <em>Where</em> behaves the same way: it returns the indices of the positions that contain 1s. Similar to what we did above, we might want to find all the lowercase vowels in the <code class="docutils literal notranslate"><span class="pre">monMat</span></code> matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">monMat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">January 
February
March   
April   
May     
June    
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸</span><span class="nv">monMat</span><span class="o">∊</span><span class="s1">&#39;aeiouy&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┐
│1 2│1 4│1 5│1 7│2 2│2 5│2 6│2 8│3 2│4 4│5 2│5 3│6 2│6 4│
└───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┘
</span></div></div>
</div>
<p>The last item in the result above is <code class="docutils literal notranslate"><span class="pre">6</span> <span class="pre">4</span></code>, which means that row 6, column 4 of <code class="docutils literal notranslate"><span class="pre">monMat</span></code> contains a lowercase vowel: the final “e” in “June”. We can verify this with the index function <code class="docutils literal notranslate"><span class="pre">⌷</span></code> you already learned about (cf. <a class="reference internal" href="Data-and-Variables.html#data-and-variables-the-index-function"><span class="std std-numref">Section 3.5.6</span></a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">6</span><span class="o">⌷</span><span class="nv">monMat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">June    
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">6</span> <span class="m">4</span><span class="o">⌷</span><span class="nv">monMat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">e
</span></div></div>
</div>
<p>The example above also shows an interesting property of <em>Where</em>: it always returns a <em>vector</em>, regardless of the shape of the input, and each item of the resulting vector is a suitable index to <code class="docutils literal notranslate"><span class="pre">⌷</span></code>.</p>
</div>
<div class="section" id="simple-not-nested">
<span id="some-primitive-functions-simple-not-nested"></span><h3><span class="section-number">4.14.3. </span>Simple, Not Nested<a class="headerlink" href="#simple-not-nested" title="Permalink to this headline">¶</a></h3>
<p><em>Where</em> does require that its argument be a simple array. If you provide a nested array, <code class="docutils literal notranslate"><span class="pre">⍸</span></code> won’t know what to do with it. This is because there is no way of indexing into a nested array with an index vector like <code class="docutils literal notranslate"><span class="pre">3</span></code> or <code class="docutils literal notranslate"><span class="pre">6</span> <span class="pre">4</span></code>, or even something longer.</p>
<p>In fact, if the argument to <em>Where</em> is a nested array, you get a <code class="docutils literal notranslate"><span class="pre">DOMAIN</span> <span class="pre">ERROR</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸</span><span class="p">(</span><span class="m">0</span> <span class="m">1</span><span class="p">)(</span><span class="m">1</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DOMAIN ERROR
      ⍸(0 1)(1 1)
      ∧
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="beyond-boolean-arrays">
<span id="some-primitive-functions-beyond-boolean-arrays"></span><h3><span class="section-number">4.14.4. </span>Beyond Boolean Arrays<a class="headerlink" href="#beyond-boolean-arrays" title="Permalink to this headline">¶</a></h3>
<p>Now that you have seen the most iconic use of <em>Where</em>, you will be shown the full specification for it, as we have only used Boolean arguments so far.</p>
<div class="tip admonition">
<p class="admonition-title">Rule</p>
<p>In the expression <code class="docutils literal notranslate"><span class="pre">R</span> <span class="pre">←</span> <span class="pre">⍸Y</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Y</span></code> must be a simple Boolean vector or a simple numeric array with non-negative integers;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">R</span></code> is a vector, regardless of the shape of <code class="docutils literal notranslate"><span class="pre">Y</span></code>;</p></li>
<li><p>each non-negative element of <code class="docutils literal notranslate"><span class="pre">Y</span></code> has its index repeated in <code class="docutils literal notranslate"><span class="pre">R</span></code> as many times as the element’s value;</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">Y</span></code> only contains zeroes, <code class="docutils literal notranslate"><span class="pre">R</span></code> is an empty vector;</p></li>
<li><p>each element of <code class="docutils literal notranslate"><span class="pre">R</span></code> can be used as <code class="docutils literal notranslate"><span class="pre">i</span></code> in <code class="docutils literal notranslate"><span class="pre">i⌷Y</span></code> to retrieve an element from <code class="docutils literal notranslate"><span class="pre">Y</span></code>.</p></li>
</ul>
</div>
<p>This repetition is similar to the way <em>Compress</em> works when the left argument only contains non-negative integers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span> <span class="m">0</span> <span class="m">0</span> <span class="m">2</span> <span class="m">0</span> <span class="m">1</span> <span class="na">/</span> <span class="s1">&#39;words!&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">wwwdd!
</span></div></div>
</div>
<p>The left argument to <em>Compress</em> tells it to use the 1st element 3 times, to use the 4th element 2 times and to use the 6th element 1 time.</p>
<p>The same argument to <code class="docutils literal notranslate"><span class="pre">⍸</span></code> returns the indices repeated as many times as they are needed:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸</span><span class="m">3</span> <span class="m">0</span> <span class="m">0</span> <span class="m">2</span> <span class="m">0</span> <span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 1 1 4 4 6
</span></div></div>
</div>
<p>In this case, we could even achieve the same effect as the <em>Compress</em> expression above by using <code class="docutils literal notranslate"><span class="pre">[]</span></code> indexing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;words!&#39;</span><span class="sr">[</span><span class="o">⍸</span><span class="m">3</span> <span class="m">0</span> <span class="m">0</span> <span class="m">2</span> <span class="m">0</span> <span class="m">1</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">wwwdd!
</span></div></div>
</div>
<p>This breaks down if we want to include negative integers in the left argument to <em>Compress</em>, which <em>Where</em> doesn’t support.</p>
<p>In fact, if the argument array contains negative integers or other numbers which aren’t integers, <code class="docutils literal notranslate"><span class="pre">DOMAIN</span> <span class="pre">ERROR</span></code>s are issued:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸</span><span class="m">0</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">¯1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DOMAIN ERROR: Where right argument must be non-negative
      ⍸0 0 1 0 ¯1
      ∧
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸</span><span class="m">0</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">0.3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DOMAIN ERROR
      ⍸0 0 1 0 0.3
      ∧
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="comparison-of-membership-index-of-and-where">
<span id="some-primitive-functions-comparison-of-membership-index-of-and-where"></span><h3><span class="section-number">4.14.5. </span>Comparison of <em>Membership</em>, <em>Index Of</em> and <em>Where</em><a class="headerlink" href="#comparison-of-membership-index-of-and-where" title="Permalink to this headline">¶</a></h3>
<p>We have discovered two different techniques, using the primitive functions <em>Membership</em> and <em>Where</em>, that allow us to look up one set of values in another and to determine the positions of the items of one set in the other. Depending on the problem that we have to solve, we can choose which of the two methods will be most appropriate for the job in hand. Consider the following example:</p>
<div class="section" id="example">
<span id="some-primitive-functions-example"></span><h4><span class="section-number">4.14.5.1. </span>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h4>
<p>A company named “Blue Hammer Inc.” has subsidiaries in a number of countries; each country being identified by a numeric code. The country names are stored in a matrix named <code class="docutils literal notranslate"><span class="pre">countries</span></code>, and the country codes are stored in a vector named <code class="docutils literal notranslate"><span class="pre">codes</span></code>. To make things easier to read, let us show those two variables:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">countries</span> <span class="kd">←</span> <span class="m">9</span> <span class="m">13</span><span class="o">⍴</span><span class="s1">&#39;France       Great BritainItaly        United StatesBelgium      Swiss        Sweden       Canada       Egypt        &#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">France       
Great Britain
Italy        
United States
Belgium      
Swiss        
Sweden       
Canada       
Egypt        
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">codes</span> <span class="kd">←</span> <span class="m">50</span> <span class="m">43</span> <span class="m">12</span> <span class="m">83</span> <span class="m">64</span> <span class="m">34</span> <span class="m">66</span> <span class="m">81</span> <span class="m">37</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">50 43 12 83 64 34 66 81 37
</span></div></div>
</div>
<p>Now let us show those two variables side by side:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">countries</span><span class="o">,</span> <span class="nv">codes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">France        50
Great Britain 43
Italy         12
United States 83
Belgium       64
Swiss         34
Sweden        66
Canada        81
Egypt         37
</span></div></div>
</div>
<p>So, Sweden is identified by 66 and Belgium is identified by 64.</p>
<p>All the sales made during the last month have been recorded in two vectors:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bhcodes</span></code> identifies in which country each sale has been made, and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bhamounts</span></code> identifies the amount of each sale.</p></li>
</ul>
<p>Here are the two vectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">bhcodes</span> <span class="kd">←</span> <span class="m">83</span> <span class="m">66</span> <span class="m">12</span> <span class="m">83</span> <span class="m">43</span> <span class="m">66</span> <span class="m">50</span> <span class="m">81</span> <span class="m">12</span> <span class="m">83</span> <span class="m">12</span> <span class="m">66</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">83 66 12 83 43 66 50 81 12 83 12 66
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">bhamounts</span> <span class="kd">←</span> <span class="m">609</span> <span class="m">727</span> <span class="m">458</span> <span class="m">469</span> <span class="m">463</span> <span class="m">219</span> <span class="m">431</span> <span class="m">602</span> <span class="m">519</span> <span class="m">317</span> <span class="m">663</span> <span class="m">631</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">609 727 458 469 463 219 431 602 519 317 663 631
</span></div></div>
</div>
<p>Some countries have not sold anything (Belgium, for example) whereas other countries made several sales (Italy, for example).</p>
</div>
<div class="section" id="first-question">
<span id="some-primitive-functions-first-question"></span><h4><span class="section-number">4.14.5.2. </span>First Question<a class="headerlink" href="#first-question" title="Permalink to this headline">¶</a></h4>
<p>We would like to focus on some selected countries (43, 50, 37 and 66) and calculate the total amount of their sales. Let’s first identify which items of <code class="docutils literal notranslate"><span class="pre">bhcodes</span></code> are relevant:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">selected</span> <span class="kd">←</span> <span class="m">37</span> <span class="m">43</span> <span class="m">50</span> <span class="m">66</span>
<span class="nv">bhcodes</span> <span class="o">∊</span> <span class="nv">selected</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 0 0 1 1 1 0 0 0 0 1
</span></div></div>
</div>
<p>Then we can apply this filter to the amounts, and add them up:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">bhcodes</span> <span class="o">∊</span> <span class="nv">selected</span><span class="p">)</span> <span class="na">/</span> <span class="nv">bhamounts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">727 463 219 431 631
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span> <span class="p">(</span><span class="nv">bhcodes</span> <span class="o">∊</span> <span class="nv">selected</span><span class="p">)</span> <span class="na">/</span> <span class="nv">bhamounts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2471
</span></div></div>
</div>
<p>An alternative solution is to find the <strong>positions</strong> of the selected countries, then using this set of indices to get the amounts, and add them. The result is, of course, the same:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">positions</span> <span class="kd">←</span> <span class="o">⍸</span><span class="nv">bhcodes</span> <span class="o">∊</span> <span class="nv">selected</span>
<span class="o">+</span><span class="na">/</span><span class="nv">bhamounts</span><span class="sr">[</span><span class="nv">positions</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2471
</span></div></div>
</div>
<p>As mentioned previously in <a class="reference internal" href="#some-primitive-functions-replicate"><span class="std std-numref">Section 4.12</span></a>), it is a kind of detour to solve this task using indexing, but here it serves to illustrate the different lookup methods.</p>
<p>Let us take a look at the selected countries and their positions in <code class="docutils literal notranslate"><span class="pre">bhcodes</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">selected</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">37 43 50 66
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">positions</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 5 6 7 12
</span></div></div>
</div>
<p>Using <em>Membership</em>, we have obtained <code class="docutils literal notranslate"><span class="pre">positions</span></code> which contains 5 items for the 4 countries in <code class="docutils literal notranslate"><span class="pre">selected</span></code>. What does it tell us?</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">positions</span></code> contains the indices of <em>all</em> of the occurrences of the selected countries in the list of sales;</p></li>
<li><p>however, the items in <code class="docutils literal notranslate"><span class="pre">positions</span></code> do not correspond to the items in <code class="docutils literal notranslate"><span class="pre">selected</span></code> on a one-to-one basis; we cannot say that country #43 is in position 2, or country #50 in position 5, and so on;</p></li>
<li><p>it does not tell us that nothing was sold in country #37. Perhaps it would have been a good idea to identify this?</p></li>
</ul>
</div>
<div class="section" id="second-question">
<span id="some-primitive-functions-second-question"></span><h4><span class="section-number">4.14.5.3. </span>Second Question<a class="headerlink" href="#second-question" title="Permalink to this headline">¶</a></h4>
<p>Now, let us suppose that we want to display the names of the selected countries. To do this, we must determine the positions of the selected country codes in the entire list of country codes, and get the corresponding names.</p>
<p>If we use the <em>Membership</em> approach, here is what we get:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">selected</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">37 43 50 66
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">positions</span> <span class="kd">←</span> <span class="o">⍸</span><span class="nv">codes</span> <span class="o">∊</span> <span class="nv">selected</span>
<span class="nv">countries</span><span class="sr">[</span><span class="nv">positions</span><span class="sr">;]</span> <span class="o">,</span> <span class="nv">selected</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">France        37
Great Britain 43
Sweden        50
Egypt         66
</span></div></div>
</div>
<p>(As a side note, above we concatenated a character matrix with a numeric vector, so the result is a <em>Mixed</em> matrix)</p>
<p>At first sight, this <strong>seems</strong> to be good: all the selected countries are displayed. However, they are not in the correct order: France is not 37, Sweden is not 50 and Egypt is not 66.</p>
<p>The problem with this method is the lack of a one-to-one correspondence between the selected countries and their positions in the list of sales. The positions will always be in the order that the countries appear in <code class="docutils literal notranslate"><span class="pre">countries</span></code> - because of <code class="docutils literal notranslate"><span class="pre">⍸</span></code>. However, the Boolean vector <code class="docutils literal notranslate"><span class="pre">codes</span> <span class="pre">∊</span> <span class="pre">selected</span></code> is completely independent of the order of the items in <code class="docutils literal notranslate"><span class="pre">selected</span></code>: the expression returns the same result no matter how <code class="docutils literal notranslate"><span class="pre">selected</span></code> is ordered.</p>
<p>The correct method to use in order to solve this task is to use the <em>Index Of</em> function (dyadic Iota):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">positions</span> <span class="kd">←</span> <span class="nv">codes</span> <span class="o">⍳</span> <span class="nv">selected</span>
<span class="nv">countries</span><span class="sr">[</span><span class="nv">positions</span><span class="sr">;]</span> <span class="o">,</span> <span class="nv">selected</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">Egypt         37
Great Britain 43
France        50
Sweden        66
</span></div></div>
</div>
<p>It is the one-to-one relationship between the items of the right argument to <em>Index Of</em> (<code class="docutils literal notranslate"><span class="pre">selected</span></code>) and the items of its result (<code class="docutils literal notranslate"><span class="pre">positions</span></code>) that guarantees a correct result.</p>
</div>
<div class="section" id="comparison">
<span id="some-primitive-functions-comparison"></span><h4><span class="section-number">4.14.5.4. </span>Comparison<a class="headerlink" href="#comparison" title="Permalink to this headline">¶</a></h4>
<p>The following table summarises the most important properties of the two methods:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Method</p></th>
<th class="text-align:left head"><p>Properties</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">pos</span> <span class="pre">←</span> <span class="pre">⍸list</span> <span class="pre">∊</span> <span class="pre">data</span></code></p></td>
<td class="text-align:left"><p>the items in <code class="docutils literal notranslate"><span class="pre">pos</span></code> do not have a 1-to-1 correspondence with the items in <code class="docutils literal notranslate"><span class="pre">data</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td class="text-align:left"><p>instead, the items in <code class="docutils literal notranslate"><span class="pre">pos</span></code> correspond to the items in <code class="docutils literal notranslate"><span class="pre">list</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">pos</span></code> gives all the positions of multiple occurrences of <code class="docutils literal notranslate"><span class="pre">list</span></code> in <code class="docutils literal notranslate"><span class="pre">data</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">pos</span></code> does not explicitly identify missing values</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">pos</span> <span class="pre">←</span> <span class="pre">list</span> <span class="pre">⍳</span> <span class="pre">data</span></code></p></td>
<td class="text-align:left"><p>the items in <code class="docutils literal notranslate"><span class="pre">pos</span></code> <strong>do</strong> have a 1-to-1 correspondence with the items in <code class="docutils literal notranslate"><span class="pre">data</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">pos</span></code> ignores multiple occurrences; just gives the first</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">pos</span></code> identifies missing values</p></td>
</tr>
</tbody>
</table>
<p>The choice of method depends on the kind of problem you want to solve.</p>
</div>
</div>
</div>
<div class="section" id="index-generator">
<span id="some-primitive-functions-index-generator"></span><h2><span class="section-number">4.15. </span>Index Generator<a class="headerlink" href="#index-generator" title="Permalink to this headline">¶</a></h2>
<div class="section" id="basic-usage">
<span id="some-primitive-functions-basic-usage"></span><h3><span class="section-number">4.15.1. </span>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h3>
<p>When used as a monadic function, the symbol <em>Iota</em> generates a vector of the first <code class="docutils literal notranslate"><span class="pre">N</span></code> positive integers. It is called <em><strong>Index Generator</strong></em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍳</span><span class="m">9</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3 4 5 6 7 8 9
</span></div></div>
</div>
<p>If we have to extract the first 12 items of a vector <code class="docutils literal notranslate"><span class="pre">contents</span></code>, we can write:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">contents</span><span class="sr">[</span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span> <span class="m">7</span> <span class="m">8</span> <span class="m">9</span> <span class="m">10</span> <span class="m">11</span> <span class="m">12</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12 56 78 74 85 96 30 22 44 66 82 27
</span></div></div>
</div>
<p>It is, of course, much easier to write</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">contents</span><span class="sr">[</span><span class="o">⍳</span><span class="m">12</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12 56 78 74 85 96 30 22 44 66 82 27
</span></div></div>
</div>
<p>The result can be combined with simple arithmetic operations. For example, supposed we need to produce the following list of 6 values: 115 122 129 136 143 150 (note the increments of 7). We can do this as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍳</span><span class="m">6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3 4 5 6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">⍳</span><span class="m">6</span><span class="p">)</span><span class="o">-</span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 2 3 4 5
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">7</span><span class="o">×</span><span class="p">(</span><span class="o">⍳</span><span class="m">6</span><span class="p">)</span><span class="o">-</span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 7 14 21 28 35
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">115</span><span class="o">+</span><span class="m">7</span><span class="o">×</span><span class="p">(</span><span class="o">⍳</span><span class="m">6</span><span class="p">)</span><span class="o">-</span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">115 122 129 136 143 150
</span></div></div>
</div>
<p>More generally, any arithmetic series of integers can be produced by the following algorithm:</p>
<div class="algorithm admonition">
<p class="admonition-title">Algorithm</p>
<p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">←</span> <span class="pre">origin</span> <span class="pre">+</span> <span class="pre">step</span> <span class="pre">×</span> <span class="pre">(⍳length)</span> <span class="pre">-</span> <span class="pre">1</span></code></p>
</div>
<div class="note admonition">
<p class="admonition-title">Special Case</p>
<p>If <code class="docutils literal notranslate"><span class="pre">⍳n</span></code> gives a vector of length <code class="docutils literal notranslate"><span class="pre">n</span></code>, then <code class="docutils literal notranslate"><span class="pre">⍳0</span></code> should give a vector of length <code class="docutils literal notranslate"><span class="pre">0</span></code>, right? A vector having length 0 is an empty vector. In particular, this will be a <em>numeric</em> empty vector.</p>
</div>
<p>Let us check:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍳</span><span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">
</span></div></div>
</div>
<p>Nothing gets displayed above, so it does look like the numeric empty vector <code class="docutils literal notranslate"><span class="pre">⍬</span></code>, which we can confirm with <em>Match</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="no">⍬</span><span class="o">≡⍳</span><span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>This was useful in early versions of APL, before the introduction of the <em>Zilde</em> symbol (<code class="docutils literal notranslate"><span class="pre">⍬</span></code>).</p>
<p>The definition of <code class="docutils literal notranslate"><span class="pre">⍳n</span></code> given above reflects only a limited part of what this function can do; you will find more information in <a class="reference internal" href="#some-primitive-functions-the-specialists-section"><span class="std std-numref">Section 4.19</span></a> at the end of this chapter.</p>
</div>
<div class="section" id="application-5">
<span id="some-primitive-functions-application-5"></span><h3><span class="section-number">4.15.2. </span>Application 5<a class="headerlink" href="#application-5" title="Permalink to this headline">¶</a></h3>
<p>Sometimes, a programmer needs to remove duplicate items from a vector and there is a well-known idiomatic way to do this. The idiom applies equally to numeric, character and nested vectors. Let us begin with a numeric vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">vec</span> <span class="kd">←</span> <span class="m">12</span> <span class="m">89</span> <span class="m">57</span> <span class="m">46</span> <span class="m">12</span> <span class="m">50</span> <span class="m">36</span> <span class="m">47</span> <span class="m">83</span> <span class="m">46</span> <span class="m">27</span> <span class="m">12</span>
</pre></div>
</div>
</div>
</div>
<p>The algorithm is based on the comparison of two vectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍳≢</span><span class="nv">vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3 4 5 6 7 8 9 10 11 12
</span></div></div>
</div>
<p>which gives the position of each item of <code class="docutils literal notranslate"><span class="pre">vec</span></code>, and</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">vec</span><span class="o">⍳</span><span class="nv">vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3 4 1 6 7 8 9 4 11 1
</span></div></div>
</div>
<p>which identifies the first index in <code class="docutils literal notranslate"><span class="pre">vec</span></code> in which each element of <code class="docutils literal notranslate"><span class="pre">vec</span></code> is found. This may be a bit more complex to understand, so take your time to digest it. We are using <code class="docutils literal notranslate"><span class="pre">⍳</span></code> to identify the positions of the items of <code class="docutils literal notranslate"><span class="pre">vec</span></code> in <code class="docutils literal notranslate"><span class="pre">vec</span></code> itself. But because <em>Index Of</em> only returns the first occurrences, we get, for each item, the position where this value appears for the first time.</p>
<p>If we then compare these two vectors, we get a Boolean vector indicating which items of <code class="docutils literal notranslate"><span class="pre">vec</span></code> are their first occurrences and which are repetitions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">⍳≢</span><span class="nv">vec</span><span class="p">)</span><span class="o">=</span><span class="nv">vec</span><span class="o">⍳</span><span class="nv">vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 1 1 1 0 1 1 1 1 0 1 0
</span></div></div>
</div>
<p>Finally, we can use <em>Compress</em> to keep only the first occurrences, so that the algorithm is as follows:</p>
<div class="algorithm admonition">
<p class="admonition-title">Algorithm</p>
<p><code class="docutils literal notranslate"><span class="pre">((⍳≢vector)</span> <span class="pre">=</span> <span class="pre">vector</span> <span class="pre">⍳</span> <span class="pre">vector)</span> <span class="pre">/</span> <span class="pre">vector</span></code></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="o">⍳≢</span><span class="nv">vec</span><span class="p">)</span><span class="o">=</span><span class="nv">vec</span><span class="o">⍳</span><span class="nv">vec</span><span class="p">)</span><span class="na">/</span><span class="nv">vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12 89 57 46 50 36 47 83 27
</span></div></div>
</div>
<p>The result above has <em>no</em> duplicates.</p>
<p>It also works on character arrays and on nested arrays:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">text</span> <span class="kd">←</span> <span class="s1">&#39;All men are created equal&#39;</span>
<span class="p">((</span><span class="o">⍳≢</span><span class="nv">text</span><span class="p">)</span><span class="o">=</span><span class="nv">text</span><span class="o">⍳</span><span class="nv">text</span><span class="p">)</span><span class="na">/</span><span class="nv">text</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">Al menarctdqu
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">nested</span> <span class="kd">←</span> <span class="s1">&#39;one&#39;</span> <span class="m">1</span> <span class="p">(</span><span class="m">2</span> <span class="m">2</span><span class="o">⍴⍳</span><span class="m">4</span><span class="p">)</span> <span class="m">9</span> <span class="s1">&#39;nine&#39;</span> <span class="s1">&#39;five&#39;</span> <span class="s1">&#39;nine&#39;</span> <span class="m">1</span> <span class="s1">&#39;two&#39;</span> <span class="p">(</span><span class="m">2</span> <span class="m">2</span><span class="o">⍴⍳</span><span class="m">4</span><span class="p">)</span> <span class="s1">&#39;two&#39;</span> <span class="s1">&#39;one&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───┬─┬───┬─┬────┬────┬────┬─┬───┬───┬───┬───┐
│one│1│1 2│9│nine│five│nine│1│two│1 2│two│one│
│   │ │3 4│ │    │    │    │ │   │3 4│   │   │
└───┴─┴───┴─┴────┴────┴────┴─┴───┴───┴───┴───┘
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="o">⍳≢</span><span class="nv">nested</span><span class="p">)</span><span class="o">=</span><span class="nv">nested</span><span class="o">⍳</span><span class="nv">nested</span><span class="p">)</span><span class="na">/</span><span class="nv">nested</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───┬─┬───┬─┬────┬────┬───┐
│one│1│1 2│9│nine│five│two│
│   │ │3 4│ │    │    │   │
└───┴─┴───┴─┴────┴────┴───┘
</span></div></div>
</div>
<div class="section" id="unique">
<span id="some-primitive-functions-unique"></span><h4><span class="section-number">4.15.2.1. </span>Unique<a class="headerlink" href="#unique" title="Permalink to this headline">¶</a></h4>
<p>Although still useful as an example, the idiom described above is now completely obsolete, because there is a primitive function in APL that does exactly this.</p>
<p>The primitive, called <em><strong>Unique</strong></em>, is represented by the symbol <code class="docutils literal notranslate"><span class="pre">∪</span></code> (<kbd>APL</kbd>+<kbd>v</kbd>) used as a monadic function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">∪</span> <span class="nv">vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12 89 57 46 50 36 47 83 27
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">∪</span> <span class="nv">text</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">Al menarctdqu
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">∪</span> <span class="nv">nested</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───┬─┬───┬─┬────┬────┬───┐
│one│1│1 2│9│nine│five│two│
│   │ │3 4│ │    │    │   │
└───┴─┴───┴─┴────┴────┴───┘
</span></div></div>
</div>
<p>The symbol <code class="docutils literal notranslate"><span class="pre">∪</span></code> is the mathematical symbol for set union and we will see this is <em>not</em> a coincidence.</p>
</div>
</div>
<div class="section" id="application-6">
<span id="some-primitive-functions-application-6"></span><h3><span class="section-number">4.15.3. </span>Application 6<a class="headerlink" href="#application-6" title="Permalink to this headline">¶</a></h3>
<p>Some applications of <em>Index Generator</em> are extremely basic, but so useful! Suppose that you invest a certain sum of money, €6,000 for example, and you expect an interest rate of 4% p.a.. How is the investment expected to grow in the next 5 years?</p>
<p>We will have to calculate 1.04 to the power of 0, 1, 2, 3 and 4. The <em>Index Generator</em> will help us:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">6000</span><span class="o">×</span><span class="m">1.04</span><span class="o">*</span><span class="p">(</span><span class="o">⍳</span><span class="m">6</span><span class="p">)</span><span class="o">-</span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6000 6240 6489.6 6749.18 7019.15 7299.92
</span></div></div>
</div>
</div>
</div>
<div class="section" id="ravel">
<span id="some-primitive-functions-ravel"></span><h2><span class="section-number">4.16. </span>Ravel<a class="headerlink" href="#ravel" title="Permalink to this headline">¶</a></h2>
<p>The function <em><strong>Ravel</strong></em> is represented by the monadic use of comma (<code class="docutils literal notranslate"><span class="pre">,</span></code>). Applied to any array, it returns all its items as a vector.</p>
<p>Naturally, if the array is already a vector, <em>Ravel</em> does not change anything.</p>
<p>Let us see how it works on some matrices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕RL</span> <span class="kd">←</span> <span class="m">73</span>
<span class="o">⊢</span><span class="nv">tests</span> <span class="kd">←</span> <span class="o">?</span><span class="m">6</span> <span class="m">3</span><span class="o">⍴</span><span class="m">100</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">73  16 42
50   2 67
11  81 37
93 100 98
83  32 76
51  37 15
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">,</span><span class="nv">tests</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">73 16 42 50 2 67 11 81 37 93 100 98 83 32 76 51 37 15
</span></div></div>
</div>
<p>The items of the matrix have been strung out and returned as a vector, row by row.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">H2SO4
CaCO3
Fe2O3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">,</span><span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">H2SO4CaCO3Fe2O3
</span></div></div>
</div>
<p>A common use of <em><strong>Ravel</strong></em> is to transform a scalar into a 1-item vector. The difference between a scalar and a 1-item vector is not readily obvious, until you use it as an index into a matrix.</p>
<p>Suppose that you need to select a particular set of columns <code class="docutils literal notranslate"><span class="pre">cols</span></code> from the matrix <code class="docutils literal notranslate"><span class="pre">forecast</span></code>. As long as <code class="docutils literal notranslate"><span class="pre">cols</span></code> contains more than one value, the result will be a matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">cols</span> <span class="kd">←</span> <span class="m">1</span> <span class="m">4</span> <span class="m">6</span>
<span class="nv">forecast</span><span class="sr">[;</span><span class="nv">cols</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 90 500  30
110 370 360
340 120 370
150 520 280
</span></div></div>
</div>
<p>But if <code class="docutils literal notranslate"><span class="pre">cols</span></code> happens to have only a single value, which is a scalar, the result returned is a vector (we already mentioned this in <a class="reference internal" href="Data-and-Variables.html#data-and-variables-array-indexing"><span class="std std-numref">Section 3.5.3</span></a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">cols</span> <span class="kd">←</span> <span class="m">4</span>
<span class="nv">forecast</span><span class="sr">[;</span><span class="nv">cols</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">500 370 120 520
</span></div></div>
</div>
<p>The rank of the result may be critical if some other expression in your program expects a matrix.</p>
<p>To make certain that your indexing expression always returns a matrix, you must ensure that your index will always be a vector by using <em>Ravel</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">forecast</span><span class="sr">[;</span><span class="o">,</span><span class="nv">cols</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">500
370
120
520
</span></div></div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">,cols</span></code>, whatever the rank of <code class="docutils literal notranslate"><span class="pre">cols</span></code> is, the result will always be a matrix.</p>
<p><em>Ravel</em> can be associated with an <em>Axis</em> specifier; this will be discussed in <a class="reference internal" href="#some-primitive-functions-ravel-with-axis"><span class="std std-numref">Section 4.19.5</span></a>.</p>
</div>
<div class="section" id="empty-vectors-and-black-holes">
<span id="some-primitive-functions-empty-vectors-and-black-holes"></span><h2><span class="section-number">4.17. </span>Empty Vectors and Black Holes<a class="headerlink" href="#empty-vectors-and-black-holes" title="Permalink to this headline">¶</a></h2>
<p>When we apply a scalar dyadic function to a vector and a scalar, the rule is that the result has the same size as the vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">42</span> <span class="m">75</span> <span class="m">86</span> <span class="m">31</span> <span class="o">+</span> <span class="m">10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">52 85 96 41
</span></div></div>
</div>
<p>Above, a scalar added to a 4-item vector gives a 4-item vector, too.</p>
<p>Below, a 7-item vector compared to a scalar gives a 7-item vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;MAMMOTH&#39;</span> <span class="o">=</span> <span class="s1">&#39;M&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 0 1 1 0 0 0
</span></div></div>
</div>
<p>But what happens if the vector is empty? The rule says that the result must have the same size as the vector: therefore it should be empty, too, regardless of the (scalar) function that we used!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">hole</span> <span class="kd">←</span> <span class="no">⍬</span>
<span class="nv">hole</span> <span class="o">+</span> <span class="m">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">
</span></div></div>
</div>
<p>Notice how nothing is displayed above: the result is empty.</p>
<p>The same thing happens if we multiply by 100, for example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">hole</span> <span class="o">×</span> <span class="m">100</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">Hole</span> <span class="o">=</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>VALUE ERROR: Undefined name: Hole
      Hole=0
      ∧
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">hole</span> <span class="o">=</span> <span class="nv">hole</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">hole</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">hole</span> <span class="o">≡</span> <span class="no">⍬</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>If you were working on the terminal and getting all these empty results, you could compare <code class="docutils literal notranslate"><span class="pre">hole</span></code> to <code class="docutils literal notranslate"><span class="pre">⍬</span></code> with <em>Match</em> and conclude <code class="docutils literal notranslate"><span class="pre">hole</span></code> is an empty numeric vector.</p>
<p>Empty vectors look very much like black holes: they absorb everything (but only when used with scalar functions). This may lead to some unexpected results.</p>
<div class="section" id="not-all-empty-vectors-are-created-equal">
<span id="some-primitive-functions-not-all-empty-vectors-are-created-equal"></span><h3><span class="section-number">4.17.1. </span>Not All Empty Vectors Are Created Equal<a class="headerlink" href="#not-all-empty-vectors-are-created-equal" title="Permalink to this headline">¶</a></h3>
<p>Something that might throw off new APLers is the fact that there are infinitely many different empty vectors. The first two examples being <code class="docutils literal notranslate"><span class="pre">⍬</span></code> and <code class="docutils literal notranslate"><span class="pre">''</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="no">⍬</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">
</span></div></div>
</div>
<p>They look the same when displayed as results, but they are <em>not</em> the same:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="no">⍬</span><span class="o">≡</span><span class="s1">&#39;&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<p>And this is just the tip of the iceberg. If you recall the rule for <em>Where</em> (monadic <code class="docutils literal notranslate"><span class="pre">⍸</span></code>), we know that <code class="docutils literal notranslate"><span class="pre">⍸Y</span></code> returns an empty vector if <code class="docutils literal notranslate"><span class="pre">Y</span></code> only contains 0s, but an empty vector of <em>what</em>?</p>
<p>If <code class="docutils literal notranslate"><span class="pre">Y</span></code> contains positive integers, then the result of <code class="docutils literal notranslate"><span class="pre">⍸Y</span></code> will contain some indices that can be used to index into <code class="docutils literal notranslate"><span class="pre">Y</span></code> and the shape of those indices depends on the shape of <code class="docutils literal notranslate"><span class="pre">Y</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸</span> <span class="m">2</span> <span class="m">2</span><span class="o">⍴</span><span class="m">1</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───┬───┐
│1 1│2 1│
└───┴───┘
</span></div></div>
</div>
<p>So in the first example we see a vector with 2 integers and in the second example we see a vector with 2 vectors, each containing 2 items.</p>
<p>If we change one of the 1s to a 0, here is what we will be getting:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸</span> <span class="m">1</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸</span> <span class="m">2</span> <span class="m">2</span><span class="o">⍴</span><span class="m">1</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───┐
│1 1│
└───┘
</span></div></div>
</div>
<p>Now we have a vector with 1 integer and a vector with 1 vector of 2 items.</p>
<p>If we change the final 1 to a 0, we will be getting a vector with 0 integers (an empty numeric vector <code class="docutils literal notranslate"><span class="pre">⍬</span></code>) and a vector with 0 vectors of 2 items. For APL, these are <em>not</em> the same thing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="no">⍬</span><span class="o">≡⍸</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸</span> <span class="m">2</span> <span class="m">2</span><span class="o">⍴</span><span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">


</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="no">⍬</span><span class="o">≡⍸</span> <span class="m">2</span> <span class="m">2</span><span class="o">⍴</span><span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>        <span class="c1">⍝ different empty vectors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<div class="tip admonition">
<p class="admonition-title">Tip</p>
<p>When you are dealing with empty vectors, you can use the incantation <code class="docutils literal notranslate"><span class="pre">⎕SE.Dyalog.Utils.repObj</span></code> to inspect their actual shape.</p>
</div>
<p>To illustrate this incantation, we will see what it returns for the empty vectors we saw above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕SE</span><span class="na">.</span><span class="nv">Dyalog</span><span class="na">.</span><span class="nv">Utils</span><span class="na">.</span><span class="nv">repObj</span> <span class="s1">&#39;&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">''
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕SE</span><span class="na">.</span><span class="nv">Dyalog</span><span class="na">.</span><span class="nv">Utils</span><span class="na">.</span><span class="nv">repObj</span> <span class="no">⍬</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">⍬
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕SE</span><span class="na">.</span><span class="nv">Dyalog</span><span class="na">.</span><span class="nv">Utils</span><span class="na">.</span><span class="nv">repObj</span> <span class="o">⍸</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">⍬
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕SE</span><span class="na">.</span><span class="nv">Dyalog</span><span class="na">.</span><span class="nv">Utils</span><span class="na">.</span><span class="nv">repObj</span> <span class="o">⍸</span> <span class="m">2</span> <span class="m">2</span><span class="o">⍴</span><span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0⍴⊂2⍴0
</span></div></div>
</div>
<p>What the code cell above tells us is that <code class="docutils literal notranslate"><span class="pre">⍸</span> <span class="pre">2</span> <span class="pre">2⍴0</span> <span class="pre">0</span> <span class="pre">0</span> <span class="pre">0</span></code> matches <code class="docutils literal notranslate"><span class="pre">0⍴⊂2⍴0</span></code>, which you can check by copying &amp; pasting the result above, or using <kbd>APL</kbd>+<kbd>z</kbd> to type <code class="docutils literal notranslate"><span class="pre">⊂</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">0</span><span class="o">⍴⊂</span><span class="m">2</span><span class="o">⍴</span><span class="m">0</span><span class="p">)</span><span class="o">≡</span><span class="p">(</span><span class="o">⍸</span> <span class="m">2</span> <span class="m">2</span><span class="o">⍴</span><span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>(You will learn about what <code class="docutils literal notranslate"><span class="pre">⊂</span></code> does in a future chapter, don’t worry.)</p>
<div class="figure align-default" id="hierarchy">
<span id="fig-hierarchy"></span><img alt="_images/Hierarchy.png" src="_images/Hierarchy.png" />
</div>
</div>
</div>
<div class="section" id="exercises">
<span id="some-primitive-functions-exercises"></span><h2><span class="section-number">4.18. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<div class="warning admonition">
<p class="admonition-title">Warning</p>
<p><em>The following exercises are designed to train <strong>you</strong>, not the computer.</em></p>
<p><em>For this reason, we suggest that you try to answer them on a sheet of paper, not on your computer. When you are sure of your answer, you can test it on the computer.</em></p>
</div>
<p><strong>Exercise 1</strong>:</p>
<p>Can you evaluate the following expressions?</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span> <span class="o">×</span> <span class="m">2</span> <span class="o">+</span> <span class="m">6</span> <span class="o">≠</span> <span class="m">3</span> <span class="o">×</span> <span class="m">2</span>
<span class="m">12</span> <span class="m">6</span> <span class="m">27</span> <span class="o">⌊</span> <span class="m">11</span> <span class="o">+</span> <span class="o">⍳</span><span class="m">3</span>
<span class="m">4</span> <span class="m">5</span> <span class="m">6</span> <span class="o">⌈</span> <span class="m">4</span> <span class="o">+</span> <span class="m">2</span> <span class="m">5</span> <span class="m">9</span> <span class="o">&gt;</span> <span class="m">1</span> <span class="m">6</span> <span class="m">8</span>
<span class="m">7</span> <span class="o">⌊</span> <span class="m">25</span> <span class="m">6</span> <span class="m">17</span> <span class="o">-</span> <span class="p">(</span><span class="m">2</span> <span class="o">×</span> <span class="m">3</span><span class="p">)</span> <span class="o">+</span> <span class="m">9</span> <span class="m">3</span> <span class="m">5</span>
<span class="p">((</span><span class="m">8</span> <span class="o">+</span> <span class="m">6</span><span class="p">)</span> <span class="o">×</span> <span class="m">2</span> <span class="o">+</span> <span class="m">1</span><span class="p">)</span> <span class="o">×</span> <span class="m">3</span> <span class="o">-</span> <span class="m">6</span> <span class="o">÷</span> <span class="m">3</span>
<span class="p">(</span><span class="o">⍴</span><span class="m">4</span><span class="o">⌈</span><span class="m">5</span><span class="p">)</span> <span class="o">+</span> <span class="m">4</span><span class="o">⌈</span><span class="m">5</span>
<span class="m">1</span> <span class="o">⊢</span> <span class="m">2</span> <span class="o">⊣</span> <span class="m">3</span> <span class="o">⊢</span> <span class="m">4</span> <span class="o">⊣</span> <span class="m">5</span> <span class="o">⊢</span> <span class="m">6</span> <span class="o">⊣</span> <span class="m">7</span>
<span class="m">1</span> <span class="o">⊣</span> <span class="m">2</span> <span class="o">⊢</span> <span class="m">3</span> <span class="o">⊣</span> <span class="m">4</span> <span class="o">⊢</span> <span class="m">5</span> <span class="o">⊣</span> <span class="m">6</span> <span class="o">⊢</span> <span class="m">7</span>
<span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="o">⊢</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span>
</pre></div>
</div>
<p><strong>Exercise 2</strong>:</p>
<p>Try to evaluate the following expressions. <em>Be careful</em>: they are not as simple as might first appear!</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span> <span class="m">2</span><span class="o">+</span><span class="m">2</span> <span class="m">2</span>
<span class="m">2</span><span class="o">+</span><span class="m">2</span> <span class="m">2</span><span class="o">+</span><span class="m">2</span>
<span class="m">2</span><span class="o">+</span><span class="m">2</span><span class="o">,</span><span class="m">2</span><span class="o">+</span><span class="m">2</span>
<span class="m">2</span><span class="o">,</span><span class="m">2</span><span class="o">+</span><span class="m">2</span><span class="o">,</span><span class="m">2</span>
</pre></div>
</div>
<p><strong>Exercise 3</strong>:</p>
<p>Given the vector <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">←</span> <span class="pre">8</span> <span class="pre">2</span> <span class="pre">7</span> <span class="pre">5</span></code>, compare the results obtained from the following sets of expressions:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="o">+⍴</span><span class="nv">a</span>
<span class="o">⍴</span><span class="nv">a</span><span class="o">+</span><span class="m">1</span>
</pre></div>
</div>
<p>and also</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="o">+⍳⍴</span><span class="nv">a</span>
<span class="o">⍳</span><span class="m">¯1</span><span class="o">+⍴</span><span class="nv">a</span>
<span class="o">⍳⍴</span><span class="nv">a</span><span class="o">-</span><span class="m">1</span>
</pre></div>
</div>
<p><strong>Exercise 4</strong>:</p>
<p>Using your knowledge of the order of evaluation in APL, re-write the following expressions without using parentheses.</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="o">⍳</span><span class="m">4</span><span class="p">)</span><span class="o">-</span><span class="m">1</span><span class="p">)</span><span class="o">⌈</span><span class="m">3</span>
<span class="m">7</span><span class="o">⌊</span><span class="p">(</span><span class="o">⍳</span><span class="m">9</span><span class="p">)</span><span class="o">⌈</span><span class="m">3</span>
<span class="m">1</span><span class="o">+</span><span class="p">((</span><span class="o">⍳</span><span class="m">5</span><span class="p">)</span><span class="o">=</span><span class="m">1</span> <span class="m">4</span> <span class="m">3</span> <span class="m">2</span> <span class="m">5</span><span class="p">)</span><span class="o">×</span><span class="m">5</span>
</pre></div>
</div>
<p><strong>Exercise 5</strong>:</p>
<p>Given a variable <code class="docutils literal notranslate"><span class="pre">a</span></code>, find an expression which returns the answer 1 if <code class="docutils literal notranslate"><span class="pre">a</span></code> is a scalar, and 0 if it is not.</p>
<p><strong>Exercise 6</strong>:</p>
<p>Given two scalars <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>, write an expressions which gives 7 if <code class="docutils literal notranslate"><span class="pre">a</span></code> is greater than or equal to <code class="docutils literal notranslate"><span class="pre">b</span></code> and 3 if <code class="docutils literal notranslate"><span class="pre">a</span></code> is smaller than <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
<p><strong>Exercise 7</strong>:</p>
<p>Given two scalars <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>, find an expression which returns:</p>
<ul class="simple">
<li><p>an empty vector, if <code class="docutils literal notranslate"><span class="pre">a</span></code> is zero, whatever the value of <code class="docutils literal notranslate"><span class="pre">b</span></code>;</p></li>
<li><p>0, if <code class="docutils literal notranslate"><span class="pre">b</span></code> is zero, but <code class="docutils literal notranslate"><span class="pre">a</span></code> is not;</p></li>
<li><p>3, if neither <code class="docutils literal notranslate"><span class="pre">a</span></code> nor <code class="docutils literal notranslate"><span class="pre">b</span></code> are zero.</p></li>
</ul>
<p><strong>Exercise 8</strong>:</p>
<p>Unfortunately, your keyboard has been damaged and your <code class="docutils literal notranslate"><span class="pre">∧</span></code> and <code class="docutils literal notranslate"><span class="pre">∨</span></code> keys no longer work. Which other symbols could you use to replace them?</p>
<p>You can test your solutions on these vectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">l</span> <span class="kd">←</span> <span class="m">0</span> <span class="m">0</span> <span class="m">1</span> <span class="m">1</span>
<span class="nv">r</span> <span class="kd">←</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 9</strong>:</p>
<p>Given these three vectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">g</span> <span class="kd">←</span> <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> <span class="m">0</span> <span class="m">0</span> <span class="m">1</span>
<span class="nv">m</span> <span class="kd">←</span> <span class="m">0</span> <span class="m">0</span> <span class="m">1</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span>
<span class="nv">d</span> <span class="kd">←</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span>
</pre></div>
</div>
</div>
</div>
<p>Evaluate the following expressions:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">g</span><span class="o">∨</span><span class="nv">d</span>
<span class="o">~</span><span class="nv">g</span><span class="o">∧</span><span class="nv">d</span>
<span class="o">~</span><span class="nv">g</span><span class="o">∨~</span><span class="nv">d</span>
<span class="nv">d</span><span class="o">∧~</span><span class="nv">g</span>
<span class="nv">g</span><span class="o">∧</span><span class="nv">m</span><span class="o">∨</span><span class="nv">d</span>
<span class="p">(</span><span class="o">~</span><span class="nv">d</span><span class="p">)</span><span class="o">∧</span><span class="p">(</span><span class="o">~</span><span class="nv">g</span><span class="p">)</span>
<span class="p">(</span><span class="nv">m</span><span class="o">⌈</span><span class="nv">g</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="nv">m</span><span class="o">⌊</span><span class="nv">d</span><span class="p">)</span>
<span class="p">(</span><span class="nv">m</span><span class="o">⌊</span><span class="nv">g</span><span class="p">)</span><span class="o">≠</span><span class="p">(</span><span class="nv">m</span><span class="o">⌈</span><span class="nv">d</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Exercise 10</strong>:</p>
<p>Evaluate the following expressions:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span> <span class="o">&lt;</span> <span class="m">0</span> <span class="o">≤</span> <span class="m">0</span> <span class="o">=</span> <span class="m">0</span> <span class="o">≥</span> <span class="m">0</span> <span class="o">&gt;</span> <span class="m">0</span>
<span class="s1">&#39;sugar&#39;</span> <span class="o">∊</span> <span class="s1">&#39;salt&#39;</span>
<span class="m">11</span> <span class="o">≠</span> <span class="s1">&#39;11&#39;</span>
<span class="s1">&#39;14&#39;</span> <span class="o">⍳</span> <span class="s1">&#39;41&#39;</span>
</pre></div>
</div>
<p><strong>Exercise 11</strong>:</p>
<p>Write an expression to compute the number of times the letter “e” appears in a character vector. You can test it with this vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">text</span> <span class="kd">←</span> <span class="s1">&#39;The silence of the sea&#39;</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 12</strong>:</p>
<p>How many expressions can you write to retrieve the last element of a vector? Can you write one that uses the <em>Reduce</em> operator <code class="docutils literal notranslate"><span class="pre">/</span></code>?</p>
<p>You can test your expressions on these vectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">vec</span> <span class="kd">←</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span>
<span class="nv">vec</span> <span class="kd">←</span> <span class="p">(</span><span class="m">1</span> <span class="m">2</span><span class="p">)</span> <span class="m">3</span> <span class="p">(</span><span class="m">4</span> <span class="m">5</span><span class="p">)</span> <span class="m">6</span>
<span class="nv">vec</span> <span class="kd">←</span> <span class="m">0</span> <span class="p">(</span><span class="m">5</span><span class="o">⍴</span><span class="m">0</span><span class="p">)</span> <span class="p">(</span><span class="m">3</span> <span class="m">4</span><span class="o">⍴</span><span class="m">0</span><span class="p">)</span> <span class="p">(</span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span><span class="o">⍴</span><span class="m">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 13</strong>:</p>
<p>We have conducted some experiments on a variable <code class="docutils literal notranslate"><span class="pre">z</span></code>:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span>      <span class="m">2</span> <span class="o">⍴</span> <span class="nv">z</span>
<span class="m">1</span> <span class="m">7</span>
      <span class="o">+</span><span class="na">⌿</span> <span class="nv">z</span>
<span class="m">20</span>
      <span class="nv">z</span> <span class="o">=</span> <span class="m">9</span>
<span class="m">0</span>
<span class="m">0</span>
<span class="m">1</span>
<span class="m">0</span>
</pre></div>
</div>
<p>What is the value of <code class="docutils literal notranslate"><span class="pre">z</span></code>?</p>
<p><strong>Exercise 14</strong>:</p>
<p>We have conducted some experiments on a variable <code class="docutils literal notranslate"><span class="pre">z</span></code>:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span>      <span class="nv">z</span> <span class="o">=</span> <span class="m">0</span>
<span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">0</span>
<span class="m">1</span> <span class="m">0</span> <span class="m">0</span> <span class="m">1</span>
      <span class="o">+</span><span class="na">/</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span> <span class="nv">z</span>
<span class="m">20</span> <span class="m">6</span>
      <span class="o">+</span><span class="na">/</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span> <span class="nv">z</span>
<span class="m">8</span> <span class="m">7</span> <span class="m">6</span> <span class="m">5</span>
</pre></div>
</div>
<p>What is the value of <code class="docutils literal notranslate"><span class="pre">z</span></code>?</p>
<p><strong>Exercise 15</strong>:</p>
<p>What are all the <strong>positions</strong> of the letter “e” in the character vector specified in exercise 11?</p>
<p><strong>Exercise 16</strong>:</p>
<p>Given a vector <code class="docutils literal notranslate"><span class="pre">vec</span></code> of any size and type (numeric or character or even nested), try to extract the items of <code class="docutils literal notranslate"><span class="pre">vec</span></code> which are in the odd positions (the 1st, the 3rd, the 5th, …).</p>
<p>You can test your solution on these vectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">vec</span> <span class="kd">←</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span> <span class="m">7</span> <span class="m">8</span> <span class="m">9</span>
<span class="nv">vec</span> <span class="kd">←</span> <span class="s1">&#39;CROANGGARYANTLULLBAPTWIZOSNSSB&#39;</span>
<span class="nv">vec</span> <span class="kd">←</span> <span class="p">(</span><span class="m">1</span> <span class="m">2</span><span class="p">)</span> <span class="p">(</span><span class="m">2</span> <span class="m">3</span><span class="p">)</span> <span class="p">(</span><span class="m">4</span> <span class="m">5</span> <span class="m">6</span><span class="p">)</span> <span class="p">(</span><span class="m">6</span> <span class="m">9</span> <span class="m">42</span> <span class="m">1024</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 17</strong>:</p>
<p>How many numbers are there in the variable <code class="docutils literal notranslate"><span class="pre">prod</span></code> used in this chapter? Try to answer with and without using <em>Ravel</em> (monadic <code class="docutils literal notranslate"><span class="pre">,</span></code>).</p>
<p><strong>Exercise 18</strong>:</p>
<p>How is it possible to remove all the values which do not fall between 20 (inclusive) and 30 (exclusive) from a given vector?</p>
<p><strong>Exercise 19</strong>:</p>
<p>Notice how these two expressions look the same:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≢</span><span class="nv">vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4
</span></div></div>
</div>
<p>Can you tell if/how they are different?</p>
<p><strong>Exercise 20</strong>:</p>
<p>Compute the <em>Depth</em> (<code class="docutils literal notranslate"><span class="pre">≡</span></code>) of these arrays:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">42</span>
<span class="m">42</span> <span class="m">41</span> <span class="m">40</span> <span class="m">39</span>
<span class="m">2</span> <span class="m">2</span><span class="o">⍴</span><span class="m">42</span> <span class="m">41</span> <span class="m">40</span> <span class="m">39</span>
<span class="m">1</span> <span class="p">(</span><span class="m">2</span> <span class="m">3</span><span class="p">)</span> <span class="p">(</span><span class="m">4</span> <span class="m">5</span><span class="p">)</span>
<span class="p">(</span><span class="m">1</span> <span class="m">2</span><span class="p">)</span> <span class="p">(</span><span class="m">3</span> <span class="m">4</span> <span class="m">5</span><span class="p">)</span> <span class="p">(</span><span class="m">6</span> <span class="m">7</span> <span class="m">8</span> <span class="m">9</span><span class="p">)</span>
<span class="m">1</span> <span class="p">(</span><span class="m">2</span> <span class="p">(</span><span class="m">3</span> <span class="p">(</span><span class="m">4</span> <span class="p">(</span><span class="m">5</span> <span class="p">(</span><span class="m">6</span> <span class="m">7</span><span class="p">)))))</span>
<span class="p">(</span><span class="m">2</span> <span class="m">2</span><span class="o">⍴</span><span class="m">4</span><span class="p">)</span> <span class="p">(</span><span class="m">2</span> <span class="m">2</span><span class="o">⍴⍳</span><span class="m">47</span><span class="p">)</span> <span class="p">(</span><span class="m">3</span> <span class="m">6</span><span class="o">⍴⍳</span><span class="m">18</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Exercise 21</strong>:</p>
<p>In a vector, we would like to replace all the values that are smaller than 20 by 20, and replace all the values that are greater than 30 by 30. How can we do that?</p>
<p><strong>Exercise 22</strong>:</p>
<p>The following 6 expressions cannot be executed, but instead generate error messages; can you say why?</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span><span class="o">+</span><span class="p">(</span><span class="m">5</span><span class="o">-</span><span class="p">(</span><span class="m">6</span><span class="o">+</span><span class="m">2</span><span class="p">)</span><span class="o">×</span><span class="m">4</span>
<span class="m">121</span><span class="o">÷</span><span class="p">(</span><span class="o">⍳</span><span class="m">4</span><span class="p">)</span><span class="o">-</span><span class="m">3</span>
<span class="p">(</span><span class="m">¯</span><span class="nv">X</span><span class="o">+</span><span class="m">5</span><span class="p">)</span><span class="o">*</span><span class="m">2</span>
<span class="o">⍴</span><span class="m">4</span> <span class="m">5</span> <span class="m">6</span><span class="o">+</span><span class="m">2</span> <span class="m">3</span><span class="o">-</span><span class="m">1</span>
<span class="o">⍳</span><span class="m">3</span><span class="o">-</span><span class="m">5</span>
<span class="o">⍸</span><span class="m">1</span> <span class="m">0</span> <span class="m">2</span> <span class="m">¯1</span>
</pre></div>
</div>
<p><strong>Exercise 23</strong>:</p>
<p>Write an APL expression which produces a vector of 17 numbers, the first being 23, with each subsequent number being equal to the preceding one plus 11.</p>
<p><strong>Exercise 24</strong>:</p>
<p>In a shop, each product is identified by a code. You are given a list of the codes and the corresponding prices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">pcodes</span> <span class="kd">←</span> <span class="m">56</span> <span class="m">66</span> <span class="m">19</span> <span class="m">37</span> <span class="m">44</span> <span class="m">20</span> <span class="m">18</span> <span class="m">23</span> <span class="m">68</span> <span class="m">70</span> <span class="m">82</span>
<span class="nv">prices</span> <span class="kd">←</span>  <span class="m">9</span> <span class="m">27</span> <span class="m">10</span> <span class="m">15</span> <span class="m">12</span>  <span class="m">5</span>  <span class="m">8</span>  <span class="m">9</span> <span class="m">98</span>  <span class="m">7</span> <span class="m">22</span>
</pre></div>
</div>
</div>
</div>
<p>A customer gives you a list of items they intend to buy as vector of code/quantity pairs: code, quantity, code, quantity, and so on.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">wannaBuy</span> <span class="kd">←</span> <span class="m">37</span> <span class="m">1</span> <span class="m">70</span> <span class="m">20</span> <span class="m">19</span> <span class="m">2</span> <span class="m">82</span> <span class="m">5</span> <span class="m">23</span> <span class="m">10</span>
</pre></div>
</div>
</div>
</div>
<p>Can you evaluate their bill?</p>
<p>Note that this cannot be done easily in a single (and readable) APL expression, and you will therefore need to write several expressions.</p>
<p>The correct total should be 375.</p>
<p><strong>Exercise 25</strong>:</p>
<p>We have organised a lottery, and we have created five vectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕RL</span> <span class="kd">←</span> <span class="m">73</span>
<span class="nv">tickets</span> <span class="kd">←</span> <span class="o">?</span><span class="m">1000</span><span class="o">⍴</span><span class="m">999999</span>
<span class="nv">sold</span> <span class="kd">←</span> <span class="nv">tickets</span><span class="sr">[</span><span class="p">(</span><span class="m">800</span><span class="o">+?</span><span class="m">200</span><span class="p">)</span><span class="o">?</span><span class="m">1000</span><span class="sr">]</span>
<span class="nv">ours</span> <span class="kd">←</span> <span class="nv">sold</span><span class="sr">[</span><span class="p">(</span><span class="o">?</span><span class="m">200</span><span class="p">)</span><span class="o">?≢</span><span class="nv">sold</span><span class="sr">]</span>
<span class="nv">winners</span> <span class="kd">←</span> <span class="nv">tickets</span><span class="sr">[</span><span class="m">100</span><span class="o">?</span><span class="m">1000</span><span class="sr">]</span>
<span class="nv">prizes</span> <span class="kd">←</span> <span class="o">?</span><span class="m">100</span><span class="o">⍴</span><span class="m">1000</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tickets</span></code> has the numbers of all the existing tickets;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sold</span></code> has the numbers of the tickets which have been sold;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ours</span></code> has the numbers of the tickets we bought ourselves;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">winners</span></code> has the numbers of the winning tickets, and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prizes</span></code> has the prize amount associated with each respective number in <code class="docutils literal notranslate"><span class="pre">winners</span></code> vector.</p></li>
</ul>
<p>And now, try to answer the following 4 questions:</p>
<ol class="simple">
<li><p>What are the numbers of the unsold tickets?</p></li>
<li><p>Are there some winning tickets which have not been sold?</p></li>
<li><p>How many winning tickets do <strong>we</strong> have?</p></li>
<li><p>How much did we win?</p></li>
</ol>
<p><strong>Exercise 26</strong>:</p>
<p>Can you calculate all the divisors of a positive integer number <code class="docutils literal notranslate"><span class="pre">n</span></code>?</p>
<p>Here are some results to check your answer:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p></th>
<th class="text-align:left head"><p>Divisors</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>1</p></td>
<td class="text-align:left"><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>2</p></td>
<td class="text-align:left"><p>1 2</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>3</p></td>
<td class="text-align:left"><p>1 3</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>24</p></td>
<td class="text-align:left"><p>1 2 3 4 6 8 12 24</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>1337</p></td>
<td class="text-align:left"><p>1 7 191 1337</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>1234321</p></td>
<td class="text-align:left"><p>1 11 101 121 1111 10201 12221 112211 1234321</p></td>
</tr>
</tbody>
</table>
<p><strong>Solutions</strong>: the solutions can be found at the end of this chapter.</p>
</div>
<div class="section" id="the-specialist-s-section">
<span id="some-primitive-functions-the-specialists-section"></span><h2><span class="section-number">4.19. </span>The Specialist’s Section<a class="headerlink" href="#the-specialist-s-section" title="Permalink to this headline">¶</a></h2>
<br />
<center><i>Each chapter is followed by a "Specialist's Section" like this one. This section is dedicated to skilled APLers, who wish to improve their knowledge.</i>
<p>You will find here rare or complex usages of the concepts presented in this chapter, or discover extended explanations which need the knowledge of some symbols that will be seen much further in the book.</p>
<p><b>If you are exploring APL for the first time, skip this section and go to the next chapter.</b></center></p>
<div class="section" id="division-control-div-and-other-mathematical-subtleties">
<span id="some-primitive-functions-division-control-div-and-other-mathematical-subtleties"></span><h3><span class="section-number">4.19.1. </span>Division Control - ⎕DIV and Other Mathematical Subtleties<a class="headerlink" href="#division-control-div-and-other-mathematical-subtleties" title="Permalink to this headline">¶</a></h3>
<div class="section" id="zero-divided-by-zero">
<span id="some-primitive-functions-zero-divided-by-zero"></span><h4><span class="section-number">4.19.1.1. </span>Zero Divided by Zero<a class="headerlink" href="#zero-divided-by-zero" title="Permalink to this headline">¶</a></h4>
<p>In the beginning of this chapter we saw that <code class="docutils literal notranslate"><span class="pre">0÷0</span></code> returns 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span><span class="o">÷</span><span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>One might argue this is the case because any number divided by itself should give 1, like</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span><span class="o">÷</span><span class="m">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">¯0.56</span><span class="o">÷</span><span class="m">¯0.56</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1.2J0.6</span><span class="o">÷</span><span class="m">1.2J0.6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>But <code class="docutils literal notranslate"><span class="pre">0÷0</span></code> is indeterminate from a mathematical standpoint, meaning <code class="docutils literal notranslate"><span class="pre">0÷0</span></code> by itself has no correct value. What follows from this is that carefully crafted contexts can make <code class="docutils literal notranslate"><span class="pre">0÷0</span></code> evaluate to whatever you please.</p>
<p>Let us explore that possibility briefly but without much mathematical rigour. Let us define an APL function that behaves like the mathematical function <span class="math notranslate nohighlight">\(f(x) = 5x\)</span>, i.e. a function that takes a number and multiplies it by 5:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">F</span> <span class="kd">←</span> <span class="kt">{</span><span class="m">5</span><span class="o">×</span><span class="bp">⍵</span><span class="kt">}</span>
</pre></div>
</div>
</div>
</div>
<p>And let us evaluate it at a bunch of different values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">x</span> <span class="kd">←</span> <span class="m">¯1</span><span class="o">+</span><span class="m">15</span><span class="o">÷</span><span class="na">⍨</span><span class="o">⍳</span><span class="m">30</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯0.933333 ¯0.866667 ¯0.8 ¯0.733333 ¯0.666667 ¯0.6 ¯0.533333 ¯0.466667 ¯0.4 ¯0.333333 ¯0.266667 ¯0.2 ¯0.133333 ¯0.0666667 0

       0.0666667 0.133333 0.2 0.266667 0.333333 0.4 0.466667 0.533333 0.6 0.666667 0.733333 0.8 0.866667 0.933333 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">fx</span> <span class="kd">←</span> <span class="nv">F</span> <span class="nv">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯4.66667 ¯4.33333 ¯4 ¯3.66667 ¯3.33333 ¯3 ¯2.66667 ¯2.33333 ¯2 ¯1.66667 ¯1.33333 ¯1 ¯0.666667 ¯0.333333 0 0.333333 0.66666

      7 1 1.33333 1.66667 2 2.33333 2.66667 3 3.33333 3.66667 4 4.33333 4.66667 5
</span></div></div>
</div>
<p>And now let us study the ratio <span class="math notranslate nohighlight">\(f(x)/x\)</span> for those several values of <code class="docutils literal notranslate"><span class="pre">x</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">fx</span><span class="o">÷</span><span class="nv">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 5 5 5 5 5 5 5 5 5 5 5 5 5 1 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5
</span></div></div>
</div>
<p>If you look closely, the vector above has plenty of 5s and then a single 1 in the middle, corresponding to the <code class="docutils literal notranslate"><span class="pre">0÷0</span></code> division.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">5</span><span class="o">≠</span><span class="nv">fx</span><span class="o">÷</span><span class="nv">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
</span></div></div>
</div>
<p>Let us try to create values of <code class="docutils literal notranslate"><span class="pre">x</span></code> that are tighter around 0 and perform the same division.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">x</span> <span class="kd">←</span> <span class="m">¯0.1</span><span class="o">+</span><span class="m">100</span><span class="o">÷</span><span class="na">⍨</span><span class="o">⍳</span><span class="m">20</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯0.09 ¯0.08 ¯0.07 ¯0.06 ¯0.05 ¯0.04 ¯0.03 ¯0.02 ¯0.01 0 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">fx</span> <span class="kd">←</span> <span class="nv">F</span> <span class="nv">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯0.45 ¯0.4 ¯0.35 ¯0.3 ¯0.25 ¯0.2 ¯0.15 ¯0.1 ¯0.05 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">fx</span><span class="o">÷</span><span class="nv">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 5 5 5 5 5 5 5 5 1 5 5 5 5 5 5 5 5 5 5
</span></div></div>
</div>
<p>No matter how close to 0 we are, these ratios are always going to be returning 5. Because our function <span class="math notranslate nohighlight">\(f(x)\)</span> is well-behaved, in this context <code class="docutils literal notranslate"><span class="pre">0÷0</span></code> should return 5. Of course having to factor this in is an inconvenience for programming languages and most of them either</p>
<ul class="simple">
<li><p>raise an error when one tries to divide zero by zero;</p></li>
<li><p>return a previously-agreed-upon value (which is usually 0 or 1).</p></li>
</ul>
<p><strong>By default</strong>, Dyalog APL returns 1 when we compute <code class="docutils literal notranslate"><span class="pre">0÷0</span></code> as you saw above. This may sometimes be inappropriate. Suppose that we want to calculate the sales growth for 5 products, but the production of the 3rd product has not started yet, so its sales are currently zero:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">before</span> <span class="kd">←</span> <span class="m">20</span> <span class="m">31</span> <span class="m">0</span> <span class="m">120</span> <span class="m">63</span>
<span class="nv">after</span> <span class="kd">←</span> <span class="m">22</span> <span class="m">27</span> <span class="m">0</span> <span class="m">149</span> <span class="m">59</span>
</pre></div>
</div>
</div>
</div>
<p>The growth (in percent rounded) can be calculated like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⌊</span><span class="m">0.5</span><span class="o">+</span><span class="m">100</span><span class="o">×</span> <span class="p">(</span><span class="nv">after</span><span class="o">-</span><span class="nv">before</span><span class="p">)</span><span class="o">÷</span><span class="nv">before</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">10 ¯13 100 24 ¯6
</span></div></div>
</div>
<p>It is rather surprising to see that we’ve got a 100% growth on a product that does not exist!</p>
<p>To help circumvent this sort of issues, a so-called <em>System variable</em> named <code class="docutils literal notranslate"><span class="pre">⎕DIV</span></code> is included in Dyalog APL to change the behaviour of division by zero.</p>
<p><strong>Be default</strong>, <code class="docutils literal notranslate"><span class="pre">⎕DIV</span></code> is 0, but can also be set to 1.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p><code class="docutils literal notranslate"><span class="pre">⎕DIV</span></code></p></th>
<th class="text-align:left head"><p>Behaviour</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>0</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">0÷0</span></code> gives 1</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p></p></td>
<td class="text-align:left"><p>Any other number divided by 0 gives a <code class="docutils literal notranslate"><span class="pre">DOMAIN</span> <span class="pre">ERROR</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>1</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">0÷0</span></code> gives 0</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p></p></td>
<td class="text-align:left"><p>Any other number divided by 0 gives 0</p></td>
</tr>
</tbody>
</table>
<p>To change the value of the <em>System variable</em> <code class="docutils literal notranslate"><span class="pre">⎕DIV</span></code> you just assign to it as you would any other variable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕DIV</span> <span class="kd">←</span> <span class="m">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span><span class="o">÷</span><span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">5</span><span class="o">÷</span><span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕DIV</span> <span class="kd">←</span> <span class="m">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span><span class="o">÷</span><span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">5</span><span class="o">÷</span><span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DOMAIN ERROR: Divide by zero
      5÷0
       ∧
</pre></div>
</div>
</div>
</div>
<p>Because <code class="docutils literal notranslate"><span class="pre">⎕DIV</span></code> is a variable, it can be localised in the header of a function. Then the particular behaviour of division remains specific to that function and its sub functions.</p>
<p>Trying to change <code class="docutils literal notranslate"><span class="pre">⎕DIV</span></code> to a value other than 0 or 1 also gives a <code class="docutils literal notranslate"><span class="pre">DOMAIN</span> <span class="pre">ERROR</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕DIV</span> <span class="kd">←</span> <span class="m">4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DOMAIN ERROR
      ⎕DIV←4
          ∧
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="zero-to-the-power-of-zero">
<span id="some-primitive-functions-zero-to-the-power-of-zero"></span><h4><span class="section-number">4.19.1.2. </span>Zero To The Power of Zero<a class="headerlink" href="#zero-to-the-power-of-zero" title="Permalink to this headline">¶</a></h4>
<p>We also saw that <code class="docutils literal notranslate"><span class="pre">0*0</span></code> returns 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span><span class="o">*</span><span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>This is yet another convention that is in place just to make life easier for programmers, as <code class="docutils literal notranslate"><span class="pre">0*0</span></code> is indeterminate from a mathematical standpoint, similar to <code class="docutils literal notranslate"><span class="pre">0÷0</span></code>.</p>
<p>But please, do not take my word for it! Notice that any number to the power of 0 gives 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">¯3</span> <span class="m">4J5</span> <span class="m">1.2</span> <span class="p">(</span><span class="o">○</span><span class="m">1</span><span class="p">)</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="o">*</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 1 1 1 1 1 1
</span></div></div>
</div>
<p>Notice how 0 to the power of any positive number gives 0:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">4J5</span> <span class="m">1.2</span> <span class="p">(</span><span class="o">○</span><span class="m">1</span><span class="p">)</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="o">*</span><span class="na">⍨</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 0 0 0
</span></div></div>
</div>
<p>So how do we settle this for <code class="docutils literal notranslate"><span class="pre">0*0</span></code>? If we look at it from the “a number to the power of 0” perspective, it should give 1. If we look at it from the “zero to the power of a number”, it should give 0. So Dyalog APL just chose to go with the <code class="docutils literal notranslate"><span class="pre">1=0*0</span></code> convention, which is a fairly common one.</p>
</div>
</div>
<div class="section" id="derived-functions">
<span id="some-primitive-functions-derived-functions"></span><h3><span class="section-number">4.19.2. </span>Derived Functions<a class="headerlink" href="#derived-functions" title="Permalink to this headline">¶</a></h3>
<p>Let us sum the items of a vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span> <span class="nv">contents</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">672
</span></div></div>
</div>
<p>In this expression, <em>Reduce</em> takes <em>Plus</em> as its operand.</p>
<p>This pair of symbols creates a new function, a so-called “<em><strong>Derived Function</strong></em>”. The derived function is monadic in this case, and it takes the variable <code class="docutils literal notranslate"><span class="pre">contents</span></code> as its argument.</p>
<p><code class="docutils literal notranslate"><span class="pre">contents</span></code> is not the right argument of <code class="docutils literal notranslate"><span class="pre">/</span></code>, it is the argument of the derived function <code class="docutils literal notranslate"><span class="pre">+/</span></code>.</p>
<p>This is so true that <code class="docutils literal notranslate"><span class="pre">+/</span></code> could be parenthesised:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">+</span><span class="na">/</span><span class="p">)</span> <span class="nv">contents</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">672
</span></div></div>
</div>
<p>It can also be given a name:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">sum</span> <span class="kd">←</span> <span class="o">+</span><span class="na">/</span>
<span class="nv">sum</span> <span class="m">10</span> <span class="m">20</span> <span class="m">30</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">60
</span></div></div>
</div>
<p>All operators create <em>derived functions</em>, i.e. functions that are derived from the function(s) the operators accept as operand(s).</p>
</div>
<div class="section" id="nor-nand">
<span id="some-primitive-functions-nor-nand"></span><h3><span class="section-number">4.19.3. </span>Nor &amp; Nand<a class="headerlink" href="#nor-nand" title="Permalink to this headline">¶</a></h3>
<p>APL boolean algebra also includes two useful functions:</p>
<ul class="simple">
<li><p><em><strong>Nor</strong></em> (stands for Not-Or), represented in APL by <code class="docutils literal notranslate"><span class="pre">⍱</span></code>. You can type it with <kbd>APL</kbd>+<kbd>Shift</kbd>+<kbd>9</kbd>, which is “above” <code class="docutils literal notranslate"><span class="pre">∨</span></code>;</p></li>
<li><p><em><strong>Nand</strong></em> (stands for Not-and), represented in APL by <code class="docutils literal notranslate"><span class="pre">⍲</span></code>. You can type it with <kbd>APL</kbd>+<kbd>Shift</kbd>+<kbd>0</kbd>, which is “above” <code class="docutils literal notranslate"><span class="pre">∧</span></code>.</p></li>
</ul>
<p>The <em><strong>Nor</strong></em> and <em><strong>Nand</strong></em> functions give the negation of <em><strong>Or</strong></em> and <em><strong>And</strong></em> respectively, and that is why their symbols are respectively <code class="docutils literal notranslate"><span class="pre">∨</span></code> and <code class="docutils literal notranslate"><span class="pre">∧</span></code> with a <code class="docutils literal notranslate"><span class="pre">~</span></code> on top.</p>
<p>This means that</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a⍱b</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">~a∨b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a⍲b</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">~a∧b</span></code></p></li>
</ul>
<p>as shown below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">a</span> <span class="kd">←</span> <span class="m">0</span> <span class="m">0</span> <span class="m">1</span> <span class="m">1</span>
<span class="nv">b</span> <span class="kd">←</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span> <span class="m">4</span><span class="o">⍴</span> <span class="p">(</span><span class="nv">a</span><span class="o">∨</span><span class="nv">b</span><span class="p">)</span><span class="o">,</span><span class="p">(</span><span class="nv">a</span><span class="o">⍱</span><span class="nv">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 1 1
1 0 0 0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span> <span class="m">4</span><span class="o">⍴</span> <span class="p">(</span><span class="nv">a</span><span class="o">∧</span><span class="nv">b</span><span class="p">)</span><span class="o">,</span><span class="p">(</span><span class="nv">a</span><span class="o">⍲</span><span class="nv">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 1
1 1 1 0
</span></div></div>
</div>
<div class="warning admonition">
<p class="admonition-title">Warning</p>
<p>both <code class="docutils literal notranslate"><span class="pre">∨</span></code> and <code class="docutils literal notranslate"><span class="pre">∧</span></code> are associative, but <code class="docutils literal notranslate"><span class="pre">⍱</span></code> and <code class="docutils literal notranslate"><span class="pre">⍲</span></code> are not!</p>
</div>
<p>This means that <code class="docutils literal notranslate"><span class="pre">(a∨b)∨c</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">a∨(b∨c)</span></code> and thus can be written <code class="docutils literal notranslate"><span class="pre">a∨b∨c</span></code>. Similarly for <code class="docutils literal notranslate"><span class="pre">∧</span></code>. but for <em>Nor</em> and <em>Nand</em> this is not the case:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">a</span><span class="o">⍱</span><span class="p">(</span><span class="nv">a</span><span class="o">⍱</span><span class="nv">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 0 0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">a</span><span class="o">⍱</span><span class="nv">a</span><span class="p">)</span><span class="o">⍱</span><span class="nv">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 1 0
</span></div></div>
</div>
<p>Changing the order of evaluation changes the result, so <code class="docutils literal notranslate"><span class="pre">⍱</span></code> is not associative. Same goes for <code class="docutils literal notranslate"><span class="pre">⍲</span></code>.</p>
<p>another consequence is that if <code class="docutils literal notranslate"><span class="pre">bin</span></code> has more than 2 items, <code class="docutils literal notranslate"><span class="pre">⍱/bin</span></code> is <strong>not</strong> equivalent to <code class="docutils literal notranslate"><span class="pre">~∨/bin</span></code>, and similarly for <code class="docutils literal notranslate"><span class="pre">∧</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍱</span><span class="na">/</span><span class="nv">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">~∨</span><span class="na">/</span><span class="nv">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<p>This is probably the reason why those two primitives are rarely used in common business applications, although they are extremely useful in electronic automation, because they represent basic logical circuits.</p>
</div>
<div class="section" id="index-generator-of-arrays">
<span id="some-primitive-functions-index-generator-of-arrays"></span><h3><span class="section-number">4.19.4. </span>Index Generator of Arrays<a class="headerlink" href="#index-generator-of-arrays" title="Permalink to this headline">¶</a></h3>
<p>We have given a limited definition of the <em>Index Generator</em>, here is a more general presentation:</p>
<div class="tip admonition">
<p class="admonition-title">Rule</p>
<p>In the expression <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">←</span> <span class="pre">⍳dim</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dim</span></code> represents the shape of an array (the array itself need not actually exist)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r</span></code> is the set of indices pointing to all items of that array</p></li>
</ul>
<p>The shape of <code class="docutils literal notranslate"><span class="pre">r</span></code> is given by <code class="docutils literal notranslate"><span class="pre">dim</span></code> and each item of <code class="docutils literal notranslate"><span class="pre">r</span></code> is the index (or the set of indices) of its own items.</p>
</div>
<p>Some examples should make this easier to understand. Let us take several arrays and inspect their shape:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">contents</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍳⍴</span><span class="nv">contents</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3 4 5 6 7 8 9 10 11 12
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">contents</span><span class="sr">[</span><span class="o">⍳⍴</span><span class="nv">contents</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12 56 78 74 85 96 30 22 44 66 82 27
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">monMat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6 8
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍳⍴</span><span class="nv">monMat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───┬───┬───┬───┬───┬───┬───┬───┐
│1 1│1 2│1 3│1 4│1 5│1 6│1 7│1 8│
├───┼───┼───┼───┼───┼───┼───┼───┤
│2 1│2 2│2 3│2 4│2 5│2 6│2 7│2 8│
├───┼───┼───┼───┼───┼───┼───┼───┤
│3 1│3 2│3 3│3 4│3 5│3 6│3 7│3 8│
├───┼───┼───┼───┼───┼───┼───┼───┤
│4 1│4 2│4 3│4 4│4 5│4 6│4 7│4 8│
├───┼───┼───┼───┼───┼───┼───┼───┤
│5 1│5 2│5 3│5 4│5 5│5 6│5 7│5 8│
├───┼───┼───┼───┼───┼───┼───┼───┤
│6 1│6 2│6 3│6 4│6 5│6 6│6 7│6 8│
└───┴───┴───┴───┴───┴───┴───┴───┘
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">monMat</span><span class="sr">[</span><span class="o">⍳⍴</span><span class="nv">monMat</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">January 
February
March   
April   
May     
June    
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 2 12
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍳⍴</span><span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬──────┬──────┬──────┐
│1 1 1│1 1 2│1 1 3│1 1 4│1 1 5│1 1 6│1 1 7│1 1 8│1 1 9│1 1 10│1 1 11│1 1 12│
├─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼──────┼──────┼──────┤
│1 2 1│1 2 2│1 2 3│1 2 4│1 2 5│1 2 6│1 2 7│1 2 8│1 2 9│1 2 10│1 2 11│1 2 12│
└─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴──────┴──────┴──────┘
┌─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬──────┬──────┬──────┐
│2 1 1│2 1 2│2 1 3│2 1 4│2 1 5│2 1 6│2 1 7│2 1 8│2 1 9│2 1 10│2 1 11│2 1 12│
├─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼──────┼──────┼──────┤
│2 2 1│2 2 2│2 2 3│2 2 4│2 2 5│2 2 6│2 2 7│2 2 8│2 2 9│2 2 10│2 2 11│2 2 12│
└─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴──────┴──────┴──────┘
┌─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬──────┬──────┬──────┐
│3 1 1│3 1 2│3 1 3│3 1 4│3 1 5│3 1 6│3 1 7│3 1 8│3 1 9│3 1 10│3 1 11│3 1 12│
├─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼──────┼──────┼──────┤
│3 2 1│3 2 2│3 2 3│3 2 4│3 2 5│3 2 6│3 2 7│3 2 8│3 2 9│3 2 10│3 2 11│3 2 12│
└─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴──────┴──────┴──────┘
┌─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬──────┬──────┬──────┐
│4 1 1│4 1 2│4 1 3│4 1 4│4 1 5│4 1 6│4 1 7│4 1 8│4 1 9│4 1 10│4 1 11│4 1 12│
├─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼──────┼──────┼──────┤
│4 2 1│4 2 2│4 2 3│4 2 4│4 2 5│4 2 6│4 2 7│4 2 8│4 2 9│4 2 10│4 2 11│4 2 12│
└─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴──────┴──────┴──────┘
┌─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬──────┬──────┬──────┐
│5 1 1│5 1 2│5 1 3│5 1 4│5 1 5│5 1 6│5 1 7│5 1 8│5 1 9│5 1 10│5 1 11│5 1 12│
├─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼──────┼──────┼──────┤
│5 2 1│5 2 2│5 2 3│5 2 4│5 2 5│5 2 6│5 2 7│5 2 8│5 2 9│5 2 10│5 2 11│5 2 12│
└─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴──────┴──────┴──────┘
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">prod</span><span class="sr">[</span><span class="o">⍳⍴</span><span class="nv">prod</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 9 16 42 50  2  3 11 45 17 37 29 36
34 19 32 12 37 15 46 24 49 28 36  9

29  5 45 23 27  4 23 16 39 22 22  2
46 20 47 17 18 25 13 38 42 38 45 28

37 19  5 10 30 49 16 18 46 47 47  3
39 23 41 20  6 40 21 22 40 49 20  1

13 36 12 40 12 15 24 20 21 12 19 25
 8 48 22 37 33  1 39 30 50 50  8 35

38 31 24 40 23  7 20 34 35  6 19 27
41  1 14 50 17 42  6 35 12 48 30 29
</span></div></div>
</div>
<p>We can see that, more generally, an array is identical to itself indexed by <em>Iota</em> of its shape: <code class="docutils literal notranslate"><span class="pre">data≡data[⍳⍴data]</span></code></p>
</div>
<div class="section" id="ravel-with-axis">
<span id="some-primitive-functions-ravel-with-axis"></span><h3><span class="section-number">4.19.5. </span>Ravel With Axis<a class="headerlink" href="#ravel-with-axis" title="Permalink to this headline">¶</a></h3>
<p><em>Ravel</em> can be used with an <em>Axis specifier</em>, using the notation <code class="docutils literal notranslate"><span class="pre">r←,[axis]</span> <span class="pre">data</span></code>.</p>
<p>In this expression, <code class="docutils literal notranslate"><span class="pre">axis</span></code> can be:</p>
<ul class="simple">
<li><p>an empty vector</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">,</span><span class="sr">[</span><span class="no">⍬</span><span class="sr">]</span> <span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">H
2
S
O
4

C
a
C
O
3

F
e
2
O
3
</span></div></div>
</div>
<ul class="simple">
<li><p>a decimal scalar, adjacent to an axis of <code class="docutils literal notranslate"><span class="pre">data</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">,</span><span class="sr">[</span><span class="m">0.5</span><span class="sr">]</span> <span class="nv">contents</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12 56 78 74 85 96 30 22 44 66 82 27
</span></div></div>
</div>
<ul class="simple">
<li><p>a subset of the axes of <code class="docutils literal notranslate"><span class="pre">data</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">,</span><span class="sr">[</span><span class="m">2</span> <span class="m">3</span><span class="sr">]</span> <span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 9 16 42 50  2  3 11 45 17 37 29 36 34 19 32 12 37 15 46 24 49 28 36  9
29  5 45 23 27  4 23 16 39 22 22  2 46 20 47 17 18 25 13 38 42 38 45 28
37 19  5 10 30 49 16 18 46 47 47  3 39 23 41 20  6 40 21 22 40 49 20  1
13 36 12 40 12 15 24 20 21 12 19 25  8 48 22 37 33  1 39 30 50 50  8 35
38 31 24 40 23  7 20 34 35  6 19 27 41  1 14 50 17 42  6 35 12 48 30 29
</span></div></div>
</div>
<div class="section" id="empty-axis">
<span id="some-primitive-functions-empty-axis"></span><h4><span class="section-number">4.19.5.1. </span>Empty Axis<a class="headerlink" href="#empty-axis" title="Permalink to this headline">¶</a></h4>
<p>If <code class="docutils literal notranslate"><span class="pre">axis</span></code> is empty, the result is obtained by appending a new dimension of size 1 to the list of <code class="docutils literal notranslate"><span class="pre">data</span></code>’s dimensions.</p>
<p>It means that:</p>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">⍴data</span></code> is 12, then <code class="docutils literal notranslate"><span class="pre">⍴,[⍬]</span> <span class="pre">data</span></code> will be 12 1</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">contents</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12 56 78 74 85 96 30 22 44 66 82 27
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">contents</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">,</span><span class="sr">[</span><span class="no">⍬</span><span class="sr">]</span> <span class="nv">contents</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12
56
78
74
85
96
30
22
44
66
82
27
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴,</span><span class="sr">[</span><span class="no">⍬</span><span class="sr">]</span> <span class="nv">contents</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12 1
</span></div></div>
</div>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">⍴data</span></code> is 3 5, then <code class="docutils literal notranslate"><span class="pre">⍴,[⍬]</span></code> will be 3 5</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">H2SO4
CaCO3
Fe2O3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 5
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">,</span><span class="sr">[</span><span class="no">⍬</span><span class="sr">]</span> <span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">H
2
S
O
4

C
a
C
O
3

F
e
2
O
3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴,</span><span class="sr">[</span><span class="no">⍬</span><span class="sr">]</span> <span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 5 1
</span></div></div>
</div>
</div>
</div>
<div class="section" id="fractional-axis">
<span id="some-primitive-functions-fractional-axis"></span><h3><span class="section-number">4.19.6. </span>Fractional Axis<a class="headerlink" href="#fractional-axis" title="Permalink to this headline">¶</a></h3>
<p>If <code class="docutils literal notranslate"><span class="pre">axis</span></code> is a fractional value, it is mandatory that it is “adjacent” to an existing dimension of <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p>
<p>This means that for an array of rank 3, the axis must be a value between 0 and 4 (exclusive).</p>
<p>The result is derived from <code class="docutils literal notranslate"><span class="pre">data</span></code> by inserting a new dimension of size 1 in the list of <code class="docutils literal notranslate"><span class="pre">data</span></code>’s dimensions. The new dimension is inserted according to the value of <code class="docutils literal notranslate"><span class="pre">axis</span></code>.</p>
<p>It means that if</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 2 12
</span></div></div>
</div>
<p>then:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴,</span><span class="sr">[</span><span class="m">0.5</span><span class="sr">]</span> <span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 5 2 12
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴,</span><span class="sr">[</span><span class="m">1.5</span><span class="sr">]</span> <span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 1 2 12
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴,</span><span class="sr">[</span><span class="m">2.5</span><span class="sr">]</span> <span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 2 1 12
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴,</span><span class="sr">[</span><span class="m">3.5</span><span class="sr">]</span> <span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 2 12 1
</span></div></div>
</div>
<p>These conventions are totally consistent with those defined for some other functions like <em>Laminate</em> or <em>Mix</em>.</p>
<p>An example with a smaller array is also presented:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;PUB&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">PUB
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="s1">&#39;PUB&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">,</span><span class="sr">[</span><span class="m">1.5</span><span class="sr">]</span> <span class="s1">&#39;PUB&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">P
U
B
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">,</span><span class="sr">[</span><span class="m">0.5</span><span class="sr">]</span> <span class="s1">&#39;PUB&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">PUB
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴,</span><span class="sr">[</span><span class="m">0.5</span><span class="sr">]</span> <span class="s1">&#39;PUB&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 3
</span></div></div>
</div>
<p>Notice how the result of <code class="docutils literal notranslate"><span class="pre">,[0.5]</span> <span class="pre">'PUB'</span></code> looks like that of <code class="docutils literal notranslate"><span class="pre">'PUB'</span></code>, but while the latter is a vector of length 3, the former is a matrix with 1 row and 3 columns.</p>
<p>The actual value of the axis specification is not used for anything other than determining where to insert the new dimension. This means that, for example, all expressions of the form <code class="docutils literal notranslate"><span class="pre">,[1.xxx]</span></code> will have the same effect as the <code class="docutils literal notranslate"><span class="pre">,[1.5]</span></code> that we used above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">,</span><span class="sr">[</span><span class="m">1.5</span><span class="sr">]</span> <span class="s1">&#39;PUB&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">P
U
B
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">,</span><span class="sr">[</span><span class="m">1.0123</span><span class="sr">]</span> <span class="s1">&#39;PUB&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">P
U
B
</span></div></div>
</div>
</div>
<div class="section" id="a-list-of-dimensions">
<span id="some-primitive-functions-a-list-of-dimensions"></span><h3><span class="section-number">4.19.7. </span>A List of Dimensions<a class="headerlink" href="#a-list-of-dimensions" title="Permalink to this headline">¶</a></h3>
<p>If <code class="docutils literal notranslate"><span class="pre">axis</span></code> is a subset of the axes of <code class="docutils literal notranslate"><span class="pre">data</span></code>, it is mandatory that they are contiguous and in ascending order. It means that for an array of rank 3, the list of axes can be <code class="docutils literal notranslate"><span class="pre">[1</span> <span class="pre">2]</span></code>, <code class="docutils literal notranslate"><span class="pre">[2</span> <span class="pre">3]</span></code> or <code class="docutils literal notranslate"><span class="pre">[1</span> <span class="pre">2</span> <span class="pre">3]</span></code>, but neither <code class="docutils literal notranslate"><span class="pre">[1</span> <span class="pre">3]</span></code> nor <code class="docutils literal notranslate"><span class="pre">[3</span> <span class="pre">2]</span></code>, for example.</p>
<p>The result is obtained by unravelling <code class="docutils literal notranslate"><span class="pre">data</span></code> so that the dimensions mentioned in <code class="docutils literal notranslate"><span class="pre">axis</span></code> are merged into a single dimension.</p>
<p>For example, imagine that <code class="docutils literal notranslate"><span class="pre">data</span></code> is an array of shape <code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">2</span> <span class="pre">4</span> <span class="pre">7</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">data</span> <span class="kd">←</span> <span class="m">5</span> <span class="m">2</span> <span class="m">4</span> <span class="m">7</span><span class="o">⍴</span><span class="m">0</span>
</pre></div>
</div>
</div>
</div>
<p>We investigate the shapes of different ravels with lists of dimensions as axis specification:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴,</span><span class="sr">[</span><span class="m">1</span> <span class="m">2</span><span class="sr">]</span> <span class="nv">data</span>        <span class="c1">⍝ 10 is 5×2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">10 4 7
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴,</span><span class="sr">[</span><span class="m">2</span> <span class="m">3</span><span class="sr">]</span> <span class="nv">data</span>        <span class="c1">⍝ 8 is 2×4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 8 7
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴,</span><span class="sr">[</span><span class="m">3</span> <span class="m">4</span><span class="sr">]</span> <span class="nv">data</span>        <span class="c1">⍝ 28 is 4×7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 2 28
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴,</span><span class="sr">[</span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span><span class="sr">]</span> <span class="nv">data</span>      <span class="c1">⍝ 40 is 5×2×4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">40 7
</span></div></div>
</div>
</div>
<div class="section" id="border-cases">
<span id="some-primitive-functions-border-cases"></span><h3><span class="section-number">4.19.8. </span>Border Cases<a class="headerlink" href="#border-cases" title="Permalink to this headline">¶</a></h3>
<p>If <code class="docutils literal notranslate"><span class="pre">axis</span></code> is reduced to a single value, the operation returns <code class="docutils literal notranslate"><span class="pre">data</span></code> unchanged:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">H2SO4
CaCO3
Fe2O3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">,</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span> <span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">H2SO4
CaCO3
Fe2O3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">,</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span> <span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">H2SO4
CaCO3
Fe2O3
</span></div></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">axis</span></code> contains the whole set of the axes of <code class="docutils literal notranslate"><span class="pre">data</span></code>, the operation is equivalent to a simple <em>Ravel</em> with no axis specification, and gives a vector of the items of <code class="docutils literal notranslate"><span class="pre">data</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">,</span><span class="sr">[</span><span class="m">1</span> <span class="m">2</span><span class="sr">]</span> <span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">H2SO4CaCO3Fe2O3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">,</span><span class="nv">chemistry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">H2SO4CaCO3Fe2O3
</span></div></div>
</div>
<p>For these reasons, <em>Ravel with axes</em> can only “collapse” dimensions of arrays of rank 2 or more.</p>
</div>
</div>
<div class="section" id="solutions">
<span id="some-primitive-functions-solutions"></span><h2><span class="section-number">4.20. </span>Solutions<a class="headerlink" href="#solutions" title="Permalink to this headline">¶</a></h2>
<p>The solutions we propose in the following pages are not necessarily the “best” ones; perhaps you will find other solutions that we have never considered. APL is a very rich language, and due to the general nature of its primitive functions and operators there are always plenty of different ways to express different solutions to a given problem. Which one is “the best” depends on many things, for example the level of experience of the programmer, the importance of system performance, the required behaviour in border cases, the requirement to meet certain programming standards and also personal preferences. This is one of the reasons why APL is so pleasant to teach and to learn!</p>
<p>We advise you to try and solve the exercises before reading the solutions!</p>
<p><strong>Exercise 1</strong>:</p>
<p>Copy each expression to the APL session and execute them. If you are surprised by an answer, analyse the expression step by step, starting from the right. For example, for the first expression:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span> <span class="o">×</span> <span class="m">2</span> <span class="o">+</span> <span class="m">6</span> <span class="o">≠</span> <span class="m">3</span> <span class="o">×</span> <span class="m">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span> <span class="o">×</span> <span class="m">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">6</span> <span class="o">≠</span> <span class="m">6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span> <span class="o">+</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span> <span class="o">×</span> <span class="m">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">12</span> <span class="m">6</span> <span class="m">27</span> <span class="o">⌊</span> <span class="m">11</span> <span class="o">+</span> <span class="o">⍳</span><span class="m">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">12 6 14
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">4</span> <span class="m">5</span> <span class="m">6</span> <span class="o">⌈</span> <span class="m">4</span> <span class="o">+</span> <span class="m">2</span> <span class="m">5</span> <span class="m">9</span> <span class="o">&gt;</span> <span class="m">1</span> <span class="m">6</span> <span class="m">8</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 5 6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">7</span> <span class="o">⌊</span> <span class="m">25</span> <span class="m">6</span> <span class="m">17</span> <span class="o">-</span> <span class="p">(</span><span class="m">2</span> <span class="o">×</span> <span class="m">3</span><span class="p">)</span> <span class="o">+</span> <span class="m">9</span> <span class="m">3</span> <span class="m">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">7 ¯3 6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="m">8</span> <span class="o">+</span> <span class="m">6</span><span class="p">)</span> <span class="o">×</span> <span class="m">2</span> <span class="o">+</span> <span class="m">1</span><span class="p">)</span> <span class="o">×</span> <span class="m">3</span> <span class="o">-</span> <span class="m">6</span> <span class="o">÷</span> <span class="m">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">42
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">⍴</span><span class="m">4</span><span class="o">⌈</span><span class="m">5</span><span class="p">)</span> <span class="o">+</span> <span class="m">4</span><span class="o">⌈</span><span class="m">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="o">⊢</span> <span class="m">2</span> <span class="o">⊣</span> <span class="m">3</span> <span class="o">⊢</span> <span class="m">4</span> <span class="o">⊣</span> <span class="m">5</span> <span class="o">⊢</span> <span class="m">6</span> <span class="o">⊣</span> <span class="m">7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="o">⊣</span> <span class="m">2</span> <span class="o">⊢</span> <span class="m">3</span> <span class="o">⊣</span> <span class="m">4</span> <span class="o">⊢</span> <span class="m">5</span> <span class="o">⊣</span> <span class="m">6</span> <span class="o">⊢</span> <span class="m">7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="o">⊢</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4 5 6
</span></div></div>
</div>
<p><strong>Exercise 2</strong>:</p>
<p><code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">2+2</span> <span class="pre">2</span></code> is the addition of two vectors of size 2:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span> <span class="m">2</span><span class="o">+</span><span class="m">2</span> <span class="m">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4 4
</span></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">2+2</span> <span class="pre">2+2</span></code> is the addition of <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">2</span></code> with <code class="docutils literal notranslate"><span class="pre">2</span></code>, and then with <code class="docutils literal notranslate"><span class="pre">2</span></code> again:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span><span class="o">+</span><span class="m">2</span> <span class="m">2</span><span class="o">+</span><span class="m">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6 6
</span></div></div>
</div>
<p>Finally, although <code class="docutils literal notranslate"><span class="pre">2,2</span></code> gives the same array as writing <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">2</span></code> out, the fact that we are catenating means we have to evaluate the catenation also from right to left, making it happen after some of the additions have already been computed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span><span class="o">+</span><span class="m">2</span><span class="o">,</span><span class="m">2</span><span class="o">+</span><span class="m">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4 6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span><span class="o">,</span><span class="m">2</span><span class="o">+</span><span class="m">2</span><span class="o">,</span><span class="m">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 4 4
</span></div></div>
</div>
<p><strong>Exercise 3</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">a</span> <span class="kd">←</span> <span class="m">8</span> <span class="m">2</span> <span class="m">7</span> <span class="m">5</span>
</pre></div>
</div>
</div>
</div>
<p>Comparing <code class="docutils literal notranslate"><span class="pre">1+⍴a</span></code> and <code class="docutils literal notranslate"><span class="pre">⍴a+1</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="o">+⍴</span><span class="nv">a</span>        <span class="c1">⍝ find the shape of `a` and then add 1 to that</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">a</span><span class="o">+</span><span class="m">1</span>        <span class="c1">⍝ add 1 to all items of `a` and then find the shape of that</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4
</span></div></div>
</div>
<p>And now on to <code class="docutils literal notranslate"><span class="pre">1+⍳⍴a</span></code>, <code class="docutils literal notranslate"><span class="pre">⍳¯1+⍴a</span></code> and <code class="docutils literal notranslate"><span class="pre">⍳⍴a-1</span></code>. The easiest way to understand these expressions is to figure out the order in which things are happening and inspecting the intermediate steps.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="o">+⍳⍴</span><span class="nv">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 3 4 5
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍳</span><span class="m">¯1</span><span class="o">+⍴</span><span class="nv">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍳⍴</span><span class="nv">a</span><span class="o">-</span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3 4
</span></div></div>
</div>
<p><strong>Exercise 4</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">((⍳4)-1)⌈3</span></code></p></li>
</ul>
<p>To remove parenthesis, what you do is locate the outermost pair of parenthesis (which is <code class="docutils literal notranslate"><span class="pre">((⍳4)-1)</span></code>), determine the function to which this pair of parenthesis is an argument (the <code class="docutils literal notranslate"><span class="pre">⌈</span></code>) and find the other argument to the same function (which is <code class="docutils literal notranslate"><span class="pre">3</span></code>).</p>
<p>Then you check if you can swap the two arguments and, if so, remove the outermost pair of parenthesis:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="o">⍳</span><span class="m">4</span><span class="p">)</span><span class="o">-</span><span class="m">1</span><span class="p">)</span> <span class="o">⌈</span> <span class="m">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 3 3 3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span> <span class="o">⌈</span> <span class="p">((</span><span class="o">⍳</span><span class="m">4</span><span class="p">)</span><span class="o">-</span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 3 3 3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span> <span class="o">⌈</span> <span class="p">(</span><span class="o">⍳</span><span class="m">4</span><span class="p">)</span> <span class="o">-</span> <span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 3 3 3
</span></div></div>
</div>
<p>Now if you wish to remove the parenthesis from <code class="docutils literal notranslate"><span class="pre">(⍳4)</span></code> we have to move it to the right of the subtraction, but <code class="docutils literal notranslate"><span class="pre">-</span></code> is not commutative so we have to employ a little trick to make sure the expression still evaluates to the same result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span> <span class="o">⌈</span> <span class="p">(</span><span class="o">⍳</span><span class="m">4</span><span class="p">)</span> <span class="o">-</span> <span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 3 3 3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span> <span class="o">⌈</span> <span class="m">¯1</span> <span class="o">+</span> <span class="o">⍳</span><span class="m">4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 3 3 3
</span></div></div>
</div>
<p>Please note that this sort of thing is not always possible!</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">7⌊(⍳9)⌈3</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">7</span><span class="o">⌊</span> <span class="p">(</span><span class="o">⍳</span><span class="m">9</span><span class="p">)</span> <span class="o">⌈</span> <span class="m">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 3 3 4 5 6 7 7 7
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">7</span><span class="o">⌊</span> <span class="m">3</span> <span class="o">⌈</span> <span class="p">(</span><span class="o">⍳</span><span class="m">9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 3 3 4 5 6 7 7 7
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">7</span><span class="o">⌊</span><span class="m">3</span><span class="o">⌈⍳</span><span class="m">9</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 3 3 4 5 6 7 7 7
</span></div></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1+((⍳5)=1</span> <span class="pre">4</span> <span class="pre">3</span> <span class="pre">2</span> <span class="pre">5)×5</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="o">+</span> <span class="p">((</span><span class="o">⍳</span><span class="m">5</span><span class="p">)</span><span class="o">=</span><span class="m">1</span> <span class="m">4</span> <span class="m">3</span> <span class="m">2</span> <span class="m">5</span><span class="p">)</span> <span class="o">×</span> <span class="m">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6 1 6 1 6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="o">+</span> <span class="m">5</span> <span class="o">×</span> <span class="p">((</span><span class="o">⍳</span><span class="m">5</span><span class="p">)</span><span class="o">=</span><span class="m">1</span> <span class="m">4</span> <span class="m">3</span> <span class="m">2</span> <span class="m">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6 1 6 1 6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="o">+</span> <span class="m">5</span> <span class="o">×</span> <span class="p">(</span><span class="o">⍳</span><span class="m">5</span><span class="p">)</span> <span class="o">=</span> <span class="m">1</span> <span class="m">4</span> <span class="m">3</span> <span class="m">2</span> <span class="m">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6 1 6 1 6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="o">+</span><span class="m">5</span><span class="o">×</span> <span class="m">1</span> <span class="m">4</span> <span class="m">3</span> <span class="m">2</span> <span class="m">5</span> <span class="o">=</span> <span class="p">(</span><span class="o">⍳</span><span class="m">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6 1 6 1 6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="o">+</span><span class="m">5</span><span class="o">×</span><span class="m">1</span> <span class="m">4</span> <span class="m">3</span> <span class="m">2</span> <span class="m">5</span><span class="o">=⍳</span><span class="m">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6 1 6 1 6
</span></div></div>
</div>
<p><strong>Exercise 5</strong>:</p>
<p>There are a couple of ways to determine if <code class="docutils literal notranslate"><span class="pre">a</span></code> is a scalar or not. For example, we might check if its rank is 0 with <code class="docutils literal notranslate"><span class="pre">0=≢⍴a</span></code>. We might also check if its shape matches the empty numeric vector with <code class="docutils literal notranslate"><span class="pre">⍬≡⍴a</span></code>.</p>
<p><strong>Exercise 6</strong>:</p>
<p>A possible way to look at this is by realising that the expression we are about to create is supposed to give two different values depending on the value of <code class="docutils literal notranslate"><span class="pre">a≥b</span></code>. If <code class="docutils literal notranslate"><span class="pre">a≥b</span></code> is 1 the expression needs to evaluate to 7 and if not, it needs to evaluate to 3.</p>
<p>What we can do is write an expression that “returns at least 3, with a bonus 4 whenever <code class="docutils literal notranslate"><span class="pre">a≥b</span></code>”. From that perspective, we can do <code class="docutils literal notranslate"><span class="pre">3+(4×a≥b)</span></code> which is the same as <code class="docutils literal notranslate"><span class="pre">3+4×a≥b</span></code>.</p>
<p><strong>Exercise 7</strong>:</p>
<p>An example expression could be <code class="docutils literal notranslate"><span class="pre">(a≠0)⍴3×b≠0</span></code>. Here’s how to get there:</p>
<p>We have 3 restrictions, the first one being about the shape of the result and the other two about the value itself. Reading the first restriction and factoring it with the other two, we see that</p>
<ul class="simple">
<li><p>we should return an empty vector whenever <code class="docutils literal notranslate"><span class="pre">a</span></code> is zero and a numerical vector otherwise.</p></li>
</ul>
<p>This means our expression will be of the form <code class="docutils literal notranslate"><span class="pre">(a≠0)⍴(...)</span></code>. If <code class="docutils literal notranslate"><span class="pre">a</span></code> is zero, then <code class="docutils literal notranslate"><span class="pre">a≠0</span></code> returns 0 and the right expression won’t matter, because we get an empty vector. If <code class="docutils literal notranslate"><span class="pre">a</span></code> is not zero, then <code class="docutils literal notranslate"><span class="pre">a≠0</span></code> returns 1, and we leave the <em>value</em> of the right expression as is.</p>
<p>Now we only have to figure out what goes into <code class="docutils literal notranslate"><span class="pre">(...)</span></code>, which should be an expression that evaluates to 0 if <code class="docutils literal notranslate"><span class="pre">b</span></code> is zero and 3 if <code class="docutils literal notranslate"><span class="pre">b</span></code> is not zero. We don’t need to care about enforcing <code class="docutils literal notranslate"><span class="pre">a</span></code> to be different from zero because if <code class="docutils literal notranslate"><span class="pre">a</span></code> is zero we will get an empty vector either way…</p>
<p>Thus this sub expression can be something like <code class="docutils literal notranslate"><span class="pre">3×b≠0</span></code>, which evaluates to <code class="docutils literal notranslate"><span class="pre">3</span></code> or <code class="docutils literal notranslate"><span class="pre">0</span></code> depending on the value of <code class="docutils literal notranslate"><span class="pre">b</span></code> being zero or not.</p>
<p>Putting everything together we get <code class="docutils literal notranslate"><span class="pre">(a≠0)⍴3×b≠0</span></code>.</p>
<p><strong>Exercise 8</strong>:</p>
<ul class="simple">
<li><p>replace <code class="docutils literal notranslate"><span class="pre">∧</span></code> with <code class="docutils literal notranslate"><span class="pre">×</span></code> or <code class="docutils literal notranslate"><span class="pre">⌊</span></code>;</p></li>
<li><p>replace <code class="docutils literal notranslate"><span class="pre">∨</span></code> with <code class="docutils literal notranslate"><span class="pre">⌈</span></code>.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">∧</span></code> returns 1 if both of the arguments are 1 and 0 in any other case. Rephrasing this, we get that <code class="docutils literal notranslate"><span class="pre">∧</span></code> returns 0 whenever there is a 0 present. From this, we see that both <code class="docutils literal notranslate"><span class="pre">×</span></code> and <code class="docutils literal notranslate"><span class="pre">⌊</span></code> are suitable replacements. <code class="docutils literal notranslate"><span class="pre">×</span></code> because whenever there is a 0, multiplication by 0 gives 0. A similar thing happens for <code class="docutils literal notranslate"><span class="pre">⌊</span></code> because we are only dealing with arguments that are 0 or 1.</p>
<p><code class="docutils literal notranslate"><span class="pre">∨</span></code> returns 1 whenever there is a 1 as argument, so we see that <code class="docutils literal notranslate"><span class="pre">⌈</span></code> is a suitable replacement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">l</span> <span class="kd">←</span> <span class="m">0</span> <span class="m">0</span> <span class="m">1</span> <span class="m">1</span>
<span class="nv">r</span> <span class="kd">←</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">l</span> <span class="o">∧</span> <span class="nv">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">l</span> <span class="o">×</span> <span class="nv">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">l</span> <span class="o">⌊</span> <span class="nv">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">l</span> <span class="o">∨</span> <span class="nv">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 1 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">l</span> <span class="o">⌈</span> <span class="nv">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 1 1
</span></div></div>
</div>
<p><strong>Exercise 9</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">g</span> <span class="kd">←</span> <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> <span class="m">0</span> <span class="m">0</span> <span class="m">1</span>
<span class="nv">m</span> <span class="kd">←</span> <span class="m">0</span> <span class="m">0</span> <span class="m">1</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span>
<span class="nv">d</span> <span class="kd">←</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">g</span><span class="o">∨</span><span class="nv">d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 1 1 0 1 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">~</span><span class="nv">g</span><span class="o">∧</span><span class="nv">d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 0 1 1 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">~</span><span class="nv">g</span><span class="o">∨~</span><span class="nv">d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 0 1 0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">d</span><span class="o">∧~</span><span class="nv">g</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 0 1 0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">g</span><span class="o">∧</span><span class="nv">m</span><span class="o">∨</span><span class="nv">d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 0 1 0 0 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">~</span><span class="nv">d</span><span class="p">)</span><span class="o">∧</span><span class="p">(</span><span class="o">~</span><span class="nv">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 1 0 0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">m</span><span class="o">⌈</span><span class="nv">g</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="nv">m</span><span class="o">⌊</span><span class="nv">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 1 0 1 0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">m</span><span class="o">⌊</span><span class="nv">g</span><span class="p">)</span><span class="o">≠</span><span class="p">(</span><span class="nv">m</span><span class="o">⌈</span><span class="nv">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 0 0 1 1 0
</span></div></div>
</div>
<p><strong>Exercise 10</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">0</span> <span class="o">&lt;</span> <span class="m">0</span> <span class="o">≤</span> <span class="m">0</span> <span class="o">=</span> <span class="m">0</span> <span class="o">≥</span> <span class="m">0</span> <span class="o">&gt;</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;sugar&#39;</span> <span class="o">∊</span> <span class="s1">&#39;salt&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 0 0 1 0
</span></div></div>
</div>
<p>Above we check which letters of <code class="docutils literal notranslate"><span class="pre">'sugar'</span></code> also show up in <code class="docutils literal notranslate"><span class="pre">'salt'</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">11</span> <span class="o">≠</span> <span class="s1">&#39;11&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 1
</span></div></div>
</div>
<p>Here we compare each character of <code class="docutils literal notranslate"><span class="pre">'11'</span></code> with the number 11.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;14&#39;</span> <span class="o">⍳</span> <span class="s1">&#39;41&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2 1
</span></div></div>
</div>
<p>And here we find the position of each character of <code class="docutils literal notranslate"><span class="pre">'41'</span></code> in <code class="docutils literal notranslate"><span class="pre">'14'</span></code>.</p>
<p><strong>Exercise 11</strong>:</p>
<p>A sensible way to approach this problem is to first compare the string with the character <code class="docutils literal notranslate"><span class="pre">'e'</span></code> and then sum the 1s that show up:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">text</span> <span class="kd">←</span> <span class="s1">&#39;The silence of the sea&#39;</span>
<span class="o">+</span><span class="na">/</span> <span class="s1">&#39;e&#39;</span><span class="o">=</span><span class="nv">text</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5
</span></div></div>
</div>
<p><strong>Exercise 12</strong>:</p>
<p>You may have come up with expressions that are similar to these ones or maybe completely different! We show <em>some</em> possibilities below.</p>
<p>We included different types of vectors so that you could be sure your solutions also work for all sorts of different vectors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">vec</span> <span class="kd">←</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span>
<span class="o">⊢</span><span class="na">/</span> <span class="nv">vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">vec</span> <span class="kd">←</span> <span class="p">(</span><span class="m">1</span> <span class="m">2</span><span class="p">)</span> <span class="m">3</span> <span class="p">(</span><span class="m">4</span> <span class="m">5</span><span class="p">)</span> <span class="m">6</span>
<span class="nv">vec</span><span class="sr">[</span><span class="o">≢</span><span class="nv">vec</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">vec</span> <span class="kd">←</span> <span class="m">0</span> <span class="p">(</span><span class="m">5</span><span class="o">⍴</span><span class="m">0</span><span class="p">)</span> <span class="p">(</span><span class="m">3</span> <span class="m">4</span><span class="o">⍴</span><span class="m">0</span><span class="p">)</span> <span class="p">(</span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span><span class="o">⍴</span><span class="m">0</span><span class="p">)</span>
<span class="p">((</span><span class="o">≢</span><span class="nv">vec</span><span class="p">)</span><span class="o">=⍳≢</span><span class="nv">vec</span><span class="p">)</span><span class="na">/</span><span class="nv">vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─────┐
│0 0 0│
│0 0 0│
└─────┘
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">⍴</span><span class="nv">vec</span><span class="p">)</span><span class="o">⌷</span><span class="nv">vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─────┐
│0 0 0│
│0 0 0│
└─────┘
</span></div></div>
</div>
<p><strong>Exercise 13</strong>:</p>
<p>Notice how <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">⍴</span> <span class="pre">7</span></code> gives the first 2 elements of <code class="docutils literal notranslate"><span class="pre">z</span></code>, which are 1 and 7.</p>
<p>Then</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span>      <span class="nv">z</span> <span class="o">=</span> <span class="m">9</span>
<span class="m">0</span>
<span class="m">0</span>
<span class="m">1</span>
<span class="m">0</span>
</pre></div>
</div>
<p>gives both the shape of <code class="docutils literal notranslate"><span class="pre">z</span></code> (a column with 4 rows) and the third element which is 9. The missing clue gives that the elements of <code class="docutils literal notranslate"><span class="pre">z</span></code> sum up to 20, but we already have 1, 7 and 9 which sum to 17, so the remaining element of <code class="docutils literal notranslate"><span class="pre">z</span></code> is a 3:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">z</span> <span class="kd">←</span> <span class="m">4</span> <span class="m">1</span><span class="o">⍴</span><span class="m">1</span> <span class="m">7</span> <span class="m">9</span> <span class="m">3</span>
<span class="m">2</span> <span class="o">⍴</span> <span class="nv">z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 7
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">⌿</span> <span class="nv">z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">20
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">z</span> <span class="o">=</span> <span class="m">9</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
0
1
0
</span></div></div>
</div>
<p><strong>Exercise 14</strong>:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span>      <span class="nv">z</span> <span class="o">=</span> <span class="m">0</span>
<span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">0</span>
<span class="m">1</span> <span class="m">0</span> <span class="m">0</span> <span class="m">1</span>
</pre></div>
</div>
<p>gives the shape of <code class="docutils literal notranslate"><span class="pre">z</span></code> and some of its values:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">?</span> <span class="m">0</span> <span class="o">?</span> <span class="o">?</span>
<span class="m">0</span> <span class="o">?</span> <span class="o">?</span> <span class="m">0</span>
</pre></div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">+/[1]</span> <span class="pre">z</span></code> gives the sums of the columns, from which we extract</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">8</span> <span class="m">0</span> <span class="o">?</span> <span class="m">5</span>
<span class="m">0</span> <span class="m">7</span> <span class="o">?</span> <span class="m">0</span>
</pre></div>
</div>
<p>Finally, <code class="docutils literal notranslate"><span class="pre">+/[2]</span> <span class="pre">z</span></code> gives the sums of the rows, from which we get that the missing <code class="docutils literal notranslate"><span class="pre">?</span></code> are 7 and -1:</p>
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">8</span> <span class="m">0</span>  <span class="m">7</span> <span class="m">5</span>
<span class="m">0</span> <span class="m">7</span> <span class="m">¯1</span> <span class="m">0</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">z</span> <span class="kd">←</span> <span class="m">2</span> <span class="m">4</span><span class="o">⍴</span><span class="m">8</span> <span class="m">0</span> <span class="m">7</span> <span class="m">5</span> <span class="m">0</span> <span class="m">7</span> <span class="m">¯1</span> <span class="m">0</span>
<span class="nv">z</span> <span class="o">=</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 0 0
1 0 0 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span><span class="sr">[</span><span class="m">2</span><span class="sr">]</span> <span class="nv">z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">20 6
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span> <span class="nv">z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">8 7 6 5
</span></div></div>
</div>
<p><strong>Exercise 15</strong>:</p>
<p><strong>Positions</strong> can be retrieved with <em>Where</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">text</span> <span class="kd">←</span> <span class="s1">&#39;The silence of the sea&#39;</span>
<span class="o">⍸</span><span class="s1">&#39;e&#39;</span><span class="o">=</span><span class="nv">text</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 8 11 18 21
</span></div></div>
</div>
<p><strong>Exercise 16</strong>:</p>
<p>There are a couple of different ways to solve this problem. From an indexing perspective, we might want to generate all the odd numbers up to, and including, the length of the vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">vec</span> <span class="kd">←</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span> <span class="m">7</span> <span class="m">8</span> <span class="m">9</span>
<span class="nv">vec</span><span class="sr">[</span><span class="m">¯1</span><span class="o">+</span><span class="m">2</span><span class="o">×⍳⌈</span><span class="p">(</span><span class="o">≢</span><span class="nv">vec</span><span class="p">)</span><span class="o">÷</span><span class="m">2</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 3 5 7 9
</span></div></div>
</div>
<p>This works by first figuring out <em>how many</em> indices we are going to need:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⌈</span><span class="p">(</span><span class="o">≢</span><span class="nv">vec</span><span class="p">)</span><span class="o">÷</span><span class="m">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5
</span></div></div>
</div>
<p>Then generating 5 consecutive numbers and adjusting them so they become the odd numbers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">¯1</span><span class="o">+</span><span class="m">2</span><span class="o">×⍳</span><span class="m">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 3 5 7 9
</span></div></div>
</div>
<p>Another possibility is to compress the odd positions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">vec</span> <span class="kd">←</span> <span class="s1">&#39;CROANGGARYANTLULLBAPTWIZOSNSSB&#39;</span>
<span class="p">(</span><span class="m">2</span><span class="o">|⍳≢</span><span class="nv">Vec</span><span class="p">)</span><span class="na">/</span><span class="nv">vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>VALUE ERROR: Undefined name: Vec
      (2|⍳≢Vec)/vec
           ∧
</pre></div>
</div>
</div>
</div>
<p>Another really ingenious solution makes use of the fact that <em>Reshape</em> reuses the right argument if needed, and so we can just <em>Compress</em> by reshaping <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">0</span></code> to the correct length:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">vec</span> <span class="kd">←</span> <span class="p">(</span><span class="m">1</span> <span class="m">2</span><span class="p">)</span> <span class="p">(</span><span class="m">2</span> <span class="m">3</span><span class="p">)</span> <span class="p">(</span><span class="m">4</span> <span class="m">5</span> <span class="m">6</span><span class="p">)</span> <span class="p">(</span><span class="m">6</span> <span class="m">9</span> <span class="m">42</span> <span class="m">1024</span><span class="p">)</span>
<span class="p">((</span><span class="o">≢</span><span class="nv">vec</span><span class="p">)</span><span class="o">⍴</span><span class="m">1</span> <span class="m">0</span><span class="p">)</span><span class="na">/</span><span class="nv">vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───┬─────┐
│1 2│4 5 6│
└───┴─────┘
</span></div></div>
</div>
<p><strong>Exercise 17</strong>:</p>
<p><em>Ravel</em> will take a 3-D array and create a long vector with all its items, so we just have to count them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≢,</span><span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">120
</span></div></div>
</div>
<p>Alternatively, we can use some mathematics and realise that there are as many items in <code class="docutils literal notranslate"><span class="pre">prod</span></code> as its shape allows, where multiplying the dimensions together will yield the total. Think of it like computing the area of a rectangle for a 2-D array and the volume of a rectangular prism for a 3-D array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">5 2 12
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">×</span><span class="na">/</span><span class="o">⍴</span><span class="nv">prod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">120
</span></div></div>
</div>
<p><strong>Exercise 18</strong>:</p>
<p>This is a simple exercise in compressing with a Boolean mask. We just create a mask with all the numbers we want to keep:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">ns</span> <span class="kd">←</span> <span class="m">10</span><span class="o">+⍳</span><span class="m">30</span>            <span class="c1">⍝ just a vector to exemplify with</span>
<span class="p">((</span><span class="nv">ns</span><span class="o">&lt;</span><span class="m">30</span><span class="p">)</span><span class="o">∧</span><span class="nv">ns</span><span class="o">≥</span><span class="m">20</span><span class="p">)</span><span class="na">/</span><span class="nv">ns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">20 21 22 23 24 25 26 27 28 29
</span></div></div>
</div>
<p>Be careful with using the correct Boolean operator. Swapping them around might create an expression which preserves the vector as-is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="nv">ns</span><span class="o">&lt;</span><span class="m">30</span><span class="p">)</span><span class="o">∨</span><span class="nv">ns</span><span class="o">≥</span><span class="m">20</span><span class="p">)</span><span class="na">/</span><span class="nv">ns</span>     <span class="c1">⍝ swapped ∧ with ∨</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
</span></div></div>
</div>
<p><strong>Exercise 19</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≢</span><span class="nv">vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="nv">vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4
</span></div></div>
</div>
<p>The two expressions have the same value but they have different shapes. While <code class="docutils literal notranslate"><span class="pre">≢vec</span></code> is a scalar:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴≢</span><span class="nv">vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">
</span></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">⍴vec</span></code> is a vector of length 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴⍴</span><span class="nv">vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p><strong>Exercise 20</strong>:</p>
<p>For this exercise we just have to revisit the rule for how <em>Depth</em> works and work our way inside out.</p>
<p>A scalar has depth 0</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≡</span><span class="m">42</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0
</span></div></div>
</div>
<p>and a simple vector has depth 1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≡</span><span class="m">42</span> <span class="m">41</span> <span class="m">40</span> <span class="m">39</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>because all its items are scalars of depth 0. Similarly for a simple matrix. Even though its rank is larger than the rank of a vector, the matrix only contains scalars of depth 0 and thus its depth is also 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≡</span><span class="m">2</span> <span class="m">2</span><span class="o">⍴</span><span class="m">42</span> <span class="m">41</span> <span class="m">40</span> <span class="m">39</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1
</span></div></div>
</div>
<p>For uneven nested vectors we just compute the largest depth, add 1 and then return it as a negative number. Since <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">(2</span> <span class="pre">3)</span> <span class="pre">(4</span> <span class="pre">5)</span></code> contains scalars (of depth 0) and vectors (of depth 1) its depth should be -2:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≡</span><span class="m">1</span> <span class="p">(</span><span class="m">2</span> <span class="m">3</span><span class="p">)</span> <span class="p">(</span><span class="m">4</span> <span class="m">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯2
</span></div></div>
</div>
<p>On the other hand, <code class="docutils literal notranslate"><span class="pre">(1</span> <span class="pre">2)</span> <span class="pre">(3</span> <span class="pre">4</span> <span class="pre">5)</span> <span class="pre">(6</span> <span class="pre">7</span> <span class="pre">8</span> <span class="pre">9)</span></code> is a vector of vectors, and thus its depth is 2:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≡</span><span class="p">(</span><span class="m">1</span> <span class="m">2</span><span class="p">)</span> <span class="p">(</span><span class="m">3</span> <span class="m">4</span> <span class="m">5</span><span class="p">)</span> <span class="p">(</span><span class="m">6</span> <span class="m">7</span> <span class="m">8</span> <span class="m">9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2
</span></div></div>
</div>
<p>Computing the depth of <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">(2</span> <span class="pre">(3</span> <span class="pre">(4</span> <span class="pre">(5</span> <span class="pre">(6</span> <span class="pre">7)))))</span></code> is just a matter of counting carefully. The inner <code class="docutils literal notranslate"><span class="pre">(6</span> <span class="pre">7)</span></code> has depth 1, <code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">(6</span> <span class="pre">7)</span></code> has depth -2, <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">(5</span> <span class="pre">(6</span> <span class="pre">7))</span></code> has depth -3, …, up until</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≡</span><span class="m">1</span> <span class="p">(</span><span class="m">2</span> <span class="p">(</span><span class="m">3</span> <span class="p">(</span><span class="m">4</span> <span class="p">(</span><span class="m">5</span> <span class="p">(</span><span class="m">6</span> <span class="m">7</span><span class="p">)))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯6
</span></div></div>
</div>
<p>The final example is to try and throw you off by including items that have higher ranks, but still the same depth. A simple matrix has depth 1, so a vector of simple matrices is going to have depth 2:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≡</span><span class="p">(</span><span class="m">2</span> <span class="m">2</span><span class="o">⍴</span><span class="m">4</span><span class="p">)</span> <span class="p">(</span><span class="m">2</span> <span class="m">2</span><span class="o">⍴⍳</span><span class="m">47</span><span class="p">)</span> <span class="p">(</span><span class="m">3</span> <span class="m">6</span><span class="o">⍴⍳</span><span class="m">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">2
</span></div></div>
</div>
<p><strong>Exercise 21</strong>:</p>
<p>This task of ensuring all numbers in an array are above a minimum threshold and below a maximum threshold is sometimes called <em>clipping</em> and is easy to achieve in APL with the scalar <code class="docutils literal notranslate"><span class="pre">⌈</span></code> and <code class="docutils literal notranslate"><span class="pre">⌊</span></code> functions. We create a dummy matrix to demonstrate:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕RL</span> <span class="kd">←</span> <span class="m">73</span>
<span class="o">⊢</span><span class="nv">m</span> <span class="kd">←</span> <span class="m">15</span><span class="o">+?</span><span class="m">3</span> <span class="m">3</span><span class="o">⍴</span><span class="m">20</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">24 31 25
33 17 18
26 28 32
</span></div></div>
</div>
<p>We want <code class="docutils literal notranslate"><span class="pre">m</span></code>’s values to be at least 20, so numbers below should become 20:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">20</span><span class="o">⌈</span><span class="nv">m</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">24 31 25
33 20 20
26 28 32
</span></div></div>
</div>
<p>Similarly for numbers above 30:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">30</span><span class="o">⌊</span><span class="m">20</span><span class="o">⌈</span><span class="nv">m</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">24 30 25
30 20 20
26 28 30
</span></div></div>
</div>
<p><strong>Exercise 22</strong>:</p>
<p>The challenge of this exercise was to spot the error <em>before</em> trying to run the expression on the interpreter and reading its error message.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">3+(5-(6+2)×4</span></code></p></li>
</ul>
<p>Looking close enough, we see there is an extra <code class="docutils literal notranslate"><span class="pre">(</span></code> that never got closed, getting us a <code class="docutils literal notranslate"><span class="pre">SYNTAX</span> <span class="pre">ERROR</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">3</span><span class="o">+</span><span class="p">(</span><span class="m">5</span><span class="o">-</span><span class="p">(</span><span class="m">6</span><span class="o">+</span><span class="m">2</span><span class="p">)</span><span class="o">×</span><span class="m">4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SYNTAX ERROR
      3+(5-(6+2)×4
          ∧
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">121÷(⍳4)-3</span></code></p></li>
</ul>
<p>This one won’t work because there is a hidden division by 0 in there:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">⍳</span><span class="m">4</span><span class="p">)</span><span class="o">-</span><span class="m">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯2 ¯1 0 1
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">121</span><span class="o">÷</span><span class="p">(</span><span class="o">⍳</span><span class="m">4</span><span class="p">)</span><span class="o">-</span><span class="m">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DOMAIN ERROR: Divide by zero
      121÷(⍳4)-3
         ∧
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(¯X+5)*2</span></code></p></li>
</ul>
<p>The error in this expression is the usage of <code class="docutils literal notranslate"><span class="pre">¯</span></code> with a variable name. <code class="docutils literal notranslate"><span class="pre">¯</span></code> can only be used when writing out numbers. If you want to negate the value of a variable, use the <em>Negate</em> function <code class="docutils literal notranslate"><span class="pre">-</span></code>.</p>
<p>For us to show the appropriate error, we need to define <code class="docutils literal notranslate"><span class="pre">X</span></code> to have some value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">X</span> <span class="kd">←</span> <span class="m">42</span>
<span class="p">(</span><span class="m">¯</span><span class="nv">X</span><span class="o">+</span><span class="m">5</span><span class="p">)</span><span class="o">*</span><span class="m">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SYNTAX ERROR: Invalid token
      (¯ X+5)*2
       ∧
</pre></div>
</div>
</div>
</div>
<p>The “<em>Invalid token</em>” mentioned is the <code class="docutils literal notranslate"><span class="pre">¯</span></code> next to a variable name, when it should be next to a number literal.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">⍴4</span> <span class="pre">5</span> <span class="pre">6+2</span> <span class="pre">3-1</span></code></p></li>
</ul>
<p>The problem with this expression is that we are using scalar functions with vectors whose lengths aren’t compatible. The <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">3-1</span></code> works because <code class="docutils literal notranslate"><span class="pre">-</span></code> knows how to subtract a number from a vector, but then <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">5</span> <span class="pre">6+1</span> <span class="pre">2</span></code> will attempt to add two vectors of incompatible lengths and fail:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍴</span><span class="m">4</span> <span class="m">5</span> <span class="m">6</span><span class="o">+</span><span class="m">2</span> <span class="m">3</span><span class="o">-</span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LENGTH ERROR: Mismatched left and right argument shapes
      ⍴4 5 6+2 3-1
            ∧
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">⍳3-5</span></code></p></li>
</ul>
<p><em>Index Generator</em> expects a vector of non-negative numbers as argument and so a simple <code class="docutils literal notranslate"><span class="pre">DOMAIN</span> <span class="pre">ERROR</span></code> is issued:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍳</span><span class="m">3</span><span class="o">-</span><span class="m">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DOMAIN ERROR
      ⍳3-5
      ∧
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">⍸1</span> <span class="pre">0</span> <span class="pre">2</span> <span class="pre">¯1</span></code></p></li>
</ul>
<p>Similarly, <em>Where</em> only expects non-negative integers in its argument array, so the <code class="docutils literal notranslate"><span class="pre">¯1</span></code> is an issue there:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸</span><span class="m">1</span> <span class="m">0</span> <span class="m">2</span> <span class="m">¯1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DOMAIN ERROR: Where right argument must be non-negative
      ⍸1 0 2 ¯1
      ∧
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 23</strong>:</p>
<p>This “vector of 17 numbers, the first being 23, with each subsequent number being equal to the preceding one plus 11” is called an arithmetic progression in mathematics. Generating them is really easy.</p>
<p>We start by generating a vector of consecutive numbers with the appropriate length:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍳</span><span class="m">17</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17
</span></div></div>
</div>
<p>Then we multiply the whole sequence by the spacing we want there to be between each number:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">11</span><span class="o">×⍳</span><span class="m">17</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">11 22 33 44 55 66 77 88 99 110 121 132 143 154 165 176 187
</span></div></div>
</div>
<p>Then we add/subtract a number to the sequence so that the first element matches the required value. The first number is currently 11 and we want it to be 23, so we have to add 12:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">12</span><span class="o">+</span><span class="m">11</span><span class="o">×⍳</span><span class="m">17</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">23 34 45 56 67 78 89 100 111 122 133 144 155 166 177 188 199
</span></div></div>
</div>
<p>Notice the final expression is equivalent to the algorithm presented in <a class="reference internal" href="#some-primitive-functions-basic-usage"><span class="std std-numref">Section 4.15.1</span></a>, and working our way up to the expression is easier than trying to memorise an algorithm that ends up being longer!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">23</span><span class="o">+</span><span class="m">11</span><span class="o">×</span><span class="p">(</span><span class="o">⍳</span><span class="m">17</span><span class="p">)</span><span class="o">-</span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">23 34 45 56 67 78 89 100 111 122 133 144 155 166 177 188 199
</span></div></div>
</div>
<p><strong>Exercise 24</strong>:</p>
<p>The first sensible thing to do is separate the products from the quantities. We can do this by creating a matrix with 2 columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">wannaBuy</span> <span class="kd">←</span> <span class="m">37</span> <span class="m">1</span> <span class="m">70</span> <span class="m">20</span> <span class="m">19</span> <span class="m">2</span> <span class="m">82</span> <span class="m">5</span> <span class="m">23</span> <span class="m">10</span>
<span class="o">⊢</span><span class="nv">m</span> <span class="kd">←</span> <span class="p">((</span><span class="m">0.5</span><span class="o">×≢</span><span class="nv">wannaBuy</span><span class="p">)</span><span class="o">,</span><span class="m">2</span><span class="p">)</span><span class="o">⍴</span><span class="nv">wannaBuy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">37  1
70 20
19  2
82  5
23 10
</span></div></div>
</div>
<p>Now the first column contains the codes and the second column contains the quantities. We chose 2 columns instead of 2 rows because of the way <code class="docutils literal notranslate"><span class="pre">⍴</span></code> fills in the matrix: from left to right, top to bottom.</p>
<p>The next thing to do is map the product codes to their prices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">pcodes</span> <span class="kd">←</span> <span class="m">56</span> <span class="m">66</span> <span class="m">19</span> <span class="m">37</span> <span class="m">44</span> <span class="m">20</span> <span class="m">18</span> <span class="m">23</span> <span class="m">68</span> <span class="m">70</span> <span class="m">82</span>
<span class="nv">prices</span> <span class="kd">←</span>  <span class="m">9</span> <span class="m">27</span> <span class="m">10</span> <span class="m">15</span> <span class="m">12</span>  <span class="m">5</span>  <span class="m">8</span>  <span class="m">9</span> <span class="m">98</span>  <span class="m">7</span> <span class="m">22</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">pos</span> <span class="kd">←</span> <span class="nv">pcodes</span><span class="o">⍳</span><span class="nv">m</span><span class="sr">[;</span><span class="m">1</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4 10 3 11 8
</span></div></div>
</div>
<p>Now that we have the positions of the products the customer wants, we can find the prices, multiply them by the quantities and sum everything:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span><span class="nv">prices</span><span class="sr">[</span><span class="nv">pos</span><span class="sr">]</span><span class="o">×</span><span class="nv">m</span><span class="sr">[;</span><span class="m">2</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">375
</span></div></div>
</div>
<p><strong>Exercise 25</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕RL</span> <span class="kd">←</span> <span class="m">73</span>
<span class="nv">tickets</span> <span class="kd">←</span> <span class="o">?</span><span class="m">1000</span><span class="o">⍴</span><span class="m">999999</span>
<span class="nv">sold</span> <span class="kd">←</span> <span class="nv">tickets</span><span class="sr">[</span><span class="p">(</span><span class="m">800</span><span class="o">+?</span><span class="m">200</span><span class="p">)</span><span class="o">?</span><span class="m">1000</span><span class="sr">]</span>
<span class="nv">ours</span> <span class="kd">←</span> <span class="nv">sold</span><span class="sr">[</span><span class="p">(</span><span class="o">?</span><span class="m">200</span><span class="p">)</span><span class="o">?≢</span><span class="nv">sold</span><span class="sr">]</span>
<span class="nv">winners</span> <span class="kd">←</span> <span class="nv">tickets</span><span class="sr">[</span><span class="m">100</span><span class="o">?</span><span class="m">1000</span><span class="sr">]</span>
<span class="nv">prizes</span> <span class="kd">←</span> <span class="o">?</span><span class="m">100</span><span class="o">⍴</span><span class="m">1000</span>
</pre></div>
</div>
</div>
</div>
<p>The unsold tickets are the <code class="docutils literal notranslate"><span class="pre">tickets</span></code> <em>Without</em> the ones that have been <code class="docutils literal notranslate"><span class="pre">sold</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">tickets</span> <span class="o">~</span> <span class="nv">sold</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">636802 512379 327584 742744 867694 518416 837522 756393 875860 650618 734820 850511 269877 919436 540758 983293 504930 693

      521 242886 704993 445662 713406 614389 483967 897435 610802 578109 768129 383069 395407 7478 420111 30447 132341 519

      031 539593 295049 52849 187875 820478 641186 686560 450428 313323 281393 935843 861713 601571 508158 96073 233311 48

      7348 757868 57876 971533 996215 816637 140520 378089 292169 178757 246775 246429 316212 309252 962321 73397 326613 8

      63219 442574 838820 560717 872464 544884 211478 421320 670853 933120 929562 29943 872039 24194 313244 525545 974249 

      391069 229590 164488 988529 891749 309984 384385 896675 903217 891047 255077 547699 378376 611404 156401 663154 1014

      48 312591 50864 568638 231875 952662 701228 797311 212429 248189 521779 858987 325307 775909 781609 91337 354366 309

      96 628490 407462 6628 93348 815928 61755 195544 16935 236409 889935 629654 86574 345820 734765 996468 387036 865286 

      822609 253808 263675 816052 567659 493785 574772
</span></div></div>
</div>
<p>Similarly, we can find the <code class="docutils literal notranslate"><span class="pre">winners</span></code>’s tickets <em>Without</em> the ones that have been <code class="docutils literal notranslate"><span class="pre">sold</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">winners</span> <span class="o">~</span> <span class="nv">sold</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">983293 73397 140520 7478 212429 670853 628490 701228 313323 384385 574772 327584 248189 816637 971533 962321
</span></div></div>
</div>
<p>So we can see some of the winning tickets were not sold.</p>
<p>We have</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">≢</span><span class="nv">ours</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">160
</span></div></div>
</div>
<p>tickets.</p>
<p>Finally, to find our earnings we need to connect <code class="docutils literal notranslate"><span class="pre">ours</span></code> to the <code class="docutils literal notranslate"><span class="pre">prizes</span></code>. The easiest way to do so is by using <em>Compress</em> after finding out which <code class="docutils literal notranslate"><span class="pre">winners</span></code> are also <code class="docutils literal notranslate"><span class="pre">ours</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="na">/</span> <span class="p">(</span><span class="nv">winners</span><span class="o">∊</span><span class="nv">ours</span><span class="p">)</span><span class="na">/</span><span class="nv">prizes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">7043
</span></div></div>
</div>
<p>Another (more convoluted) possibility would be to index into the <code class="docutils literal notranslate"><span class="pre">prizes</span></code> with the <code class="docutils literal notranslate"><span class="pre">winners</span></code> that were also <code class="docutils literal notranslate"><span class="pre">ours</span></code>. For example, finding the positions of <code class="docutils literal notranslate"><span class="pre">ours</span></code> in the <code class="docutils literal notranslate"><span class="pre">winners</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">pos</span> <span class="kd">←</span> <span class="nv">winners</span> <span class="o">⍳</span> <span class="nv">ours</span>
</pre></div>
</div>
</div>
</div>
<p>Now notice we cannot index immediately into <code class="docutils literal notranslate"><span class="pre">prizes</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">prizes</span><span class="sr">[</span><span class="nv">pos</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INDEX ERROR
      prizes[pos]
            ∧
</pre></div>
</div>
</div>
</div>
<p>This is because some of our tickets are not winners and hence their index is one too large. To circumvent this we can extend <code class="docutils literal notranslate"><span class="pre">prizes</span></code> to have a trailing 0, so that our tickets that are not winners will contribute with 0 to the final sum:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">prizes</span> <span class="kd">←</span> <span class="nv">prizes</span><span class="o">,</span> <span class="m">0</span>
<span class="o">+</span><span class="na">/</span> <span class="nv">prizes</span><span class="sr">[</span><span class="nv">pos</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">7043
</span></div></div>
</div>
<p><strong>Exercise 26</strong>:</p>
<p>Computing divisors of a number <code class="docutils literal notranslate"><span class="pre">n</span></code> amounts to finding the numbers <code class="docutils literal notranslate"><span class="pre">m</span></code> for which <code class="docutils literal notranslate"><span class="pre">m|n</span></code> is 0. First we compute the vector of all candidates:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">n</span> <span class="kd">←</span> <span class="m">24</span>
<span class="o">⊢</span><span class="nv">m</span> <span class="kd">←</span> <span class="o">⍳</span><span class="nv">n</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
</span></div></div>
</div>
<p>Now we compute the residues with, you guessed it, <em>Residue</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">r</span> <span class="kd">←</span> <span class="nv">m</span><span class="o">|</span><span class="nv">n</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 0 4 0 3 0 6 4 2 0 11 10 9 8 7 6 5 4 3 2 1 0
</span></div></div>
</div>
<p>From these, we want the 0s because those represent numbers in <code class="docutils literal notranslate"><span class="pre">m</span></code> that divide evenly into <code class="docutils literal notranslate"><span class="pre">m</span></code>. Then we can use <code class="docutils literal notranslate"><span class="pre">⍸</span></code> to convert them back to the original integers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸</span><span class="m">0</span><span class="o">=</span><span class="nv">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 2 3 4 6 8 12 24
</span></div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "dyalog-kernel"
        },
        kernelOptions: {
            kernelName: "dyalog-kernel",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'dyalog-kernel'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="Data-and-Variables.html" title="previous page"><span class="section-number">3. </span>Data and Variables</a>
    <a class='right-next' id="next-link" href="User-Defined-Functions.html" title="next page"><span class="section-number">5. </span>User Defined Functions</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Bernard Legrand, contributions by Kim S. Andreasen, Daniel Baronet, Gitte Christensen, Peter Donnelly, Morten Kromberg, John Scholes, Adrian Smith and Tim JA. Smith. Reworked by Rodrigo Girão Serrão.<br/>
        
          <div class="extra_footer">
            <p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" />
</a></p>
<p>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>